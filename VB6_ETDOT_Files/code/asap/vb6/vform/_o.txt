VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmAbout 
   Appearance      =   0  'Flat
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "About"
   ClientHeight    =   4560
   ClientLeft      =   3045
   ClientTop       =   2775
   ClientWidth     =   5640
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   4560
   ScaleWidth      =   5640
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Cancel          =   -1  'True
      Caption         =   "&OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   345
      Left            =   4200
      TabIndex        =   8
      Top             =   3240
      Width           =   1365
   End
   Begin VB.PictureBox picIcon 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'None
      ForeColor       =   &H80000008&
      Height          =   555
      Left            =   150
      Picture         =   "About.frx":0000
      ScaleHeight     =   555
      ScaleWidth      =   615
      TabIndex        =   7
      Top             =   330
      Width           =   615
   End
   Begin Threed.SSPanel SSPanel1 
      Height          =   1065
      Left            =   60
      TabIndex        =   15
      Top             =   1860
      Width           =   5505
      _Version        =   65536
      _ExtentX        =   9710
      _ExtentY        =   1879
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblSerialNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "{Z_SERIALNUMBER}"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   19
         Top             =   750
         Width           =   5325
         WordWrap        =   -1  'True
      End
      Begin VB.Label lblUserName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "{Z_USERNAME}"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   18
         Top             =   90
         Width           =   5325
      End
      Begin VB.Label lblUserCompany 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "{Z_USERCOMPANY}"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   17
         Top             =   300
         Width           =   5325
      End
      Begin VB.Label Label1 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Serial Number:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   16
         Top             =   510
         Width           =   1065
      End
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "(Build Code XX)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   5
      Left            =   1260
      TabIndex        =   20
      Top             =   1350
      Width           =   4215
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "extent possible under law."
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   5
      Left            =   60
      TabIndex        =   14
      Top             =   4290
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "penalties, and will be prosecuted to the maximum"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   4
      Left            =   60
      TabIndex        =   13
      Top             =   4080
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "portion of it, may result in severe civil and criminal"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   3
      Left            =   60
      TabIndex        =   12
      Top             =   3870
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "reproduction or distribution of this program, or any"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   2
      Left            =   60
      TabIndex        =   11
      Top             =   3660
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "copyright law and international treaties.  Unauthorized"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   1
      Left            =   60
      TabIndex        =   10
      Top             =   3450
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Warning: This computer program is protected by"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   0
      Left            =   60
      TabIndex        =   9
      Top             =   3240
      Width           =   3975
   End
   Begin VB.Line Line1 
      BorderWidth     =   2
      X1              =   60
      X2              =   5550
      Y1              =   3090
      Y2              =   3090
   End
   Begin VB.Label lbldesc 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "This program is licensed to:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   0
      Left            =   60
      TabIndex        =   6
      Top             =   1620
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Houghton, Michigan"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   4
      Left            =   1260
      TabIndex        =   5
      Top             =   1140
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Michigan Technological University"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   3
      Left            =   1260
      TabIndex        =   4
      Top             =   930
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{copyright info}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   2
      Left            =   1260
      TabIndex        =   3
      Top             =   720
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{expiration info}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   1
      Left            =   1260
      TabIndex        =   2
      Top             =   510
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{version info}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   0
      Left            =   1260
      TabIndex        =   1
      Top             =   300
      Width           =   4215
   End
   Begin VB.Label lblProgramName 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{AppName}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Left            =   1260
      TabIndex        =   0
      Top             =   90
      Width           =   4215
   End
End
Attribute VB_Name = "frmAbout"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Private Sub cmdOK_Click()
  Unload Me
End Sub

Private Sub Form_Load()
  Me.Left = (Screen.Width - Me.Width) / 2
  Me.Top = (Screen.Height - Me.Height) / 2
  
  'VARIOUS LABELS.
  lblProgramName.Caption = AppName
  lblVersionInfo(0).Caption = "Version " & get_program_version_with_build_info()
  lblVersionInfo(1).Caption = get_expiration_info()
  lblVersionInfo(2).Caption = "Copyright " & AppCopyrightYears
  lblUserName.Caption = Trim$(lfd.Z_USERNAME)
  lblUserCompany.Caption = Trim$(lfd.Z_USERCOMPANY)
  lblSerialNumber.Caption = Trim$(lfd.Z_SERIALNUMBER)
  'lblSerialNumber.Caption = "WWWWWW-WWWWW-WWWWW-WWWWW-WWWWW"
  lblVersionInfo(5).Caption = "(Build Code " & get_program_version_with_build_info_VB4 & ")"

End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmAirWaterProperties 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Properties of Air and Water"
   ClientHeight    =   3990
   ClientLeft      =   1830
   ClientTop       =   3675
   ClientWidth     =   7920
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3990
   ScaleWidth      =   7920
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   0
      Left            =   4680
      TabIndex        =   0
      Top             =   810
      Width           =   1215
   End
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   1
      Left            =   4680
      TabIndex        =   1
      Top             =   1350
      Width           =   1215
   End
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   2
      Left            =   4680
      TabIndex        =   2
      Top             =   1830
      Width           =   1215
   End
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   3
      Left            =   4680
      TabIndex        =   3
      Top             =   2310
      Width           =   1215
   End
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   4
      Left            =   4680
      TabIndex        =   4
      Top             =   2790
      Width           =   1215
   End
   Begin VB.CommandButton Command1 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   3720
      TabIndex        =   10
      Top             =   3390
      Width           =   615
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   4
      Left            =   600
      TabIndex        =   5
      Top             =   2790
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   3
      Left            =   600
      TabIndex        =   6
      Top             =   2310
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   2
      Left            =   600
      TabIndex        =   7
      Top             =   1830
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   1
      Left            =   600
      TabIndex        =   8
      Top             =   1350
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   0
      Left            =   600
      TabIndex        =   9
      Top             =   870
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin VB.Shape Shape1 
      Height          =   3015
      Left            =   240
      Top             =   150
      Width           =   7455
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Density"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   1560
      TabIndex        =   24
      Top             =   870
      Width           =   2895
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Viscosity"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   1560
      TabIndex        =   23
      Top             =   1350
      Width           =   2895
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Surface Tension"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   1560
      TabIndex        =   22
      Top             =   1830
      Width           =   2895
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Air Density"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   1560
      TabIndex        =   21
      Top             =   2310
      Width           =   2895
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Air Viscosity"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   1560
      TabIndex        =   20
      Top             =   2790
      Width           =   2895
   End
   Begin VB.Label lblUpdateValues 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "label"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   495
      Left            =   240
      TabIndex        =   19
      Top             =   270
      Width           =   975
   End
   Begin VB.Label lblSourceofValues 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "label"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   6240
      TabIndex        =   18
      Top             =   270
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   6240
      TabIndex        =   17
      Top             =   870
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   6240
      TabIndex        =   16
      Top             =   1350
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   6240
      TabIndex        =   15
      Top             =   1830
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   6240
      TabIndex        =   14
      Top             =   2310
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   6240
      TabIndex        =   13
      Top             =   2790
      Width           =   1215
   End
   Begin VB.Line Line1 
      X1              =   240
      X2              =   7680
      Y1              =   750
      Y2              =   750
   End
   Begin VB.Line Line2 
      X1              =   240
      X2              =   7680
      Y1              =   1230
      Y2              =   1230
   End
   Begin VB.Line Line3 
      X1              =   240
      X2              =   7680
      Y1              =   1710
      Y2              =   1710
   End
   Begin VB.Line Line4 
      X1              =   240
      X2              =   7680
      Y1              =   2190
      Y2              =   2190
   End
   Begin VB.Line Line5 
      X1              =   240
      X2              =   7680
      Y1              =   2670
      Y2              =   2670
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Property"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   1560
      TabIndex        =   12
      Top             =   390
      Width           =   2895
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Value"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   4680
      TabIndex        =   11
      Top             =   390
      Width           =   1215
   End
End
Attribute VB_Name = "frmAirWaterProperties"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim AtLeastOneValueChanged As Integer

Private Sub Command1_Click()

    frmAirWaterProperties.Hide

    If CurrentMode = 1 Then
       scr1 = CurrentScreen

      If scr1.NumChemical > 0 Then
        'Update Variables on Screen
        Call GetVQmultVQAndAirFlowRate
        Call GetLoadings
        Call GetTowerAreaAndDiameter
        Call GetOndaMassTransferCoefficient
        Call GetDesignKLaOrKLaSafetyFactor
        Call GetTowerHeightAndVolume
      End If

    Else
       Scr2 = CurrentScreen
       Call GetFlowsAndLoadingsScreen2

      If (Scr2.NumChemical > 0) Then
        'Update Variables on Screen
        Call GetContaminantConcentrationsScreen2
             
      End If

    End If

End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()

    Call CenterThisForm(Me)
    
    AtLeastOneValueChanged = False
    lblUpdateValues.Caption = "Update" & Chr$(13) & "Values"
    lblSourceofValues.Caption = "Source of" & Chr$(13) & "Values"
    Call LabelsAirWaterPropertiesSI
    
End Sub

Private Sub txtAirWaterProperties_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtAirWaterProperties(Index), Temp_Text)
End Sub

Private Sub txtAirWaterProperties_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtAirWaterProperties_LostFocus(Index As Integer)

    Dim ValueChanged As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtAirWaterProperties(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtAirWaterProperties(Index), Temp_Text)

    If Not IsError Then
       'Make sure number in text box is > zero
       If Not HaveValue(CDbl(txtAirWaterProperties(Index).Text)) Then
          txtAirWaterProperties(Index).Text = Temp_Text
          txtAirWaterProperties(Index).SetFocus
          Exit Sub
       End If

       Call TextNumberChanged(ValueChanged, txtAirWaterProperties(Index), Temp_Text)

       If ValueChanged Then lblValueSource(Index).Caption = "User-Input"

       Select Case Index
          Case 0
               CurrentScreen.WaterDensity.ValChanged = ValueChanged
               CurrentScreen.WaterDensity.UserInput = ValueChanged
               If CurrentScreen.WaterDensity.UserInput Then CurrentScreen.WaterDensity.Value = CDbl(txtAirWaterProperties(0).Text)
          Case 1
               CurrentScreen.WaterViscosity.ValChanged = ValueChanged
               CurrentScreen.WaterViscosity.UserInput = ValueChanged
               If CurrentScreen.WaterViscosity.UserInput Then CurrentScreen.WaterViscosity.Value = CDbl(txtAirWaterProperties(1).Text)
          Case 2
               CurrentScreen.WaterSurfaceTension.ValChanged = ValueChanged
               CurrentScreen.WaterSurfaceTension.UserInput = ValueChanged
               If CurrentScreen.WaterSurfaceTension.UserInput Then CurrentScreen.WaterSurfaceTension.Value = CDbl(txtAirWaterProperties(2).Text)
          Case 3
               CurrentScreen.AirDensity.ValChanged = ValueChanged
               CurrentScreen.AirDensity.UserInput = ValueChanged
               If CurrentScreen.AirDensity.UserInput Then CurrentScreen.AirDensity.Value = CDbl(txtAirWaterProperties(3).Text)
          Case 4
               CurrentScreen.AirViscosity.ValChanged = ValueChanged
               CurrentScreen.AirViscosity.UserInput = ValueChanged
               If CurrentScreen.AirViscosity.UserInput Then CurrentScreen.AirViscosity.Value = CDbl(txtAirWaterProperties(4).Text)
       End Select
    End If

  Call LostFocus_Handle(Me, txtAirWaterProperties(Index), flag_ok)


End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Begin VB.Form frmBubble 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Bubble Aeration"
   ClientHeight    =   6795
   ClientLeft      =   1275
   ClientTop       =   2205
   ClientWidth     =   9480
   Icon            =   "Bubble.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   ScaleHeight     =   6795
   ScaleWidth      =   9480
   Begin VB.CommandButton Command1 
      Appearance      =   0  'Flat
      Caption         =   "Concentration Results"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Left            =   960
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   5910
      Width           =   2655
   End
   Begin Threed.SSFrame fraOperatingConditions 
      Height          =   1335
      Left            =   30
      TabIndex        =   13
      Top             =   90
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   2355
      _StockProps     =   14
      Caption         =   "Operating Conditions:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton lblDisplayAirWaterProperties 
         Appearance      =   0  'Flat
         Caption         =   "Display Physical Properties of Water"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   120
         TabIndex        =   22
         TabStop         =   0   'False
         Top             =   930
         Width           =   4215
      End
      Begin VB.TextBox txtOperatingTemperature 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1800
         TabIndex        =   1
         Top             =   570
         Width           =   1215
      End
      Begin VB.TextBox txtOperatingPressure 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1800
         TabIndex        =   0
         Top             =   270
         Width           =   1215
      End
      Begin VB.ComboBox UnitsOpCond 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   270
         Width           =   1275
      End
      Begin VB.ComboBox UnitsOpCond 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   20
         TabStop         =   0   'False
         Top             =   570
         Width           =   1275
      End
      Begin VB.Label lblOperatingTemperature 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Temperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   -960
         TabIndex        =   24
         Top             =   570
         Width           =   2655
      End
      Begin VB.Label lblOperatingPressure 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pressure"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   -960
         TabIndex        =   23
         Top             =   270
         Width           =   2655
      End
   End
   Begin Threed.SSFrame fraOxygen 
      Height          =   1455
      Left            =   30
      TabIndex        =   14
      Top             =   1500
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   2566
      _StockProps     =   14
      Caption         =   "Oxygen (reference compound):"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboOxygen 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   1320
         Style           =   2  'Dropdown List
         TabIndex        =   27
         TabStop         =   0   'False
         Top             =   270
         Width           =   3015
      End
      Begin VB.TextBox txtOxygen 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   1800
         TabIndex        =   3
         Top             =   1050
         Width           =   1215
      End
      Begin VB.TextBox txtOxygen 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   1800
         TabIndex        =   2
         Top             =   690
         Width           =   1215
      End
      Begin VB.ComboBox UnitsOxygenRef 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   26
         TabStop         =   0   'False
         Top             =   690
         Width           =   1275
      End
      Begin VB.ComboBox UnitsOxygenRef 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   25
         TabStop         =   0   'False
         Top             =   1050
         Width           =   1275
      End
      Begin VB.Label lblOxygenLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa Method:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   0
         TabIndex        =   30
         Top             =   330
         Width           =   1215
      End
      Begin VB.Label lblOxygenLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -960
         TabIndex        =   29
         Top             =   1050
         Width           =   2655
      End
      Begin VB.Label lblOxygenLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Liquid Diffusivity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -960
         TabIndex        =   28
         Top             =   690
         Width           =   2655
      End
   End
   Begin Threed.SSFrame fraContaminantInformation 
      Height          =   2655
      Left            =   30
      TabIndex        =   15
      Top             =   3060
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   4683
      _StockProps     =   14
      Caption         =   "Design Contaminant:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdEditComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Edit Properties"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   2460
         TabIndex        =   37
         TabStop         =   0   'False
         Top             =   810
         Width           =   1755
      End
      Begin VB.CommandButton cmdDeleteComponent 
         Appearance      =   0  'Flat
         Caption         =   "De&lete"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   1380
         TabIndex        =   36
         TabStop         =   0   'False
         Top             =   810
         Width           =   975
      End
      Begin VB.CommandButton cmdAddComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Add"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   240
         TabIndex        =   35
         TabStop         =   0   'False
         Top             =   810
         Width           =   1035
      End
      Begin VB.ComboBox cboDesignContaminant 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   240
         Style           =   2  'Dropdown List
         TabIndex        =   34
         TabStop         =   0   'False
         Top             =   450
         Width           =   3975
      End
      Begin VB.TextBox txtDesignConcentrationValue 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   1920
         TabIndex        =   4
         Top             =   2250
         Width           =   1095
      End
      Begin VB.ComboBox UnitsDesignContam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   33
         TabStop         =   0   'False
         Top             =   1350
         Width           =   1275
      End
      Begin VB.ComboBox UnitsDesignContam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   32
         TabStop         =   0   'False
         Top             =   1650
         Width           =   1275
      End
      Begin VB.ComboBox UnitsDesignContam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   31
         TabStop         =   0   'False
         Top             =   2250
         Width           =   1275
      End
      Begin VB.Shape Shape1 
         Height          =   795
         Left            =   120
         Top             =   390
         Width           =   4215
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   -720
         TabIndex        =   45
         Top             =   2250
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Influent Conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   -720
         TabIndex        =   44
         Top             =   1350
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Treatment Obj."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -720
         TabIndex        =   43
         Top             =   1650
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Desired % Removal"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -720
         TabIndex        =   42
         Top             =   1950
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1920
         TabIndex        =   41
         Top             =   1350
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   1920
         TabIndex        =   40
         Top             =   1650
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   1920
         TabIndex        =   39
         Top             =   1950
         Width           =   1095
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( % )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3060
         TabIndex        =   38
         Top             =   1980
         Width           =   1155
      End
   End
   Begin Threed.SSFrame fraFlowParameters 
      Height          =   1515
      Left            =   4470
      TabIndex        =   16
      Top             =   90
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   2672
      _StockProps     =   14
      Caption         =   "Flow Parameters"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtFlowParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2400
         TabIndex        =   7
         Top             =   1110
         Width           =   1215
      End
      Begin VB.TextBox txtFlowParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2400
         TabIndex        =   6
         Top             =   810
         Width           =   1215
      End
      Begin VB.TextBox txtFlowParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2400
         TabIndex        =   5
         Top             =   150
         Width           =   1215
      End
      Begin VB.ComboBox UnitsFlowParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   47
         TabStop         =   0   'False
         Top             =   150
         Width           =   1155
      End
      Begin VB.ComboBox UnitsFlowParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   46
         TabStop         =   0   'False
         Top             =   1110
         Width           =   1155
      End
      Begin VB.Label lblFlowParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Flow Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   -420
         TabIndex        =   54
         Top             =   1110
         Width           =   2715
      End
      Begin VB.Label lblFlowParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air to Water Ratio"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -360
         TabIndex        =   53
         Top             =   810
         Width           =   2655
      End
      Begin VB.Label lblFlowParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Water Flow Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   -480
         TabIndex        =   52
         Top             =   210
         Width           =   2715
      End
      Begin VB.Label lblFlowParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2400
         TabIndex        =   51
         Top             =   510
         Width           =   1215
      End
      Begin VB.Label lblFlowParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Min. Air To Water Ratio"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -420
         TabIndex        =   50
         Top             =   510
         Width           =   2715
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( vol./vol. )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3660
         TabIndex        =   49
         Top             =   510
         Width           =   1155
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( vol./vol. )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3660
         TabIndex        =   48
         Top             =   810
         Width           =   1155
      End
   End
   Begin Threed.SSFrame fraTankParameters 
      Height          =   1815
      Left            =   4470
      TabIndex        =   17
      Top             =   1680
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   3201
      _StockProps     =   14
      Caption         =   "Tank Parameters"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2400
         TabIndex        =   8
         Top             =   210
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2400
         TabIndex        =   9
         Top             =   510
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2400
         TabIndex        =   10
         Top             =   810
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2400
         TabIndex        =   11
         Top             =   1110
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2400
         TabIndex        =   12
         Top             =   1410
         Width           =   1215
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   58
         TabStop         =   0   'False
         Top             =   510
         Width           =   1155
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   57
         TabStop         =   0   'False
         Top             =   810
         Width           =   1155
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   56
         TabStop         =   0   'False
         Top             =   1110
         Width           =   1155
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   4
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   55
         TabStop         =   0   'False
         Top             =   1410
         Width           =   1155
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "No. of Tanks (series)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   -420
         TabIndex        =   63
         Top             =   270
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Retention Time (1 Tank)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   -420
         TabIndex        =   62
         Top             =   570
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Retention Time (All Tanks)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   -420
         TabIndex        =   61
         Top             =   870
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Volume (1 Tank)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   -420
         TabIndex        =   60
         Top             =   1170
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Volume (All Tanks)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   -420
         TabIndex        =   59
         Top             =   1470
         Width           =   2715
      End
   End
   Begin Threed.SSFrame fraConcentrationResults 
      Height          =   2295
      Left            =   4470
      TabIndex        =   18
      Top             =   3900
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   4048
      _StockProps     =   14
      Caption         =   "Concentration Results:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdConcentrationResults 
         Appearance      =   0  'Flat
         Caption         =   "View Effluent Concentrations from All Tanks"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   60
         TabIndex        =   67
         TabStop         =   0   'False
         Top             =   1200
         Width           =   4755
      End
      Begin VB.ComboBox UnitsConcResults 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   66
         TabStop         =   0   'False
         Top             =   540
         Width           =   1155
      End
      Begin VB.ComboBox UnitsConcResults 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   65
         TabStop         =   0   'False
         Top             =   840
         Width           =   1155
      End
      Begin VB.ComboBox UnitsConcResults 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   64
         TabStop         =   0   'False
         Top             =   1620
         Width           =   1155
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Compound"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   -150
         TabIndex        =   78
         Top             =   240
         Width           =   1155
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Ci to Tank 1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   -300
         TabIndex        =   77
         Top             =   540
         Width           =   2595
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Yi to All Tanks"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   -300
         TabIndex        =   76
         Top             =   840
         Width           =   2595
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Ce from Last Tank"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   -300
         TabIndex        =   75
         Top             =   1620
         Width           =   2595
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Achieved % Removal"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   -300
         TabIndex        =   74
         Top             =   1920
         Width           =   2595
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1140
         TabIndex        =   73
         Top             =   240
         Width           =   2715
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2400
         TabIndex        =   72
         Top             =   540
         Width           =   1215
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2400
         TabIndex        =   71
         Top             =   840
         Width           =   1215
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   2400
         TabIndex        =   70
         Top             =   1620
         Width           =   1215
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2400
         TabIndex        =   69
         Top             =   1920
         Width           =   1215
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( % )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3660
         TabIndex        =   68
         Top             =   1920
         Width           =   1155
      End
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   210
      Top             =   6180
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   327681
   End
   Begin VB.Label lblStantonLabel 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Stanton Number"
      ForeColor       =   &H80000008&
      Height          =   195
      Left            =   4050
      TabIndex        =   80
      Top             =   3570
      Width           =   2715
   End
   Begin VB.Label lblStanton 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   6870
      TabIndex        =   79
      Top             =   3570
      Width           =   1215
   End
   Begin VB.Menu mnuFileMenu 
      Caption         =   "&File"
      Begin VB.Menu mnuFile 
         Caption         =   "Switch Modes"
         Index           =   0
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Open"
         Index           =   3
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Save"
         Index           =   4
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Save &As"
         Index           =   5
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   6
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Print"
         Index           =   7
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &Printer"
            Index           =   0
         End
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &File"
            Index           =   1
         End
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Select Printer"
         Index           =   8
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   9
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Return to &Main Menu"
         Index           =   10
         Shortcut        =   ^M
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   11
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&1 Old File #1"
         Index           =   191
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&2 Old File #2"
         Index           =   192
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&3 Old File #3"
         Index           =   193
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&4 Old File #4"
         Index           =   194
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   199
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&xit"
         Index           =   200
      End
   End
   Begin VB.Menu mnuUnitsMenu 
      Caption         =   "&Units"
      Begin VB.Menu mnuUnits 
         Caption         =   "Standard International (SI)"
         Index           =   0
      End
      Begin VB.Menu mnuUnits 
         Caption         =   "English"
         Index           =   1
      End
   End
   Begin VB.Menu mnuPopUpContaminant 
      Caption         =   "PopupContaminant"
      Visible         =   0   'False
      Begin VB.Menu mnuPopContaminant 
         Caption         =   "Call &StEPP"
         Enabled         =   0   'False
         Index           =   0
      End
      Begin VB.Menu mnuPopContaminant 
         Caption         =   "User &Input"
         Index           =   1
      End
   End
   Begin VB.Menu mnuPowerMenu 
      Caption         =   "&Power"
      Begin VB.Menu mnuPower 
         Caption         =   "&Perform Power Calculations"
         Index           =   0
      End
   End
   Begin VB.Menu mnuOptionsMenu 
      Caption         =   "&Results"
      Begin VB.Menu mnuOptions 
         Caption         =   "&View All Concentration Results"
         Index           =   0
      End
   End
   Begin VB.Menu mnuHelp 
      Caption         =   "&Help"
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&Online Help ..."
         Index           =   300
      End
   End
End
Attribute VB_Name = "frmBubble"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim Temp_Text As String
Dim frmBubble_Okay_To_Unload As Boolean



Const frmBubble_declarations_end = True


Private Sub AddPrompt(menuID As Integer, prompt As String)
    menuPrompts(iMenuPrompts).menuID = menuID
    menuPrompts(iMenuPrompts).prompt = prompt
    iMenuPrompts = iMenuPrompts + 1
End Sub

Private Sub cboDesignContaminant_Click()
Dim ContaminantIndex As Integer, i As Integer
Dim PercentRemoval As Double

    ContaminantIndex = cboDesignContaminant.ListIndex + 1
    i = ContaminantIndex
    If i = 0 Then Exit Sub
    bub.DesignContaminant = bub.Contaminant(i)

    'Update Design Contaminant | Influent Conc.
    'lblDesignConcentrationValue(0).Caption = Format$(bub.Contaminant(i).Influent.Value, "0.0")
    Call UnitsDesignContam_Click(0)
    
    'Update Design Contaminant | Treatment Obj.
    'lblDesignConcentrationValue(1).Caption = Format$(bub.Contaminant(i).TreatmentObjective.Value, "0.0")
    Call UnitsDesignContam_Click(1)

    'Call system_log("REMOVBUB " & Str$(bub.DesiredPercentRemoval) & ", " & Str$(bub.Contaminant(i).Influent.value) & ", " & Str$(bub.Contaminant(i).TreatmentObjective.value))
    Call REMOVBUB(bub.DesiredPercentRemoval, bub.Contaminant(i).Influent.Value, bub.Contaminant(i).TreatmentObjective.Value)
    Call CalculateMinAirToWaterRatio
    
    lblDesignConcentrationValue(2).Caption = Format$(bub.DesiredPercentRemoval, "0.0")
    
    lblConcentrationResults(0).Caption = cboDesignContaminant.Text

    'Update Concentration Results | Ci to Tank 1.
    'lblConcentrationResults(1).Caption = lblDesignConcentrationValue(0).Caption
    Call UnitsConcResults_Click(1)

    'Update Concentration Results | Yi to All Tanks.
    Call UnitsConcResults_Click(2)    'Note: Always 0.
    
    'Update Concentration Results | Ce from Last Tank.
    Call UnitsConcResults_Click(3)
    'UPDATED_UNITS

    Call CalculateContaminantMTCoeff

    'Update Design Contaminant | KLa
    Call UnitsDesignContam_Click(3)

    If BubbleAerationMode = DESIGN_MODE Then
       If bub.AirToWaterRatio.Value < bub.MinimumAirToWaterRatio.Value Then
          frmBubbleAchievingRemovalEfficiency!lblAchieving(0).Caption = Format$(bub.MinimumAirToWaterRatio.Value, GetTheFormat(bub.MinimumAirToWaterRatio.Value))
          frmBubbleAchievingRemovalEfficiency!txtAchieving(1).Text = Format$(bub.AirToWaterRatio.Value, GetTheFormat(bub.AirToWaterRatio.Value))
          frmBubbleAchievingRemovalEfficiency!txtAchieving(2).Text = Format$(bub.NumberOfTanks.Value, "0")
          frmBubbleAchievingRemovalEfficiency.Show 1
       End If
       Call CalculateTankVolumeBubble
       Call CalculateRetentionTimesAndTankVolumes
    End If
    Call CalculateStantonNo
    Call CalculateEffluentConcentrationsBubble

    'Update Tank Parameters:
    For i = 1 To 4
      Call UnitsTankParam_Click(i)
    Next i

    'Update Flow Parameters:
    Call UnitsFlowParam_Click(0)
    Call UnitsFlowParam_Click(3)
    
End Sub

Private Sub cboDesignContaminant_GotFocus()
    Temp_Text = cboDesignContaminant.Text
End Sub

Private Sub cboDesignContaminant_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub cboOxygen_Click()
   
   If cboOxygen.ListIndex = 0 Then   'Clean Water Oxygen Transfer Test Data
      frmOxygenMassTransferCoeff.Show
   Else
      bub.Oxygen.KLaMethod = 2
      bub.Oxygen.MassTransferCoefficient.UserInput = True
   End If

End Sub

Private Sub cmdAddComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer

  If (bub.NumChemical + 1 > MAXCHEMICAL) Then
     MsgBox "The maximum number of contaminants has been reached.  It is not possible to input more than " & Format$(MAXCHEMICAL, "0") & " contaminants for design.  To add an additional contaminant, another must first be removed.", MB_ICONSTOP, "Bubble Aeration"
     cmdAddComponent.Enabled = False
     Exit Sub
  End If

  x.ModelName = "Bubble Aeration"
  x.ModelType = MODELTYPE_BUBBLE
  x.DoEditNumber = -1       'Will be set by frmContaminantPropertyEdit.
  x.DoAdd = True
  x.OldNumCompo = cboDesignContaminant.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i).Name = bub.Contaminant(i).Name
    x.Contaminants(i).MolecularWeight.Value = bub.Contaminant(i).MolecularWeight.Value
    x.Contaminants(i).HenrysConstant.Value = bub.Contaminant(i).HenrysConstant.Value
    x.Contaminants(i).MolarVolume.Value = bub.Contaminant(i).MolarVolume.Value
    x.Contaminants(i).LiquidDiffusivity.Value = bub.Contaminant(i).LiquidDiffusivity.Value
    x.Contaminants(i).Influent.Value = bub.Contaminant(i).Influent.Value
    x.Contaminants(i).TreatmentObjective.Value = bub.Contaminant(i).TreatmentObjective.Value
  Next i

  StEPPImportSuccess = False
  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (StEPPImportSuccess) Or (Not x.CancelledAdd) Then
    
    For i = x.OldNumCompo + 1 To x.NewNumCompo
      'Incorporate new contaminant.
      If i > 10 Then
       MsgBox "Unable to continue importing file as maximum amount of chemicals in memory reached."
       Me.Show
       Exit Sub
      End If

      bub.Contaminant(i).Name = x.Contaminants(i).Name
      bub.Contaminant(i).MolecularWeight.Value = x.Contaminants(i).MolecularWeight.Value
      bub.Contaminant(i).HenrysConstant.Value = x.Contaminants(i).HenrysConstant.Value
      bub.Contaminant(i).MolarVolume.Value = x.Contaminants(i).MolarVolume.Value
      bub.Contaminant(i).LiquidDiffusivity.Value = x.Contaminants(i).LiquidDiffusivity.Value
      bub.Contaminant(i).Influent.Value = x.Contaminants(i).Influent.Value
      bub.Contaminant(i).TreatmentObjective.Value = x.Contaminants(i).TreatmentObjective.Value
      bub.NumChemical = bub.NumChemical + 1
      'Incorporate new name into ComboBox.
      cboDesignContaminant.AddItem bub.Contaminant(i).Name
    Next i
  End If
  
  Call SetDesignContaminantEnabledBubble(CInt(cboDesignContaminant.ListCount))
  
  If (bub.NumChemical > 0) Then
    cmdDeleteComponent.Enabled = True
    cmdEditComponent.Enabled = True
    If (cboDesignContaminant.ListIndex = -1) Then
      cboDesignContaminant.ListIndex = 0
    End If
  End If
 Me.Show
End Sub

Private Sub cmdConcentrationResults_Click()
    frmBubbleEffluentConcentrations.Show 1

End Sub

Private Sub cmdDeleteComponent_Click()
  Dim i As Integer

  bub.Chemical = cboDesignContaminant.ListIndex + 1
  If (bub.Chemical = 0) Then Exit Sub

  If MsgBox("Remove" & NL & cboDesignContaminant.List(cboDesignContaminant.ListIndex), 36, "") = IDYES Then
    cboDesignContaminant.RemoveItem cboDesignContaminant.ListIndex
    For i = bub.Chemical To bub.NumChemical - 1
      bub.Contaminant(i) = bub.Contaminant(i + 1)
    Next i
    bub.NumChemical = bub.NumChemical - 1
    If (bub.NumChemical > 0) Then
      cboDesignContaminant.ListIndex = 0
    Else
      cmdDeleteComponent.Enabled = False
      cmdEditComponent.Enabled = False
    End If
    Call SetDesignContaminantEnabledBubble(CInt(cboDesignContaminant.ListCount))
  End If

    If bub.NumChemical < 10 Then cmdAddComponent.Enabled = True

End Sub

Private Sub cmdEditComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer
Dim AListIndex As Integer

  bub.Chemical = cboDesignContaminant.ListIndex + 1
  If (bub.Chemical = 0) Then Exit Sub

  x.ModelName = "Bubble Aeration"
  x.ModelType = MODELTYPE_BUBBLE
  x.DoEditNumber = cboDesignContaminant.ListIndex + 1
  x.DoAdd = False
  x.OldNumCompo = cboDesignContaminant.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i).Name = bub.Contaminant(i).Name
    x.Contaminants(i).MolecularWeight.Value = bub.Contaminant(i).MolecularWeight.Value
    x.Contaminants(i).HenrysConstant.Value = bub.Contaminant(i).HenrysConstant.Value
    x.Contaminants(i).MolarVolume.Value = bub.Contaminant(i).MolarVolume.Value
    x.Contaminants(i).LiquidDiffusivity.Value = bub.Contaminant(i).LiquidDiffusivity.Value
    x.Contaminants(i).Influent.Value = bub.Contaminant(i).Influent.Value
    x.Contaminants(i).TreatmentObjective.Value = bub.Contaminant(i).TreatmentObjective.Value
  Next i

  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (Not x.CancelledEdit) Then
    For i = 1 To x.NewNumCompo
      bub.Contaminant(i).Name = x.Contaminants(i).Name
      bub.Contaminant(i).MolecularWeight.Value = x.Contaminants(i).MolecularWeight.Value
      bub.Contaminant(i).HenrysConstant.Value = x.Contaminants(i).HenrysConstant.Value
      bub.Contaminant(i).MolarVolume.Value = x.Contaminants(i).MolarVolume.Value
      bub.Contaminant(i).LiquidDiffusivity.Value = x.Contaminants(i).LiquidDiffusivity.Value
      bub.Contaminant(i).Influent.Value = x.Contaminants(i).Influent.Value
      bub.Contaminant(i).TreatmentObjective.Value = x.Contaminants(i).TreatmentObjective.Value
    Next i
    If (x.OldNumCompo < x.NewNumCompo) Then
      'Incorporate new names into ComboBox.
      For i = x.OldNumCompo + 1 To x.NewNumCompo
        cboDesignContaminant.AddItem bub.Contaminant(i).Name
      Next i
    End If
    'Update ComboBox for any changed names:
    For i = 1 To x.OldNumCompo
      If (Trim$(cboDesignContaminant.List(i - 1)) <> Trim$(bub.Contaminant(i).Name)) Then
        cboDesignContaminant.List(i - 1) = Trim$(bub.Contaminant(i).Name)
      End If
    Next i
  Else
     Exit Sub
  End If

  'Generate click event on cboDesignContaminant
  AListIndex = cboDesignContaminant.ListIndex
  cboDesignContaminant.ListIndex = -1
  cboDesignContaminant.ListIndex = AListIndex

End Sub

Private Sub cmdSelectContaminants_Click()
    'frmListContaminantBubble.Show 1
End Sub

Private Sub Command1_Click()
Call bubble_results
End Sub

Private Sub Form_Activate()
  frmBubble.WindowState = 0
  frmBubble.Width = SCREEN_WIDTH_STANDARD
  frmBubble.Height = SCREEN_HEIGHT_STANDARD

  'Center the form on the screen
  If (WindowState = 0) Then
    'don't attempt if screen Minimized or Maximized
    Move (Screen.Width - frmBubble.Width) / 2, (Screen.Height - frmBubble.Height) / 2
  End If

'    Dim hMenu       As Integer
'    Dim hSubMenu    As Integer
'
''Initialize MsgHook and Load Menu Prompts to Display on Status Bar
'    imenuprompts = 0
'
'    MsgHook1.HwndHook = Me.hWnd
'    MsgHook1.Message(WM_MENUSELECT) = True
'    hMenu = GetMenu(Me.hWnd)
'    '
'    ' Load File menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 0)
'    AddPrompt hSubMenu, "File operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Switch modes for bubble aeration"
'    AddPrompt GetMenuItemID(hSubMenu, 2), "Load a design case from a file"
'    AddPrompt GetMenuItemID(hSubMenu, 3), "Save this design case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 4), "Save this design case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 6), "Print this design case"
'    AddPrompt GetMenuItemID(hSubMenu, 7), "Select printer for printing results"
'    AddPrompt GetMenuItemID(hSubMenu, 9), "Leave bubble aeration and return to main ASAP menu"
'    AddPrompt GetMenuItemID(hSubMenu, 11), "Exit program"
'
'    '
'    ' Load Units menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 1)
'    AddPrompt hSubMenu, "Units operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Display results in Standard International (SI) units"
'    AddPrompt GetMenuItemID(hSubMenu, 1), "Display results in English units"
'    '
'    ' Load Power menu prompt
'    '
'    hSubMenu = GetSubMenu(hMenu, 2)
'    AddPrompt hSubMenu, "Power operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Perform power calculations"
'
'    'Load Options Menu Prompt
'    hSubMenu = GetSubMenu(hMenu, 3)
'    AddPrompt hSubMenu, "Options"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "View effluent concentration results for all contaminants"

    'Initialize last-few-files list.
    Call frmBubble_InitializeLastFewFilesList

End Sub

Private Sub Form_Load()
    Dim i As Integer

    frmBubble_Okay_To_Unload = False
    bub.NumChemical = 0
    frmBubble.WindowState = 0
    frmBubble.Width = SCREEN_WIDTH_STANDARD
    frmBubble.Height = SCREEN_HEIGHT_STANDARD
    'StatusMessagePanel.BackColor = &HC0C0C0
    'StatusMessagePanel.ForeColor = &H400040
    'StatusBarPanel.BackColor = &HC0C0C0
    'StatusBarPanel.ForeColor = &H400040
    


    Call CenterThisForm(Me)

    'Initialize Labels on frmBubble
    Call LabelsBubble(UNITSTYPE_SI)

    'Initialize Values for Pressure and Temperature
'    Call InitializePressureTemperatureBubble

    'Initialize values for water density and water viscosity
    'based on default temperature and pressure

 '   Call CalculateWaterPropertiesBubble

    'Load KLa Method Combo box
    cboOxygen.AddItem "CW O2 Transfer Test Data"
    cboOxygen.AddItem "User Input"

    'Initialize Oxygen Mass Transfer Coefficient
    Call InitializeOxygenMTCoeff

'    'Initialize value for Multiple of Minimum Air to Water Ratio
'    Call InitializeVQminMultiple

'    'Initialize Value for Air Pressure Drop
'    Call InitializeAirPressureDrop

'    'Initialize Value for KLaSafetyFactor
'    Call InitializeKLaSafetyFactor

    'Initialize calculated properties text boxes to 0
    'and disabled
'    Call InitializeCalculatedProperties

    Load frmWaterPropertiesBubble
    Load frmOxygenMassTransferCoeff

    lblConcentrationResults(2).Caption = "0"

End Sub

Private Sub frmBubble_InitializeLastFewFilesList()

  'Initialize last-few-files list.
  Select Case BubbleAerationMode
    Case DESIGN_MODE:
      Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ASAP, LASTFEW_ASAP_frmBubble_DESIGN)
    Case RATING_MODE:
      Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ASAP, LASTFEW_ASAP_frmBubble_RATING)
  End Select

End Sub
Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  If (frmBubble_Okay_To_Unload) Then
    Cancel = False
  Else
    Cancel = True
  End If
End Sub


Private Sub lblDisplayAirWaterProperties_Click()
    If HaveValue(bub.OperatingPressure.Value) And HaveValue(bub.operatingtemperature.Value) Then
       frmWaterPropertiesBubble.Show 1
    Else
       MsgBox "You must specify pressure and temperature before physical properties can be displayed.", MB_ICONSTOP, "Error"
    End If
End Sub

Private Sub mnuFile_Click(Index As Integer)
    Dim i As Integer
    Dim msg As String, response As Integer

    Screen.MousePointer = 11   'Hourglass
    Select Case Index
        Case 0   'Switch Bubble Aeration Modes
            Select Case BubbleAerationMode
            Case DESIGN_MODE   'Switch to Rating Mode
                If lblStanton.Caption <> "" Then
                    'Give user option to save design mode before
                    'switching to rating mode
                    msg = "Would you like to save the parameters "
                    msg = msg + "for this design case to a file "
                    msg = msg + "before switching to Rating "
                    msg = msg + "Mode?"
                    response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "Save Current Design")
                    If response = IDYES Then
                        Call savebubble
                    End If
                End If
                
                frmBubble.Caption = "Bubble Aeration - Rating Mode (untitled.bub)"
                frmBubble!mnuFile(0).Caption = "Switch to &Design Mode"
                BubbleAerationMode = RATING_MODE
                
                'Initialize last-few-files list.
                Call frmBubble_InitializeLastFewFilesList
                
                If frmBubble!lblStanton.Caption <> "" Then
                    bub.TankVolume.UserInput = True
                    For i = 1 To 4
                        frmBubble!txtTankParameters(i).Enabled = True
                    Next i
                    Call CalculateMinAirToWaterRatio
                Else
                    Filename$ = "TheDefaultCaseBubble"
                    Call loadbubble("")
                End If
            
            Case RATING_MODE   'Switch to Design Mode
                If lblStanton.Caption <> "" Then
                    'Give user option to save rating mode before
                    'switching to design mode
                    msg = "Would you like to save the parameters "
                    msg = msg + "for this rating case to a file "
                    msg = msg + "before switching to Design "
                    msg = msg + "Mode?"
                    response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "Save Current Design")
                    If response = IDYES Then
                        Call savebubble
                    End If
                End If
                
                frmBubble.Caption = "Bubble Aeration - Design Mode (untitled.bub)"
                frmBubble!mnuFile(0).Caption = "Switch to &Rating Mode"
                BubbleAerationMode = DESIGN_MODE
                
                'Initialize last-few-files list.
                Call frmBubble_InitializeLastFewFilesList
                
                If frmBubble!lblStanton.Caption <> "" Then
                    bub.CodeForTausAndTankVolumes = 3
                    Call CalculateMinAirToWaterRatio
                    If bub.AirToWaterRatio.Value < bub.MinimumAirToWaterRatio.Value Then
                        frmBubbleAchievingRemovalEfficiency!lblAchieving(0).Caption = Format$(bub.MinimumAirToWaterRatio.Value, GetTheFormat(bub.MinimumAirToWaterRatio.Value))
                        frmBubbleAchievingRemovalEfficiency!txtAchieving(1).Text = Format$(bub.AirToWaterRatio.Value, GetTheFormat(bub.AirToWaterRatio.Value))
                        frmBubbleAchievingRemovalEfficiency!txtAchieving(2).Text = Format$(bub.NumberOfTanks.Value, "0")
                        frmBubbleAchievingRemovalEfficiency.Show 1
                    End If
                    Call CalculateTankVolumeBubble
                    Call CalculateRetentionTimesAndTankVolumes
                    For i = 1 To 4
                        frmBubble!txtTankParameters(i).Enabled = False
                    Next i
                    Call CalculateStantonNo
                    Call CalculateEffluentConcentrationsBubble
                Else
                    Filename$ = "TheDefaultCaseBubble"
                    Call loadbubble("")
                End If
            
            End Select

        Case 3   'Open
            If frmBubble!lblStanton.Caption <> "" Then
              If (bubble_savechanges()) Then Exit Sub
            End If
             
            ''''ChDrive SaveAndLoadPath
            ''''ChDir SaveAndLoadPath
            Call ChangeDir_Main
            Call loadbubble("")

            'Add this file to the last-few-files list if necessary.
            Call LastFewFiles_MoveFilenameToTop(Filename)

            SaveAndLoadPath = CurDir$
            ''''ChDir App.Path
            ''''ChDrive App.Path
            Call ChangeDir_Main
        
        Case 4   'Save
            ''''ChDrive SaveAndLoadPath
            ''''ChDir SaveAndLoadPath
            Call ChangeDir_Main
            Call savebubble

            'Add this file to the last-few-files list if necessary.
            Call LastFewFiles_MoveFilenameToTop(Filename)

            SaveAndLoadPath = CurDir$
            ''''ChDir App.Path
            ''''ChDrive App.Path
            Call ChangeDir_Main
        
        Case 5   'Save As
            ''''ChDrive SaveAndLoadPath
            ''''ChDir SaveAndLoadPath
            Call ChangeDir_Main
            If Right$(frmBubble.Caption, 14) <> "(untitled.bub)" Then Call savefilebubble(Filename)
            Call savebubble
            
            'Add this file to the last-few-files list if necessary.
            Call LastFewFiles_MoveFilenameToTop(Filename)
            
            SaveAndLoadPath = CurDir$
            ''''ChDir App.Path
            ''''ChDrive App.Path
            Call ChangeDir_Main
        
        Case 7   'Print
        
        
        Case 8   'Select Printer
            On Error GoTo PrinterError
            ''''CMDialog1.flags = PD_PRINTSETUP
            ''''CMDialog1.Action = 5
            CommonDialog1.ShowPrinter
            GoTo ExitSelectPrint
PrinterError:
            Resume ExitSelectPrint:
    
ExitSelectPrint:

        Case 10   'Return To Main Menu
            '********************
            If frmBubble!lblStanton.Caption <> "" Then
              If (bubble_savechanges()) Then Exit Sub
            End If
            
            'Unload Forms for Bubble Aeration
            frmBubble_Okay_To_Unload = True
            Unload frmBubble
            Unload frmBubbleEffluentConcentrations
            Unload frmOxygenMassTransferCoeff
            'Unload frmListContaminantBubble
            Unload frmBubblePower
            'Unload frmPropContaminantBubble
            Unload frmBubbleAchievingRemovalEfficiency
            Unload frmWaterPropertiesBubble
            
            frmMainMenu.Show
        
        
        Case 200   'Exit
            'Give user option to save design mode before Exiting
            If frmBubble!lblStanton.Caption <> "" Then
              If (bubble_savechanges()) Then Exit Sub
            End If

            'Unload Forms for Bubble Aeration
            frmBubble_Okay_To_Unload = True
            Unload frmBubble
            Unload frmBubbleEffluentConcentrations
            Unload frmOxygenMassTransferCoeff
            'Unload frmListContaminantBubble
            Unload frmBubblePower
            'Unload frmPropContaminantBubble
            Unload frmBubbleAchievingRemovalEfficiency
            Unload frmWaterPropertiesBubble
            Unload frmMainMenu
            End

    End Select
    
    If ((Index >= 191) And (Index <= 194)) Then
      'Handle File|Open of a file here.
      ''''ChDrive SaveAndLoadPath
      ''''ChDir SaveAndLoadPath
      Call ChangeDir_Main
      If (Dir(Current_LastFewFilesRec.FileNames(Index - 190)) = "") Then
        Beep
        MsgBox "That file has been moved or deleted.", MB_ICONEXCLAMATION, Application_Name
      Else
        Call loadbubble(Current_LastFewFilesRec.FileNames(Index - 190))
        'Add this file to the last-few-files list if necessary.
        Call LastFewFiles_MoveFilenameToTop(Filename)
        SaveAndLoadPath = CurDir$
      End If
      ''''ChDir App.Path
      ''''ChDrive App.Path
      Call ChangeDir_Main
    End If
    
    Screen.MousePointer = 0   'Arrow
Exit Sub


End Sub

Private Sub mnuFilePrint_Click(Index As Integer)

    Select Case Index
       Case 0   'Print to printer
          Call PrintBubble
       Case 1   'Print to file
          Call PrintBubbleToFile
    End Select

End Sub

Private Sub mnuHelpItem_Click(Index As Integer)
  Select Case Index
    'Case 10:
    '  frmabout2.Show 1
    'Case 99:
    '  frmAbout.Show 1
    Case 300:
      Call Launch_ASAP_HLP_File
  End Select
End Sub

Private Sub mnuOptions_Click(Index As Integer)
Call bubble_results
End Sub

Private Sub mnuotheritem_Click()
'frmabout2.Show 1
End Sub

Private Sub mnuPopContaminant_Click(Index As Integer)
    'If Index = 1 Then
    '   frmListContaminantBubble.Show 1
    'End If
End Sub

Private Sub mnuPower_Click(Index As Integer)
    Dim CalculatedPower As Integer

    Select Case Index   'Power Calculation

       Case 0
             Call SetPowerBubble
             frmBubblePower.Left = Screen.Width / 2 - frmBubblePower.Width / 2
             frmBubblePower.Top = Screen.Height / 2 - frmBubblePower.Height / 2
             frmBubblePower.Show 1
    End Select

End Sub

Private Sub mnuUnits_Click(Index As Integer)

  Select Case Index
    Case 0        'SI
      Call LabelsBubble(UNITSTYPE_SI)
    Case 1        'English
      Call LabelsBubble(UNITSTYPE_ENGLISH)
  End Select

End Sub

Private Sub MsgHook1_Message(msg As Integer, wParam As Integer, lParam As Long, Action As Integer, result As Long)
'    Dim i       As Integer
'    Dim found   As Integer
'
'Exit Sub
'
'
'    '
'    ' Got a menu select message ... see if it's for one of our menus
'    '
'    For i = 0 To iMenuPrompts - 1
'        If (menuPrompts(i).menuID = wParam) Then
'            '
'            ' One of our menus ... display prompt message
'            '
'            StatusMessagePanel.Caption = menuPrompts(i).prompt
'            found = True
'            Exit For
'        End If
'    Next
'    '
'    ' Blank prompt message when no menu selected
'    '
'    If (found <> True) Then
'        StatusMessagePanel.Caption = ""
'    End If
'
End Sub

Private Sub Old_HelpTipTimer_Timer()
' 'temp kill
'Exit Sub
''''''''''''''
' Dim PointStruct As PointType
' Static PrevioushWnd%
' Dim CurrenthWnd As Integer, TipText As String
'
'If GetActiveWindow() = Me.hWnd Then
'  Call GetCursorPos(PointStruct)
'  CurrenthWnd% = WindowFromPoint(PointStruct.Y, PointStruct.x)
'  If CurrenthWnd <> PrevioushWnd% Then
'    PrevioushWnd% = CurrenthWnd
'    'HelpTipTimer.Interval = 1
'    Select Case CurrenthWnd%
'      Case txtOperatingPressure.hWnd    '<---- Here for the text box txtOperatingPressure
'       StatusMessagePanel.Caption = " Input Operating " & lblOperatingPressure.Caption
'      Case txtOperatingTemperature.hWnd   '<---- Here for the text box txtOperatingTemperature
'       StatusMessagePanel.Caption = " Input Operating " & lblOperatingTemperature.Caption
'      Case lblDisplayAirWaterProperties.hWnd
'       StatusMessagePanel.Caption = " Specify water density, viscosity, and surface tension; and air density and viscosity"
'    End Select
'    ShowHelpTip TipText$
'    If Len(TipText$) = 0 Then
'      'HelpTipTimer.Interval = 500 'Milliseconds
'    End If
'  End If
'End If
'
End Sub

Private Sub txtDesignConcentrationValue_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtDesignConcentrationValue(Index), Temp_Text)

End Sub

Private Sub txtDesignConcentrationValue_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtDesignConcentrationValue_LostFocus(Index As Integer)
    Dim ValueChanged As Integer, Dummy As Double
    Dim msg As String
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtDesignConcentrationValue(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True
  

    Call TextHandleError(IsError, txtDesignConcentrationValue(Index), Temp_Text)

    If Not IsError Then
       Dummy = CDbl(txtDesignConcentrationValue(Index).Text)
       Select Case Index
          Case 3    'Contaminant Mass Transfer Coefficient
             Call TextNumberChanged(ValueChanged, txtDesignConcentrationValue(3), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   bub.ContaminantMassTransferCoefficient.Value = Dummy
                   bub.ContaminantMassTransferCoefficient.ValChanged = True
                   bub.ContaminantMassTransferCoefficient.UserInput = True
                Else
                   txtDesignConcentrationValue(3).Text = Temp_Text
                   txtDesignConcentrationValue(3).SetFocus
                   Exit Sub
                End If
             End If

       End Select

       If ValueChanged Then
          If BubbleAerationMode = DESIGN_MODE Then
             Call CalculateTankVolumeBubble
             Call CalculateRetentionTimesAndTankVolumes
          End If

          Call CalculateStantonNo
          Call CalculateEffluentConcentrationsBubble
       End If

    End If
  Call LostFocus_Handle(Me, txtDesignConcentrationValue(Index), flag_ok)

End Sub

Private Sub txtFlowParameters_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtFlowParameters(Index), Temp_Text)
End Sub

Private Sub txtFlowParameters_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtFlowParameters_LostFocus(Index As Integer)
  Dim NewVal As Double
  Dim IsNew As Integer
  Dim flag_ok As Integer
  Dim bypass_it As Integer

   If (LostFocus_IsEvil(Me, txtFlowParameters(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True
  

  IsNew = False
  
  Select Case Index
    Case 0        'Water Flow Rate.
      If (Unitted_LostFocus(UNITS_FLOW, txtFlowParameters(0), UnitsFlowParam(0), NewVal, Temp_Text)) Then
        IsNew = True
        bub.WaterFlowRate.ValChanged = True
        bub.WaterFlowRate.UserInput = True
        bub.WaterFlowRate.Value = NewVal
        If bub.AirToWaterRatio.UserInput = True Then
           Call CalculateAirFlowRate
        Else
           Call CalculateAirToWaterRatio
        End If
        Call CalculateRetentionTimesAndTankVolumes
      End If

    Case 2        'Air to Water Ratio.
      If (NoUnits_LostFocus(txtFlowParameters(2), NewVal, Temp_Text)) Then
        IsNew = True
        bub.AirToWaterRatio.ValChanged = True
        bub.AirToWaterRatio.UserInput = True
        bub.AirToWaterRatio.Value = NewVal
        Call CalculateAirFlowRate
      End If
    
    Case 3        'Air Flow Rate.
      If (Unitted_LostFocus(UNITS_FLOW, txtFlowParameters(3), UnitsFlowParam(3), NewVal, Temp_Text)) Then
        IsNew = True
        bub.AirFlowRate.ValChanged = True
        bub.AirFlowRate.UserInput = True
        bub.AirFlowRate.Value = NewVal
        Call CalculateAirToWaterRatio
      End If

  End Select

  If (IsNew) Then
    bypass_it = False
    If BubbleAerationMode = DESIGN_MODE Then
      If bub.AirToWaterRatio.Value < bub.MinimumAirToWaterRatio.Value Then
        Call LostFocus_Handle(Me, txtFlowParameters(Index), flag_ok)
        frmBubbleAchievingRemovalEfficiency!lblAchieving(0).Caption = Format$(bub.MinimumAirToWaterRatio.Value, GetTheFormat(bub.MinimumAirToWaterRatio.Value))
        frmBubbleAchievingRemovalEfficiency!txtAchieving(1).Text = Format$(bub.AirToWaterRatio.Value, GetTheFormat(bub.AirToWaterRatio.Value))
        frmBubbleAchievingRemovalEfficiency!txtAchieving(2).Text = Format$(bub.NumberOfTanks.Value, "0")
        frmBubbleAchievingRemovalEfficiency.Show 1
        bypass_it = True
      End If
      Call CalculateTankVolumeBubble
      Call CalculateRetentionTimesAndTankVolumes
    End If
    Call CalculateStantonNo
    Call CalculateEffluentConcentrationsBubble
    Call cboDesignContaminant_Click
    If (bypass_it) Then Exit Sub
  End If

  Call LostFocus_Handle(Me, txtFlowParameters(Index), flag_ok)

End Sub

Private Sub txtOperatingPressure_GotFocus()
  Call GotFocus_Handle(Me, txtOperatingPressure, Temp_Text)
End Sub

Private Sub txtOperatingPressure_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingPressure_LostFocus()
Dim NewVal As Double
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingPressure)) Then
     Exit Sub
   End If
   
   flag_ok = True
  
  If (Unitted_LostFocus(UNITS_PRESSURE, txtOperatingPressure, UnitsOpCond(0), NewVal, Temp_Text)) Then
    bub.OperatingPressure.ValChanged = True
    bub.OperatingPressure.UserInput = True
    'Note: standard P units are Pa, but
    'OperatingPressure is stored as kPa.
    bub.OperatingPressure.Value = NewVal * 1# / 101325#

    If (HaveValue(bub.OperatingPressure.Value) And HaveValue(bub.operatingtemperature.Value)) Then
      Call CalculateWaterPropertiesBubble
      If (bub.NumChemical > 0) Then
        'Update Variables on Screen
      End If
    End If
    Call cboDesignContaminant_Click
  End If

  Call LostFocus_Handle(Me, txtOperatingPressure, flag_ok)

End Sub

Private Sub txtOperatingTemperature_GotFocus()
  Call GotFocus_Handle(Me, txtOperatingTemperature, Temp_Text)

End Sub

Private Sub txtOperatingTemperature_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingTemperature_LostFocus()
Dim NewVal As Double
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingTemperature)) Then
     Exit Sub
   End If
   
   flag_ok = True
  

  If (Unitted_LostFocus(UNITS_TEMPERATURE, txtOperatingTemperature, UnitsOpCond(1), NewVal, Temp_Text)) Then
    bub.operatingtemperature.ValChanged = True
    bub.operatingtemperature.UserInput = True
    bub.operatingtemperature.Value = NewVal

    If (HaveValue(bub.OperatingPressure.Value) And HaveValue(bub.operatingtemperature.Value)) Then
      Call CalculateWaterPropertiesBubble
      Call CalculateOxygenLiquidDiffusivity
      If (cboOxygen.ListIndex = 0) Then
        Call CalculateTrueKLa
        bub.Oxygen.MassTransferCoefficient.Value = bub.Oxygen.CWO2TestData.TrueOxygenMTCoeffOperatingT_KLAO2
        frmBubble!txtOxygen(2).Text = Format$(bub.Oxygen.MassTransferCoefficient.Value, GetTheFormat(bub.Oxygen.MassTransferCoefficient.Value))
      End If
         
      If (bub.NumChemical > 0) Then
        Call CalculateContaminantMTCoeff
        If (BubbleAerationMode = DESIGN_MODE) Then
          Call CalculateTankVolumeBubble
          Call CalculateRetentionTimesAndTankVolumes
        End If
        Call CalculateStantonNo
        Call CalculateEffluentConcentrationsBubble
      End If
    End If
    Call cboDesignContaminant_Click
  End If
  Call LostFocus_Handle(Me, txtOperatingTemperature, flag_ok)
    
End Sub

Private Sub txtOxygen_GotFocus(Index As Integer)

  Call GotFocus_Handle(Me, txtOxygen(Index), Temp_Text)

End Sub

Private Sub txtOxygen_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOxygen_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOxygen(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True
  

  IsNew = False
  
  Select Case Index
    Case 1        'Liquid Diffusivity.
      If (Unitted_LostFocus(UNITS_DIFFUSIVITY, txtOxygen(1), UnitsOxygenRef(1), NewVal, Temp_Text)) Then
        IsNew = True
        bub.Oxygen.LiquidDiffusivity.Value = NewVal
        bub.Oxygen.LiquidDiffusivity.ValChanged = True
        bub.Oxygen.LiquidDiffusivity.UserInput = True
      End If

    Case 2        'KLa.
      If (Unitted_LostFocus(UNITS_INVERSETIME, txtOxygen(2), UnitsOxygenRef(2), NewVal, Temp_Text)) Then
        IsNew = True
        bub.Oxygen.MassTransferCoefficient.Value = NewVal
        bub.Oxygen.MassTransferCoefficient.ValChanged = True
        bub.Oxygen.MassTransferCoefficient.UserInput = True
      End If
    
  End Select

  If (IsNew) Then
    Select Case Index
      Case 1
        If HaveValue(bub.OperatingPressure.Value) And HaveValue(bub.operatingtemperature.Value) And HaveValue(bub.Oxygen.LiquidDiffusivity.Value) Then
          If bub.NumChemical > 0 Then
            Call CalculateContaminantMTCoeff
            If BubbleAerationMode = DESIGN_MODE Then
              Call CalculateTankVolumeBubble
              Call CalculateRetentionTimesAndTankVolumes
            End If
            Call CalculateStantonNo
            Call CalculateEffluentConcentrationsBubble
          End If
        End If
      
      Case 2
        If HaveValue(bub.OperatingPressure.Value) And HaveValue(bub.operatingtemperature.Value) And HaveValue(bub.Oxygen.LiquidDiffusivity.Value) And HaveValue(bub.Oxygen.MassTransferCoefficient.Value) Then
          If bub.NumChemical > 0 Then
            Call CalculateContaminantMTCoeff
            If BubbleAerationMode = DESIGN_MODE Then
              Call CalculateTankVolumeBubble
              Call CalculateRetentionTimesAndTankVolumes
            End If
            Call CalculateStantonNo
            Call CalculateEffluentConcentrationsBubble
          End If
        End If
        If cboOxygen.ListIndex = 0 Then cboOxygen.ListIndex = 1
    
    End Select
  End If

  Call LostFocus_Handle(Me, txtOxygen(Index), flag_ok)

End Sub

Private Sub txtTankParameters_Change(Index As Integer)

  'If (Index >= 1 And Index <= 4) Then
  '  Call UnitsTankParam_Click(Index)
  'End If
  
End Sub

Private Sub txtTankParameters_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtTankParameters(Index), Temp_Text)
End Sub

Private Sub txtTankParameters_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtTankParameters_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtTankParameters(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True
  

  IsNew = False
  
  Select Case Index
    Case 0        'Number of Tanks in Series.
      If (NoUnits_LostFocus(txtTankParameters(0), NewVal, Temp_Text)) Then
        IsNew = True
        If (NewVal > MAXIMUM_TANKS) Then
          MsgBox "The number of tanks specified exceeds the maximum number of tanks allowed in the program.  The number of tanks must be less than or equal to " & Format$(MAXIMUM_TANKS, "0") & ".", MB_ICONSTOP, "Bubble Aeration"
          txtTankParameters(0).Text = Temp_Text
          txtTankParameters(0).SetFocus
          Call LostFocus_Handle(Me, txtTankParameters(Index), flag_ok)
          Exit Sub
        End If

        bub.NumberOfTanks.ValChanged = True
        bub.NumberOfTanks.UserInput = True
        bub.NumberOfTanks.Value = NewVal
        Call CalculateMinAirToWaterRatio

        If BubbleAerationMode = DESIGN_MODE Then
          If bub.AirToWaterRatio.Value < bub.MinimumAirToWaterRatio.Value Then
            frmBubbleAchievingRemovalEfficiency!lblAchieving(0).Caption = Format$(bub.MinimumAirToWaterRatio.Value, GetTheFormat(bub.MinimumAirToWaterRatio.Value))
            frmBubbleAchievingRemovalEfficiency!txtAchieving(1).Text = Format$(bub.AirToWaterRatio.Value, GetTheFormat(bub.AirToWaterRatio.Value))
            frmBubbleAchievingRemovalEfficiency!txtAchieving(2).Text = Format$(bub.NumberOfTanks.Value, "0")
            
            Call LostFocus_Handle(Me, txtTankParameters(Index), flag_ok)
            
            frmBubbleAchievingRemovalEfficiency.Show 1
          End If
          Call CalculateTankVolumeBubble
          Call CalculateRetentionTimesAndTankVolumes
        Else
          Call CalculateRetentionTimesAndTankVolumes
        End If
      End If

    Case 1        'Retention Time for 1 Tank.
      If (Unitted_LostFocus(UNITS_TIME, txtTankParameters(1), UnitsTankParam(1), NewVal, Temp_Text)) Then
        IsNew = True
        bub.TankHydraulicRetentionTime.ValChanged = True
        bub.TankHydraulicRetentionTime.UserInput = True
        'Standard time units are seconds, but TankHydraulicRetentionTime
        'is stored internally as hours.
        bub.TankHydraulicRetentionTime.Value = NewVal / 60# / 60#
        bub.CodeForTausAndTankVolumes = 1
        Call CalculateRetentionTimesAndTankVolumes
      End If
        
    Case 2        'Retention Time for All Tanks.
      If (Unitted_LostFocus(UNITS_TIME, txtTankParameters(2), UnitsTankParam(2), NewVal, Temp_Text)) Then
        IsNew = True
        bub.TotalHydraulicRetentionTime.ValChanged = True
        bub.TotalHydraulicRetentionTime.UserInput = True
        'Standard time units are seconds, but TotalHydraulicRetentionTime
        'is stored internally as hours.
        bub.TotalHydraulicRetentionTime.Value = NewVal / 60# / 60#
        bub.CodeForTausAndTankVolumes = 2
        Call CalculateRetentionTimesAndTankVolumes
      End If

    Case 3        'Volume of Each Tank.
      If (Unitted_LostFocus(UNITS_VOLUME, txtTankParameters(3), UnitsTankParam(3), NewVal, Temp_Text)) Then
        IsNew = True
        bub.TankVolume.ValChanged = True
        bub.TankVolume.UserInput = True
        bub.TankVolume.Value = NewVal
        Call CalculateRetentionTimesAndTankVolumes
      End If

    Case 4        'Volume of All Tanks.
      If (Unitted_LostFocus(UNITS_VOLUME, txtTankParameters(4), UnitsTankParam(4), NewVal, Temp_Text)) Then
        IsNew = True
        bub.TotalTankVolume.ValChanged = True
        bub.TotalTankVolume.UserInput = True
        bub.TotalTankVolume.Value = NewVal
        bub.TankVolume.ValChanged = True
        bub.TankVolume.UserInput = True
        bub.TankVolume.Value = bub.TotalTankVolume.Value / bub.NumberOfTanks.Value
        
        Call CalculateRetentionTimesAndTankVolumes
      End If

  End Select

  If (IsNew) Then
    Call CalculateStantonNo

    Call CalculateEffluentConcentrationsBubble
    'Update everything:
    Call cboDesignContaminant_Click
  End If

  Call LostFocus_Handle(Me, txtTankParameters(Index), flag_ok)

End Sub

Private Sub UnitsConcResults_Click(Index As Integer)
Dim Dummy As Double
Dim ContaminantIndex As Integer
Dim i As Integer

  ContaminantIndex = cboDesignContaminant.ListIndex + 1
  i = ContaminantIndex

  On Error GoTo err_UnitsConcResults_Click

  Select Case Index
    Case 1            'Ci to Tank 1.
      Dummy = bub.Contaminant(i).Influent.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsConcResults(1), lblConcentrationResults(1))

    Case 2            'Yi to All Tanks.
      Dummy = 0
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsConcResults(2), lblConcentrationResults(2))

    Case 3            'Ce from Last Tank.
      Dummy = bub.DesignContaminant.Effluent(bub.NumberOfTanks.Value)
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsConcResults(3), lblConcentrationResults(3))

  End Select

exit_UnitsConcResults_Click:
  Exit Sub

err_UnitsConcResults_Click:
  Resume exit_UnitsConcResults_Click

End Sub

Private Sub UnitsConcResults_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsDesignContam_Click(Index As Integer)
Dim Dummy As Double
Dim ContaminantIndex As Integer
Dim i As Integer

  ContaminantIndex = cboDesignContaminant.ListIndex + 1
  i = ContaminantIndex

  On Error GoTo err_UnitsDesignContam_Click

  Select Case Index
    Case 0            'Influent Conc.
      Dummy = bub.Contaminant(i).Influent.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsDesignContam(0), lblDesignConcentrationValue(0))

    Case 1            'Treatment Obj.
      Dummy = bub.Contaminant(i).TreatmentObjective.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsDesignContam(1), lblDesignConcentrationValue(1))

    Case 3            'KLa
      Dummy = bub.ContaminantMassTransferCoefficient.Value
      Call Unitted_UnitChange(UNITS_INVERSETIME, Dummy, UnitsDesignContam(3), txtDesignConcentrationValue(3))

  End Select

exit_UnitsDesignContam_Click:
  Exit Sub

err_UnitsDesignContam_Click:
  Resume exit_UnitsDesignContam_Click


End Sub

Private Sub UnitsDesignContam_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsFlowParam_Click(Index As Integer)

  Select Case Index
    Case 0            'Water Flow Rate.
      Call Unitted_UnitChange(UNITS_FLOW, bub.WaterFlowRate.Value, UnitsFlowParam(0), txtFlowParameters(0))

    Case 3            'Air Flow Rate.
      Call Unitted_UnitChange(UNITS_FLOW, bub.AirFlowRate.Value, UnitsFlowParam(3), txtFlowParameters(3))
    
  End Select

End Sub

Private Sub UnitsFlowParam_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsOpCond_Click(Index As Integer)
Dim Dummy As Double

  Select Case Index
    Case 0
      'Note: Standard P units are Pa, but OperatingPressure
      'is stored internally in kPa units.
      Dummy = bub.OperatingPressure.Value * 101325#
      Call Unitted_UnitChange(UNITS_PRESSURE, Dummy, UnitsOpCond(0), txtOperatingPressure)

    Case 1
      Call Unitted_UnitChange(UNITS_TEMPERATURE, bub.operatingtemperature.Value, UnitsOpCond(1), txtOperatingTemperature)
    
  End Select

End Sub

Private Sub UnitsOpCond_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsOxygenRef_Click(Index As Integer)

  Select Case Index
    Case 1            'Liquid Diffusivity
      Call Unitted_UnitChange(UNITS_DIFFUSIVITY, bub.Oxygen.LiquidDiffusivity.Value, UnitsOxygenRef(1), txtOxygen(1))

    Case 2            'KLa
      Call Unitted_UnitChange(UNITS_INVERSETIME, bub.Oxygen.MassTransferCoefficient.Value, UnitsOxygenRef(2), txtOxygen(2))
    
  End Select

End Sub

Private Sub UnitsOxygenRef_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsTankParam_Click(Index As Integer)
Dim Dummy As Double

  Select Case Index
    Case 1            'Retention Time (1 Tank).
      'Standard time units are seconds, but TankHydraulicRetentionTime
      'is stored internally as hours.
      Dummy = bub.TankHydraulicRetentionTime.Value * 60 * 60#
      Call Unitted_UnitChange(UNITS_TIME, Dummy, UnitsTankParam(1), txtTankParameters(1))

    Case 2            'Retention Time (All Tanks).
      'Standard time units are seconds, but TotalHydraulicRetentionTime
      'is stored internally as hours.
      Dummy = bub.TotalHydraulicRetentionTime.Value * 60 * 60#
      Call Unitted_UnitChange(UNITS_TIME, Dummy, UnitsTankParam(2), txtTankParameters(2))

    Case 3            'Volume (1 Tank).
      Call Unitted_UnitChange(UNITS_VOLUME, bub.TankVolume.Value, UnitsTankParam(3), txtTankParameters(3))

    Case 4            'Volume (All Tanks).
      Call Unitted_UnitChange(UNITS_VOLUME, bub.TotalTankVolume.Value, UnitsTankParam(4), txtTankParameters(4))
    
  End Select

End Sub

Private Sub UnitsTankParam_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmBubbleAchievingRemovalEfficiency 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Bubble Aeration - Achieving Desired Removal Efficiency"
   ClientHeight    =   6075
   ClientLeft      =   2865
   ClientTop       =   3165
   ClientWidth     =   8970
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6075
   ScaleWidth      =   8970
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   492
      Left            =   4080
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   5280
      Width           =   852
   End
   Begin Threed.SSFrame Frame3D1 
      Height          =   1305
      Index           =   0
      Left            =   1980
      TabIndex        =   4
      Top             =   3630
      Width           =   4515
      _Version        =   65536
      _ExtentX        =   7964
      _ExtentY        =   2302
      _StockProps     =   14
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtAchieving 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   1
         Left            =   3060
         TabIndex        =   0
         Top             =   540
         Width           =   1272
      End
      Begin VB.TextBox txtAchieving 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   2
         Left            =   3060
         TabIndex        =   1
         Top             =   900
         Width           =   1272
      End
      Begin VB.Label lblAchievingLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Minimum Air To Water Ratio"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   180
         TabIndex        =   8
         Top             =   180
         Width           =   2715
      End
      Begin VB.Label lblAchievingLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air To Water Ratio"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   180
         TabIndex        =   7
         Top             =   540
         Width           =   2715
      End
      Begin VB.Label lblAchievingLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Number of Tanks"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   180
         TabIndex        =   6
         Top             =   900
         Width           =   2715
      End
      Begin VB.Label lblAchieving 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3060
         TabIndex        =   5
         Top             =   180
         Width           =   1275
      End
   End
   Begin VB.Label Label1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   3015
      Left            =   300
      TabIndex        =   3
      Top             =   240
      Width           =   8355
   End
End
Attribute VB_Name = "frmBubbleAchievingRemovalEfficiency"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim MinimumAirToWaterRatio As Double
Dim AirToWaterRatio As Double
Dim NumberOfTanks As Long

Private Sub cmdOK_Click()

    If Abs(bub.MinimumAirToWaterRatio.Value - MinimumAirToWaterRatio) > TOLERANCE Then
       bub.MinimumAirToWaterRatio.Value = MinimumAirToWaterRatio
       frmBubble!lblFlowParameters(1).Caption = Format$(bub.MinimumAirToWaterRatio.Value, GetTheFormat(bub.MinimumAirToWaterRatio.Value))
    End If

    If Abs(bub.AirToWaterRatio.Value - AirToWaterRatio) > TOLERANCE Then
       bub.AirToWaterRatio.Value = AirToWaterRatio
       bub.AirToWaterRatio.UserInput = True
       frmBubble!txtFlowParameters(2).Text = Format$(bub.AirToWaterRatio.Value, GetTheFormat(bub.AirToWaterRatio.Value))
       Call CalculateAirFlowRate
    End If

    If Abs(bub.NumberOfTanks.Value - NumberOfTanks) > TOLERANCE Then
       bub.NumberOfTanks.Value = NumberOfTanks
       frmBubble!txtTankParameters(0).Text = Format$(bub.NumberOfTanks.Value, "0")
    End If

    frmBubbleAchievingRemovalEfficiency.Hide
End Sub

Private Sub Form_Activate()
    Dim msg As String
    
    'Center the form on the screen
    If WindowState = 0 Then
       'don't attempt if screen Minimized or Maximized
      If frmPTADScreen1.Visible = True Then Move frmPTADScreen1.Left + (frmPTADScreen1.Width / 2) - (frmBubbleAchievingRemovalEfficiency.Width / 2), frmPTADScreen1.Top + (frmPTADScreen1.Height / 2) - (frmBubbleAchievingRemovalEfficiency.Height / 2)
      If frmPTADScreen2.Visible = True Then Move frmPTADScreen2.Left + (frmPTADScreen2.Width / 2) - (frmBubbleAchievingRemovalEfficiency.Width / 2), frmPTADScreen2.Top + (frmPTADScreen2.Height / 2) - (frmBubbleAchievingRemovalEfficiency.Height / 2)
      If frmBubble.Visible = True Then Move frmBubble.Left + (frmBubble.Width / 2) - (frmBubbleAchievingRemovalEfficiency.Width / 2), frmBubble.Top + (frmBubble.Height / 2) - (frmBubbleAchievingRemovalEfficiency.Height / 2)
      If frmSurface.Visible = True Then Move frmSurface.Left + (frmSurface.Width / 2) - (frmBubbleAchievingRemovalEfficiency.Width / 2), frmSurface.Top + (frmSurface.Height / 2) - (frmBubbleAchievingRemovalEfficiency.Height / 2)
    End If

    msg = "It is not possible to achieve the desired removal efficiency with an air to water ratio "
    msg = msg & "that is less than the minimum air to water ratio.  Currently, the air to water "
    msg = msg & "ratio is less than the minimum air to water ratio, as shown below."
    msg = msg & "." & Chr$(13) & Chr$(13)
    msg = msg & "There are three options to allow the system to achieve the desired removal efficiency:"
    msg = msg & Chr$(13)
    msg = msg & "    (1)  Increase the air to water ratio to a number > the minimum air to water ratio" & Chr$(13)
    msg = msg & "    (2)  Increase the number of tanks, thereby reducing the minimum air to water ratio" & Chr$(13)
    msg = msg & "    (3)  Do a combination of 1 and 2" & Chr$(13) & Chr$(13)
    msg = msg & "In design mode, the goal is to achieve the desired removal efficiency.  Therefore, it "
    msg = msg & "is neccessary to arrive at a situation where air to water ratio is greater than "
    msg = msg & "minimum air to water ratio before continuing.  Do this by performing operations "
    msg = msg & "(1), (2), or (3) above.  When the air to water ratio is greater than the minimum "
    msg = msg & "air to water ratio, it will be possible to return to the main Bubble Aeration - "
    msg = msg & "Design Mode screen (i.e. the OK button will become enabled)."
    
    Label1.Caption = msg

    MinimumAirToWaterRatio = bub.MinimumAirToWaterRatio.Value
    AirToWaterRatio = bub.AirToWaterRatio.Value
    NumberOfTanks = bub.NumberOfTanks.Value

    cmdOK.Enabled = False

End Sub
Private Sub Form_Load()
  'REPLACE WHITE BACKGROUND WITH TRANSPARENT BACKGROUND.
  Label1.BackStyle = 0
End Sub


Private Sub txtAchieving_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtAchieving(Index), Temp_Text)
End Sub

Private Sub txtAchieving_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtAchieving_LostFocus(Index As Integer)
    Dim ValueChanged As Integer, Dummy As Double
    Dim msg As String
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtAchieving(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtAchieving(Index), Temp_Text)

    If Not IsError Then
       If Index = 2 Then
          Dummy = CInt(txtAchieving(Index).Text)
       Else
          Dummy = CDbl(txtAchieving(Index).Text)
       End If

       Select Case Index
          Case 1    'Air To Water Ratio
             Call TextNumberChanged(ValueChanged, txtAchieving(1), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   AirToWaterRatio = Dummy
                Else
                   txtAchieving(1).Text = Temp_Text
                    txtAchieving(1).SetFocus
                    Call LostFocus_Handle(Me, txtAchieving(Index), flag_ok)
                   Exit Sub
                End If
             End If

          Case 2    'Number of Tanks in Series
             Call TextNumberChanged(ValueChanged, txtAchieving(2), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   NumberOfTanks = Dummy
                   Call VQMINBUB(MinimumAirToWaterRatio, bub.DesignContaminant.Influent.Value, bub.DesignContaminant.TreatmentObjective.Value, bub.DesignContaminant.HenrysConstant.Value, NumberOfTanks)
                   lblAchieving(0).Caption = Format$(MinimumAirToWaterRatio, GetTheFormat(MinimumAirToWaterRatio))
                Else
                   txtAchieving(2).Text = Temp_Text
                   txtAchieving(2).SetFocus
                    Call LostFocus_Handle(Me, txtAchieving(Index), flag_ok)
                   Exit Sub
                End If
             End If
       End Select
       If AirToWaterRatio > MinimumAirToWaterRatio Then
          cmdOK.Enabled = True
          cmdOK.SetFocus
       Else
          cmdOK.Enabled = False
       End If
    End If
  Call LostFocus_Handle(Me, txtAchieving(Index), flag_ok)


End Sub


VERSION 5.00
Begin VB.Form frmBubbleEffluentConcentrations 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Effluent Concentrations from Each Tank"
   ClientHeight    =   6315
   ClientLeft      =   5985
   ClientTop       =   2115
   ClientWidth     =   4215
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6315
   ScaleWidth      =   4215
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   1830
      TabIndex        =   0
      Top             =   5580
      Width           =   555
   End
   Begin VB.Label lblLabel1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Tank"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   450
      TabIndex        =   48
      Top             =   420
      Width           =   675
   End
   Begin VB.Label lblLabel 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   495
      Index           =   1
      Left            =   1530
      TabIndex        =   47
      Top             =   180
      Width           =   1215
   End
   Begin VB.Label lblLabel 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   495
      Index           =   2
      Left            =   2910
      TabIndex        =   46
      Top             =   180
      Width           =   1215
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   150
      TabIndex        =   45
      Top             =   720
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   150
      TabIndex        =   44
      Top             =   1020
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   150
      TabIndex        =   43
      Top             =   1320
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   150
      TabIndex        =   42
      Top             =   1620
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   5
      Left            =   150
      TabIndex        =   41
      Top             =   1920
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   6
      Left            =   150
      TabIndex        =   40
      Top             =   2220
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   150
      TabIndex        =   39
      Top             =   2520
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   150
      TabIndex        =   38
      Top             =   2820
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   150
      TabIndex        =   37
      Top             =   3120
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   10
      Left            =   150
      TabIndex        =   36
      Top             =   3420
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   1530
      TabIndex        =   35
      Top             =   720
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   1530
      TabIndex        =   34
      Top             =   1020
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   1530
      TabIndex        =   33
      Top             =   1320
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   1530
      TabIndex        =   32
      Top             =   1620
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   5
      Left            =   1530
      TabIndex        =   31
      Top             =   1920
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   6
      Left            =   1530
      TabIndex        =   30
      Top             =   2220
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   1530
      TabIndex        =   29
      Top             =   2520
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   1530
      TabIndex        =   28
      Top             =   2820
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   1530
      TabIndex        =   27
      Top             =   3120
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   10
      Left            =   1530
      TabIndex        =   26
      Top             =   3420
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   2910
      TabIndex        =   25
      Top             =   720
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   2910
      TabIndex        =   24
      Top             =   1020
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   2910
      TabIndex        =   23
      Top             =   1320
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   2910
      TabIndex        =   22
      Top             =   1620
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   5
      Left            =   2910
      TabIndex        =   21
      Top             =   1920
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   6
      Left            =   2910
      TabIndex        =   20
      Top             =   2220
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   2910
      TabIndex        =   19
      Top             =   2520
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   2910
      TabIndex        =   18
      Top             =   2820
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   2910
      TabIndex        =   17
      Top             =   3120
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   10
      Left            =   2910
      TabIndex        =   16
      Top             =   3420
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   11
      Left            =   150
      TabIndex        =   15
      Top             =   3720
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   12
      Left            =   150
      TabIndex        =   14
      Top             =   4020
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   13
      Left            =   150
      TabIndex        =   13
      Top             =   4320
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   14
      Left            =   150
      TabIndex        =   12
      Top             =   4620
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   15
      Left            =   150
      TabIndex        =   11
      Top             =   4920
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   11
      Left            =   1530
      TabIndex        =   10
      Top             =   3720
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   12
      Left            =   1530
      TabIndex        =   9
      Top             =   4020
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   13
      Left            =   1530
      TabIndex        =   8
      Top             =   4320
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   14
      Left            =   1530
      TabIndex        =   7
      Top             =   4620
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   15
      Left            =   1530
      TabIndex        =   6
      Top             =   4920
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   15
      Left            =   2910
      TabIndex        =   5
      Top             =   4920
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   11
      Left            =   2910
      TabIndex        =   4
      Top             =   3720
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   12
      Left            =   2910
      TabIndex        =   3
      Top             =   4020
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   13
      Left            =   2910
      TabIndex        =   2
      Top             =   4320
      Width           =   1155
   End
   Begin VB.Label lblGasEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   14
      Left            =   2910
      TabIndex        =   1
      Top             =   4620
      Width           =   1155
   End
End
Attribute VB_Name = "frmBubbleEffluentConcentrations"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
    frmBubbleEffluentConcentrations.Hide
End Sub

Private Sub Form_Activate()
    Dim PositionLeft As Integer
  
  'Position form in upper-right corner.
  Call PositionThisForm(Me, POSITIONFORM_UR)

End Sub

Private Sub Form_Load()
    
  lblLabel(1).Caption = "Liq. Phase" & Chr(13) & "(" & Chr$(181) & "g/L)"
  lblLabel(2).Caption = "Gas Phase" & Chr$(13) & "(" & Chr$(181) & "g/L)"
  
  'Position form in upper-right corner.
  Call PositionThisForm(Me, POSITIONFORM_UR)

End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmBubblePower 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Power Calculations"
   ClientHeight    =   4845
   ClientLeft      =   6105
   ClientTop       =   3360
   ClientWidth     =   4710
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4845
   ScaleWidth      =   4710
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   492
      Left            =   1770
      TabIndex        =   16
      Top             =   4080
      Width           =   1212
   End
   Begin Threed.SSFrame fraBlowerBrakePower 
      Height          =   1935
      Left            =   240
      TabIndex        =   4
      Top             =   210
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   3408
      _StockProps     =   14
      Caption         =   "Blower Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   1
         Left            =   2490
         TabIndex        =   1
         Top             =   720
         Width           =   1572
      End
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   0
         Left            =   2490
         TabIndex        =   0
         Top             =   360
         Width           =   1572
      End
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   2
         Left            =   2490
         TabIndex        =   2
         Top             =   1080
         Width           =   1572
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   2490
         TabIndex        =   10
         Top             =   1440
         Width           =   1575
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Blower Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   90
         TabIndex        =   9
         Top             =   1440
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Blower Efficiency"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   90
         TabIndex        =   8
         Top             =   720
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Inlet Air Temperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   90
         TabIndex        =   7
         Top             =   360
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tank Water Depth"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   90
         TabIndex        =   6
         Top             =   1080
         Width           =   2295
      End
   End
   Begin Threed.SSFrame SSFrame1 
      Height          =   1455
      Left            =   240
      TabIndex        =   5
      Top             =   2310
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7435
      _ExtentY        =   2561
      _StockProps     =   14
      Caption         =   "Total Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.23
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   5
         Left            =   2490
         TabIndex        =   3
         Top             =   600
         Width           =   1572
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   2490
         TabIndex        =   15
         Top             =   960
         Width           =   1575
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Total Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   90
         TabIndex        =   14
         Top             =   960
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "No. of Tanks (in Series)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   90
         TabIndex        =   13
         Top             =   300
         Width           =   2295
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2490
         TabIndex        =   12
         Top             =   300
         Width           =   1575
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "No. of Blowers per Tank"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   90
         TabIndex        =   11
         Top             =   600
         Width           =   2295
      End
   End
End
Attribute VB_Name = "frmBubblePower"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
    frmBubblePower.Hide
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()

    Call CenterThisForm(Me)
    Call LabelsBubblePowerSI

End Sub

Private Sub txtPower_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtPower(Index), Temp_Text)
End Sub

Private Sub txtPower_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtPower_LostFocus(Index As Integer)
    Dim ValueChanged As Integer, Dummy As Double
    Dim msg As String
    Dim CalculatedPower As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtPower(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtPower(Index), Temp_Text)

    If Not IsError Then
       If Index = 5 Then
          Dummy = CInt(txtPower(Index).Text)
       Else
          Dummy = CDbl(txtPower(Index).Text)
       End If
       Select Case Index
          Case 0    'InletAirTemperature
             Call TextNumberChanged(ValueChanged, txtPower(0), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   bub.Power.InletAirTemperature = Dummy
                Else
                   txtPower(0).Text = Temp_Text
                   txtPower(0).SetFocus
                   Exit Sub
                End If
             End If
          Case 1    'Blower Efficiency
             Call TextNumberChanged(ValueChanged, txtPower(1), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   bub.Power.BlowerEfficiency = Dummy
                Else
                   txtPower(1).Text = Temp_Text
                   txtPower(1).SetFocus
                   Exit Sub
                End If
             End If
          Case 2    'Tank Water Depth
             Call TextNumberChanged(ValueChanged, txtPower(2), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   bub.Power.TankWaterDepth = Dummy
                Else
                   txtPower(2).Text = Temp_Text
                   txtPower(2).SetFocus
                   Exit Sub
                End If
             End If

          Case 5    'Number of Blowers per Tank
             Call TextNumberChanged(ValueChanged, txtPower(5), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   bub.Power.NumberOfBlowersinEachTank = Dummy
                Else
                   txtPower(5).Text = Temp_Text
                   txtPower(5).SetFocus
                   Exit Sub
                End If
             End If

       End Select

       If ValueChanged Then
          Call CalculatePowerBubble
          
             frmBubblePower!txtPower(0).Text = Format$(bub.Power.InletAirTemperature, GetTheFormat(bub.Power.InletAirTemperature))
             frmBubblePower!txtPower(1).Text = Format$(bub.Power.BlowerEfficiency, GetTheFormat(bub.Power.BlowerEfficiency))
             frmBubblePower!txtPower(2).Text = Format$(bub.Power.TankWaterDepth, GetTheFormat(bub.Power.TankWaterDepth))
             frmBubblePower!lblPower(3).Caption = Format$(bub.Power.BlowerBrakePower, GetTheFormat(bub.Power.BlowerBrakePower))
             frmBubblePower!lblPower(4).Caption = Format$(bub.NumberOfTanks.Value, "0")
             frmBubblePower!txtPower(5).Text = Format$(bub.Power.NumberOfBlowersinEachTank, "0")
             frmBubblePower!lblPower(6).Caption = Format$(bub.Power.TotalBrakePower, GetTheFormat(bub.Power.TotalBrakePower))
          
       End If

    End If
  Call LostFocus_Handle(Me, txtPower(Index), flag_ok)


End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmContaminantPropertyEdit 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Contaminant Properties--{ModelName}"
   ClientHeight    =   5640
   ClientLeft      =   2835
   ClientTop       =   3810
   ClientWidth     =   7680
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5640
   ScaleWidth      =   7680
   ShowInTaskbar   =   0   'False
   Begin VB.ComboBox cbochemname 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   3150
      Style           =   2  'Dropdown List
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   180
      Width           =   4455
   End
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Caption         =   "&OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   210
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   4740
      Width           =   2175
   End
   Begin VB.CommandButton cmdCancel 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "&Cancel"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   210
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   4260
      Width           =   2175
   End
   Begin VB.TextBox txtTestDDE 
      Appearance      =   0  'Flat
      Height          =   288
      Index           =   2
      Left            =   330
      TabIndex        =   13
      Text            =   "For DDE, not visible"
      Top             =   3720
      Visible         =   0   'False
      Width           =   1812
   End
   Begin VB.TextBox txtTestDDE 
      Appearance      =   0  'Flat
      Height          =   288
      Index           =   1
      Left            =   330
      TabIndex        =   12
      Text            =   "For DDE, not visible"
      Top             =   3420
      Visible         =   0   'False
      Width           =   1812
   End
   Begin VB.TextBox txtTestDDE 
      Appearance      =   0  'Flat
      Height          =   288
      Index           =   0
      Left            =   330
      TabIndex        =   11
      Text            =   "For DDE, not visible"
      Top             =   3120
      Visible         =   0   'False
      Width           =   1812
   End
   Begin Threed.SSFrame Frame1 
      Height          =   2055
      Left            =   30
      TabIndex        =   9
      Top             =   120
      Width           =   2535
      _Version        =   65536
      _ExtentX        =   4471
      _ExtentY        =   3625
      _StockProps     =   14
      Caption         =   "StEPP"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdImport 
         Appearance      =   0  'Flat
         Caption         =   "Import StEPP Export File"
         Height          =   465
         Left            =   150
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   870
         Width           =   2250
      End
      Begin VB.CommandButton cmdImportClipboard 
         Appearance      =   0  'Flat
         Caption         =   "Import From Clipboard"
         Height          =   465
         Left            =   150
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   1320
         Width           =   2250
      End
      Begin VB.Label Label1 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Obtain component properties from StEPP:"
         ForeColor       =   &H80000008&
         Height          =   465
         Left            =   150
         TabIndex        =   18
         Top             =   360
         Width           =   2295
      End
   End
   Begin Threed.SSFrame fraContaminantProperties 
      Height          =   4335
      Left            =   2730
      TabIndex        =   10
      Top             =   900
      Width           =   4875
      _Version        =   65536
      _ExtentX        =   8599
      _ExtentY        =   7646
      _StockProps     =   14
      Caption         =   "Pick Flow and Loading Parameters to Specify:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtConcentration 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2190
         TabIndex        =   8
         Top             =   3840
         Width           =   1215
      End
      Begin VB.TextBox txtConcentration 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2190
         TabIndex        =   7
         Top             =   3480
         Width           =   1215
      End
      Begin VB.TextBox txtContaminantProperties 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   2190
         TabIndex        =   6
         Top             =   2940
         Width           =   1215
      End
      Begin VB.TextBox txtContaminantProperties 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2190
         TabIndex        =   5
         Top             =   2580
         Width           =   1215
      End
      Begin VB.TextBox txtContaminantProperties 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2190
         TabIndex        =   4
         Top             =   2220
         Width           =   1215
      End
      Begin VB.TextBox txtContaminantProperties 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2190
         TabIndex        =   3
         Top             =   1860
         Width           =   1215
      End
      Begin VB.TextBox txtContaminantProperties 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2190
         TabIndex        =   2
         Top             =   1500
         Width           =   1215
      End
      Begin VB.TextBox txtContaminantProperties 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2190
         TabIndex        =   1
         Top             =   1140
         Width           =   1215
      End
      Begin VB.TextBox txtContaminantName 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   150
         TabIndex        =   0
         Top             =   600
         Width           =   4455
      End
      Begin VB.ComboBox UnitsProp 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3450
         Style           =   2  'Dropdown List
         TabIndex        =   26
         TabStop         =   0   'False
         Top             =   1140
         Width           =   1155
      End
      Begin VB.ComboBox UnitsProp 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3450
         Style           =   2  'Dropdown List
         TabIndex        =   25
         TabStop         =   0   'False
         Top             =   1860
         Width           =   1155
      End
      Begin VB.ComboBox UnitsProp 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3450
         Style           =   2  'Dropdown List
         TabIndex        =   24
         TabStop         =   0   'False
         Top             =   2220
         Width           =   1155
      End
      Begin VB.ComboBox UnitsProp 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   4
         Left            =   3450
         Style           =   2  'Dropdown List
         TabIndex        =   23
         TabStop         =   0   'False
         Top             =   2580
         Width           =   1155
      End
      Begin VB.ComboBox UnitsProp 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   5
         Left            =   3450
         Style           =   2  'Dropdown List
         TabIndex        =   22
         TabStop         =   0   'False
         Top             =   2940
         Width           =   1155
      End
      Begin VB.ComboBox UnitsConc 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3450
         Style           =   2  'Dropdown List
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   3480
         Width           =   1155
      End
      Begin VB.ComboBox UnitsConc 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3450
         Style           =   2  'Dropdown List
         TabIndex        =   20
         TabStop         =   0   'False
         Top             =   3840
         Width           =   1155
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Treatment Obj."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   -270
         TabIndex        =   36
         Top             =   3840
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Influent Conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   -270
         TabIndex        =   35
         Top             =   3480
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Gas Diffusivity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   -270
         TabIndex        =   34
         Top             =   2940
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Liquid Diffusivity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   -270
         TabIndex        =   33
         Top             =   2580
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Normal Boiling Point"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   -270
         TabIndex        =   32
         Top             =   2220
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Molar Volume"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   -270
         TabIndex        =   31
         Top             =   1860
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Henry's Constant"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -270
         TabIndex        =   30
         Top             =   1500
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Molecular Weight"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -270
         TabIndex        =   29
         Top             =   1140
         Width           =   2295
      End
      Begin VB.Label lblContaminantProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Name:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   150
         TabIndex        =   28
         Top             =   300
         Width           =   675
      End
      Begin VB.Line Line1 
         X1              =   -60
         X2              =   5040
         Y1              =   1020
         Y2              =   1020
      End
      Begin VB.Line Line2 
         X1              =   -90
         X2              =   4950
         Y1              =   3360
         Y2              =   3360
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( - )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3450
         TabIndex        =   27
         Top             =   1500
         Width           =   1155
      End
   End
End
Attribute VB_Name = "frmContaminantPropertyEdit"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim Temp_Text As String
Dim ThisContaminant As ContaminantPropertyType

Dim loading As Integer

Private Sub cbochemname_Click()
Dim i As Integer
Dim x As rec_frmContaminantPropertyEdit
Dim xu As rec_Units_frmContaminantPropertyEdit
  
 If loading Then
      Screen.MousePointer = 11

      'change name on list
      x = Data_frmContaminantPropertyEdit
     cbochemname.List(x.DoEditNumber - 1) = txtContaminantName.Text

      'save changes
      x.Contaminants(x.DoEditNumber) = ThisContaminant

    'setup new chemical
    ThisContaminant = x.Contaminants(cbochemname.ListIndex + 1)
    x.DoEditNumber = cbochemname.ListIndex + 1
    
    Data_frmContaminantPropertyEdit = x
    
    'display new chemical
    txtContaminantName.Text = ThisContaminant.Name
    txtContaminantName.Enabled = True
    txtContaminantProperties(0).Text = Format$(ThisContaminant.MolecularWeight.Value, "0.00")
    txtContaminantProperties(1).Text = Format$(ThisContaminant.HenrysConstant.Value, GetTheFormat(ThisContaminant.HenrysConstant.Value))
    txtContaminantProperties(2).Text = Format$(ThisContaminant.MolarVolume.Value, GetTheFormat(ThisContaminant.MolarVolume.Value))
    txtContaminantProperties(3).Text = Format$(ThisContaminant.NormalBoilingPoint.Value - 273.15, "0.0")
    txtContaminantProperties(4).Text = Format$(ThisContaminant.LiquidDiffusivity.Value, GetTheFormat(ThisContaminant.LiquidDiffusivity.Value))
    txtContaminantProperties(5).Text = Format$(ThisContaminant.GasDiffusivity.Value, GetTheFormat(ThisContaminant.GasDiffusivity.Value))
    txtConcentration(0).Text = Format$(ThisContaminant.Influent.Value, GetTheFormat(ThisContaminant.Influent.Value))
    txtConcentration(1).Text = Format$(ThisContaminant.TreatmentObjective.Value, GetTheFormat(ThisContaminant.TreatmentObjective.Value))
     
    
    xu = Units_frmContaminantPropertyEdit
    Call LabelsPropContaminant(UNITSTYPE_SI)
    For i = 0 To 5
      If (i <> 1) Then Call SetUnits(UnitsProp(i), xu.UnitsProp(i))
    Next i
    For i = 0 To 1
      Call SetUnits(UnitsConc(i), xu.UnitsConc(i))
    Next i

    Data_frmContaminantPropertyEdit = x
    Screen.MousePointer = 0
 End If

End Sub

Private Sub cmdCancel_Click()
Dim x As rec_frmContaminantPropertyEdit

  x = Data_frmContaminantPropertyEdit
  If (x.DoAdd) Then
    x.CancelledEdit = False
    x.CancelledAdd = True
  Else
    x.CancelledEdit = True
    x.CancelledAdd = False
  End If
  Data_frmContaminantPropertyEdit = x
    
  '  Scr1.Contaminant(Scr1.Chemical).Pressure = OriginalProperties.Pressure
  '  Scr1.Contaminant(Scr1.Chemical).Temperature = OriginalProperties.Temperature
  '  Scr1.Contaminant(Scr1.Chemical).Name = OriginalProperties.Name
  '  Scr1.Contaminant(Scr1.Chemical).MolecularWeight.Value = OriginalProperties.MolecularWeight.Value
  '  Scr1.Contaminant(Scr1.Chemical).HenrysConstant.Value = OriginalProperties.HenrysConstant.Value
  '  Scr1.Contaminant(Scr1.Chemical).MolarVolume.Value = OriginalProperties.MolarVolume.Value
  '  Scr1.Contaminant(Scr1.Chemical).NormalBoilingPoint.Value = OriginalProperties.NormalBoilingPoint.Value
  '  Scr1.Contaminant(Scr1.Chemical).LiquidDiffusivity.Value = OriginalProperties.LiquidDiffusivity.Value
  '  Scr1.Contaminant(Scr1.Chemical).GasDiffusivity.Value = OriginalProperties.GasDiffusivity.Value
  '  Scr1.Contaminant(Scr1.Chemical).Influent.Value = OriginalProperties.Influent.Value
  '  Scr1.Contaminant(Scr1.Chemical).TreatmentObjective.Value = OriginalProperties.TreatmentObjective.Value
  '
  '
  '  If (AddFlag) Then
  '    Scr1.NumChemical = Scr1.NumChemical - 1
  '    Scr1.Chemical = Scr1.NumChemical
  '  End If

  Unload Me

End Sub

Private Sub cmdImport_Click()
Dim f As Integer
Dim LineCount As Integer
Dim ThisLine As String
Dim AllLines As String
Dim InvalidFile As Integer
Const MAX_LINE_COUNT = 1000     'SOMEWHAT ARBITRARY.
Dim Ctl As Control
Set Ctl = frmBubble.CommonDialog1
Dim Use_Filename As String
  
  On Error GoTo err_cmdImportFromFile_Click
  Ctl.CancelError = True
  Ctl.DialogTitle = "Load StEPP Export File"
  Ctl.Filter = "All Files (*.*)|*.*|StEPP Export Files (*.exp)|*.exp"
  Ctl.FilterIndex = 2
  Ctl.Action = 1
  Use_Filename = Ctl.Filename
  If (Use_Filename = "") Then
    Exit Sub
  End If
  f = FreeFile
  LineCount = 0
  Open Use_Filename For Input As #f
  ''''Use_Filename = ""
  InvalidFile = False
  Do While (1 = 1)
    If (EOF(f)) Then Exit Do
    Line Input #f, ThisLine
    AllLines = AllLines & ThisLine & Chr$(13) & Chr$(10)
    LineCount = LineCount + 1
    If (LineCount > MAX_LINE_COUNT) Then
      InvalidFile = True
      Exit Do
    End If
  Loop
  Close #f
  If (InvalidFile) Then
    MsgBox "This is not a valid StEPP export file."
    Exit Sub
  End If
  'DO THE IMPORT.
  Clipboard.SetText AllLines
  Call cmdImportClipboard_Click
  Exit Sub
exit_err_cmdImportFromFile_Click:
  Exit Sub
err_cmdImportFromFile_Click:
  If (Err = 32755) Then
    'DO NOTHING.
  Else
    MsgBox "An error #" & Trim$(Str$(Err)) & " occurred."
  End If
  Resume exit_err_cmdImportFromFile_Click




'Dim f As Integer
'Dim s1 As String
'Dim s2 As String
'Dim s3 As String
'Dim msg As String
'Dim response As Integer
'Dim n As Integer
'Dim import_count As Integer
'Dim now_chemical As String
'Dim now_cas As String
'Dim ImportFile As String
'Dim this_chemical As String
'Dim thiscomp As ContaminantPropertyType
'Dim xxx As StEPPLink_Property
'Dim i As Integer
'
  'On Error GoTo ImportError
  ''tell user find the file
  'On Error Resume Next
  'frmBubble!CMDialog1.Filename = ""
  'frmBubble!CMDialog1.DefaultExt = "exp"
  'frmBubble!CMDialog1.Filter = "StEPP Export Files (*.exp)|*.exp"
  'frmBubble!CMDialog1.DialogTitle = "Load StEPP Export File"
  'frmBubble!CMDialog1.Flags = OFN_FILEMUSTEXIST Or OFN_PATHMUSTEXIST
  'frmBubble!CMDialog1.Action = 1
  'ImportFile = frmBubble!CMDialog1.Filename
  'frmBubble!CMDialog1.Filename = ""
  'If Not fileexists(ImportFile) Then
  '  Exit Sub
  'End If
  '
  ''read it in
  'n = 0
  'f = FreeFile
  'Open ImportFile For Input As #f

'  Input #f, s1
'
'  ' make sure valid export file from stepp
'  If s1 <> "1234567890" Then
'      MsgBox "File not valid Stepp export file", 48, "Asap-File import"
'      Exit Sub
'  End If
'
'  Input #f, s1
'    frmStEPPLink_Pressure = CDbl(Trim(s1))
'  Input #f, s1
'    frmStEPPLink_Temperature = CDbl(Trim(s1))
'
'  'handle temp pressure check
'  If frmBubble.Visible = True Then
'
'    If ((frmStEPPLink_Pressure <> frmBubble!txtOperatingPressure) Or (frmStEPPLink_Temperature <> frmBubble!txtOperatingTemperature)) Then
'
'   msg = "The physical property file from StEPP contains properties at a pressure of "
'   msg = msg & frmStEPPLink_Pressure & " and a temperature " & frmStEPPLink_Temperature & "."
'   msg = msg & " Do you wish to continue importing the data?"
'
'   response = MsgBox(msg, MB_ICONSTOP + MB_YESNO, Application_Name)
'   If response = 7 Then Exit Sub
'    End If
'
'  ElseIf frmSurface.Visible = True Then
'    If ((frmStEPPLink_Pressure <> frmSurface!txtOperatingPressure) Or (frmStEPPLink_Temperature <> frmSurface!txtOperatingTemperature)) Then
'
'   msg = "The physical property file from StEPP contains properties at a pressure of "
'   msg = msg & frmStEPPLink_Pressure & " and a temperature " & frmStEPPLink_Temperature & "."
'   msg = msg & " Do you wish to continue importing the data?"
'
'   response = MsgBox(msg, MB_ICONSTOP + MB_YESNO, Application_Name)
'   If response = 7 Then Exit Sub
'    End If
'
'  ElseIf frmPTADScreen1.Visible = True Then
'    If ((frmStEPPLink_Pressure <> frmPTADScreen1!txtOperatingPressure) Or (frmStEPPLink_Temperature <> frmPTADScreen1!txtOperatingTemperature)) Then
'
'     msg = "The physical property file from StEPP contains properties at a pressure of "
'     msg = msg & frmStEPPLink_Pressure & " and a temperature " & frmStEPPLink_Temperature & "."
'     msg = msg & " Do you wish to continue importing the data?"
'
'     response = MsgBox(msg, MB_ICONSTOP + MB_YESNO, Application_Name)
'     If response = 7 Then Exit Sub
'    End If
'
'  Else
'    If ((frmStEPPLink_Pressure <> frmPTADScreen2!txtOperatingPressure) Or (frmStEPPLink_Temperature <> frmPTADScreen2!txtOperatingTemperature)) Then
'
'     msg = "The physical property file from StEPP contains properties at a pressure of "
'     msg = msg & frmStEPPLink_Pressure & " and a temperature " & frmStEPPLink_Temperature & "."
'     msg = msg & " Do you wish to continue importing the data?"
'
'     response = MsgBox(msg, MB_ICONSTOP + MB_YESNO, Application_Name)
'     If response = 7 Then Exit Sub
'    End If
'
'  End If
'
'
'  Do While (1 = 1)
'    If (EOF(f)) Then Exit Do
'    Input #f, s1, s2, s3
'    If (s1 = "END_OF_FILE") Then Exit Do
'    If (UCase$(s1) = "CHEMICAL") Then
'
'    If frmSurface.Visible = True Then
'       response = 0
'
'       For i = 1 To frmSurface!cboDesignContaminant.ListCount
'         If Trim(s2) = frmSurface!cboDesignContaminant.List(i) Then
'            response = 1
'         End If
'       Next i
'
'    ElseIf frmBubble.Visible = True Then
'       response = 0
'
'       For i = 1 To frmBubble!cboDesignContaminant.ListCount
'         If Trim(s2) = frmBubble!cboDesignContaminant.List(i) Then
'            response = 1
'         End If
'       Next i
'
'    ElseIf frmPTADScreen1.Visible = True Then
'       response = 0
'
'       For i = 1 To frmPTADScreen1!cboSelectCompo.ListCount
'         If Trim(s2) = frmPTADScreen1!cboSelectCompo.List(i) Then
'            response = 1
'         End If
'       Next i
'
'    Else
'       response = 0
'
'       For i = 1 To frmPTADScreen2!cboSelectCompo.ListCount
'         If Trim(s2) = frmPTADScreen2!cboSelectCompo.List(i) Then
'            response = 1
'         End If
'       Next i
'    End If
'
'      If response = 1 Then
'         s2 = ""
'      Else
'         now_chemical = s2
'         now_cas = s3
'         import_count = import_count + 1
'      End If
'    Else
'      N = N + 1
'      ReDim Preserve StEPPLink_AllProps(1 To N)
'      StEPPLink_AllProps(N).chemical = now_chemical
'      StEPPLink_AllProps(N).CAS = now_cas
'      StEPPLink_AllProps(N).propname = s1
'      StEPPLink_AllProps(N).units = s2
'      If (UCase$(s3) <> "UNAVAILABLE") Then
'        StEPPLink_AllProps(N).Val = CDbl(s3)
'        StEPPLink_AllProps(N).avail = True
'      Else
'        StEPPLink_AllProps(N).Val = 0#
'        StEPPLink_AllProps(N).avail = False
'      End If
'    End If
'  Loop
'
'  Close #f
'
'
''********** take stuff read in and store it corecctly
'    ReDim StEPPLink_RequiredProps(1 To 6)
'    StEPPLink_RequiredProps(1) = "HenrysConstant"
'    StEPPLink_RequiredProps(2) = "MolecularWeight"
'    StEPPLink_RequiredProps(3) = "NormalBoilingPoint"
'    StEPPLink_RequiredProps(4) = "MolarVolumeAtNBP"
'    StEPPLink_RequiredProps(5) = "LiquidDiffusivity"
'    StEPPLink_RequiredProps(6) = "GasDiffusivity"
'
'    ReDim StEPPLink_CurrentChemicalNames(0 To import_count)
'
'    '-- Call routine to filter out components that lack any of
'    '.. the properties listed above
'    Call StEPPLink_FilterUnimportable
'
'    '-- CLIENT-SPECIFIC: Import the acceptable components to memory structures
'    For i = 1 To UBound(StEPPLink_ImportSucceeded_Name)
'      this_chemical = StEPPLink_ImportSucceeded_Name(i)
'
'      'Set all property defaults
'      'Call SetComponentDefaults(thiscomp, -1)
'      ThisComp.Influent.Value = 10#
'      ThisComp.TreatmentObjective.Value = 2#
'      XXX = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "MolecularWeight"))
'      ThisComp.Name = XXX.chemical
'      'thiscomp.Cas = CLng(xxx.Cas)
'
'      'Import each property
'      XXX = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "MolecularWeight"))
'      ThisComp.MolecularWeight.Value = XXX.Val
'      ThisComp.MolecularWeight.ValChanged = True
'      ThisComp.MolecularWeight.UserInput = False
'
'      XXX = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "HenrysConstant"))
'      ThisComp.HenrysConstant.Value = XXX.Val
'      ThisComp.HenrysConstant.ValChanged = True
'      ThisComp.HenrysConstant.UserInput = False
'
'      XXX = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "NormalBoilingPoint"))
'      ThisComp.NormalBoilingPoint.Value = (XXX.Val) + 273.15
'      ThisComp.NormalBoilingPoint.ValChanged = True
'      ThisComp.NormalBoilingPoint.UserInput = False
'
'      XXX = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "MolarVolumeAtNBP"))
'      ThisComp.MolarVolume.Value = XXX.Val
'      ThisComp.MolarVolume.ValChanged = True
'      ThisComp.MolarVolume.UserInput = False
'
'      XXX = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "LiquidDiffusivity"))
'      ThisComp.LiquidDiffusivity.Value = XXX.Val
'      ThisComp.LiquidDiffusivity.ValChanged = True
'      ThisComp.LiquidDiffusivity.UserInput = False
'      'thiscomp.Refractive_Index = xxx.val
'
'      XXX = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "GasDiffusivity"))
'      ThisComp.GasDiffusivity.Value = XXX.Val
'      ThisComp.GasDiffusivity.ValChanged = True
'      ThisComp.GasDiffusivity.UserInput = False
'
'      'Place imported component into memory
'      Data_frmContaminantPropertyEdit.NewNumCompo = Data_frmContaminantPropertyEdit.NewNumCompo + 1
'      Data_frmContaminantPropertyEdit.Contaminants(Data_frmContaminantPropertyEdit.NewNumCompo) = ThisComp
'    Next i
'
'    '-- Display standard "Import Succeeded" dialog box
'
'    StEPPLink_DontForget = "Remember to set the correct values of influent and treatment objective concentrations for these components."
'    Call StEPPLink_DisplayImportSucceeded
'
'    Unload Me
'
'ChDrive App.Path
'ChDir App.Path
'
'Exit Sub
'
'exit_ImportError:
'  Exit Sub
'
'ImportError:
'  ChDrive App.Path
'  ChDir App.Path
'  If Err = 32755 Then   'Cancel selected by user
'    Resume exit_ImportError
'  End If
'  MsgBox "Error importing file!", 48, "ASAP StEPP Import"
'  Resume exit_ImportError

End Sub

Private Sub cmdImportClipboard_Click()
Dim num_lines As Integer
Dim cliptext As String
Dim line_in As String
Dim r As Integer
Dim link_pressure As Double
Dim link_temperature As Double
Dim link_ChemCount As Integer
Const CHEMPROP_MIN = 0
Const CHEMPROP_MAX = 12
ReDim link_ChemProp(CHEMPROP_MIN To CHEMPROP_MAX, 1 To 1) As Double
ReDim link_ChemName(1 To 1) As String
ReDim link_ChemCAS(1 To 1) As String
ReDim link_ChemPropAvailable(CHEMPROP_MIN To CHEMPROP_MAX, 1 To 1) As Integer
ReDim link_IsImportable(1 To 1) As Integer
Dim i As Integer
Dim j As Integer
Const PROP_VAPORPRESSURE = 0
Const PROP_ACTIVITYCOEFFICIENT = 1
Const PROP_HENRYSCONSTANT = 2
Const PROP_MOLECULARWEIGHT = 3
Const PROP_NORMALBOILINGPOINT = 4
Const PROP_LIQUIDDENSITY = 5
Const PROP_MOLARVOLUMEATOPT = 6
Const PROP_MOLARVOLUMEATNBP = 7
Const PROP_REFRACTIVEINDEX = 8
Const PROP_AQUEOUSSOLUBILITY = 9
Const PROP_LOGKOW = 10
Const PROP_LIQUIDDIFFUSIVITY = 11
Const PROP_GASDIFFUSIVITY = 12
Dim num_imported As Integer
'Dim thiscomp As ComponentPropertyType
Dim thiscomp As ContaminantPropertyType
Dim msg As String
Dim vb3CrLf As String
Dim num_failed As Integer

  On Error GoTo err_cmdImportClipboard_Click
  cliptext = Clipboard.GetText()
  cliptext = Parser_RemoveCharacters(Chr$(10), cliptext)
  num_lines = Parser_GetNumArgs(Chr$(13), cliptext)
  r = 1
  Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
  If (Trim$(UCase$(line_in)) <> Trim$(UCase$("1234567890:START_OF_STEPP_CLIPBOARD_EXPORT"))) Then
    GoTo err_nonfatal_cmdImportClipboard_Click
  End If
  r = r + 2
  Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
  link_pressure = CDbl(val(line_in))
  If (link_pressure <= 0#) Then GoTo err_nonfatal_cmdImportClipboard_Click
  r = r + 2
  Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
  link_temperature = CDbl(val(line_in))
  If (link_temperature <= 0#) Then GoTo err_nonfatal_cmdImportClipboard_Click
  r = r + 2
  Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
  link_ChemCount = CInt(val(line_in))
  If (link_ChemCount <= 0) Then GoTo err_nonfatal_cmdImportClipboard_Click
  ReDim link_ChemProp(CHEMPROP_MIN To CHEMPROP_MAX, 1 To link_ChemCount)
  ReDim link_ChemName(1 To link_ChemCount)
  ReDim link_ChemCAS(1 To link_ChemCount)
  ReDim link_ChemPropAvailable(CHEMPROP_MIN To CHEMPROP_MAX, 1 To link_ChemCount)
  ReDim link_IsImportable(1 To link_ChemCount)
  For i = 1 To link_ChemCount
    For j = CHEMPROP_MIN To CHEMPROP_MAX
      link_ChemPropAvailable(j, i) = True
    Next j
    r = r + 2
    Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
    link_ChemName(i) = Trim$(UCase$(line_in))
    If (link_ChemName(i) = "") Then GoTo err_nonfatal_cmdImportClipboard_Click
    r = r + 2
    Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
    link_ChemCAS(i) = Trim$(UCase$(line_in))
    'If (link_ChemCAS(i) = "") Then GoTo err_nonfatal_cmdImportClipboard_Click
    For j = CHEMPROP_MIN To CHEMPROP_MAX
      r = r + 2
      Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
      line_in = Trim$(UCase$(line_in))
      If (Trim$(UCase$("UNAVAILABLE")) = line_in) Then
        link_ChemPropAvailable(j, i) = False
      Else
        link_ChemProp(j, i) = CDbl(val(line_in))
      End If
    Next j
  Next i
  r = r + 1
  Call Parser_GetArg(Chr$(13), cliptext, r, line_in)
  If (Trim$(UCase$(line_in)) <> Trim$(UCase$("1234567890:END_OF_STEPP_CLIPBOARD_EXPORT"))) Then
    GoTo err_nonfatal_cmdImportClipboard_Click
  End If
  
  'ARE THERE ENOUGH EMPTY COMPONENT SLOTS REMAINING?
  If (frmBubble.Visible) Then
    If (bub.NumChemical + 1 > MAXCHEMICAL) Then GoTo err_TooManyChemicals
  End If
  If (frmSurface.Visible) Then
    If (sur.NumChemical + 1 > MAXCHEMICAL) Then GoTo err_TooManyChemicals
  End If
  If (frmPTADScreen1.Visible) Then
    If (scr1.NumChemical + 1 > MAXCHEMICAL) Then GoTo err_TooManyChemicals
  End If
  If (frmPTADScreen2.Visible) Then
    If (Scr2.NumChemical + 1 > MAXCHEMICAL) Then GoTo err_TooManyChemicals
  End If
  GoTo Bypass_err_TooManyChemicals

err_TooManyChemicals:
  MsgBox "Unable to import all of chemicals in file because the maximum number of chemicals has been reached.", 48, Application_Name
  Unload Me
  Exit Sub
Bypass_err_TooManyChemicals:

  'DOES THE USER REALLY WANT TO IMPORT AT THIS TEMPERATURE AND PRESSURE?
      '---- I'VE DECIDED TO SKIP THIS STEP.  THE USER BEWARE.
  
  'DETERMINE WHICH COMPONENTS ARE IMPORTABLE.
  For i = 1 To link_ChemCount
    link_IsImportable(i) = True
    If (Not link_ChemPropAvailable(PROP_HENRYSCONSTANT, i)) Then link_IsImportable(i) = False
    If (Not link_ChemPropAvailable(PROP_MOLECULARWEIGHT, i)) Then link_IsImportable(i) = False
    If (Not link_ChemPropAvailable(PROP_NORMALBOILINGPOINT, i)) Then link_IsImportable(i) = False
    If (Not link_ChemPropAvailable(PROP_MOLARVOLUMEATNBP, i)) Then link_IsImportable(i) = False
    If (Not link_ChemPropAvailable(PROP_LIQUIDDIFFUSIVITY, i)) Then link_IsImportable(i) = False
    If (Not link_ChemPropAvailable(PROP_GASDIFFUSIVITY, i)) Then link_IsImportable(i) = False
  Next i

  'IMPORT ALL IMPORTABLE COMPONENTS.
  num_imported = 0
  For i = 1 To link_ChemCount
    If (link_IsImportable(i)) Then
      num_imported = num_imported + 1
      
      'Call SetComponentDefaults(thiscomp, -1)
      'thiscomp.name = link_ChemName(i)
      'thiscomp.Cas = CLng(Val(link_ChemCAS(i)))
      'thiscomp.Vapor_Pressure = link_ChemProp(PROP_VAPORPRESSURE, i)
      'thiscomp.MW = link_ChemProp(PROP_MOLECULARWEIGHT, i)
      'thiscomp.BP = link_ChemProp(PROP_NORMALBOILINGPOINT, i)
      'thiscomp.Liquid_Density = link_ChemProp(PROP_LIQUIDDENSITY, i) / 1000#
      'thiscomp.MolarVolume = link_ChemProp(PROP_MOLARVOLUMEATNBP, i) * 1000#
      'thiscomp.Refractive_Index = link_ChemProp(PROP_REFRACTIVEINDEX, i)
      'thiscomp.Aqueous_Solubility = link_ChemProp(PROP_AQUEOUSSOLUBILITY, i)
      'Number_Component = Number_Component + 1
      'Component(Number_Component) = thiscomp

      'Set all property defaults
      thiscomp.Name = link_ChemName(i)
      thiscomp.Influent.Value = 10#
      thiscomp.TreatmentObjective.Value = 2#

      'IMPORT EACH PROPERTY.
      thiscomp.MolecularWeight.Value = link_ChemProp(PROP_MOLECULARWEIGHT, i)
      thiscomp.MolecularWeight.ValChanged = True
      thiscomp.MolecularWeight.UserInput = False

      thiscomp.HenrysConstant.Value = link_ChemProp(PROP_HENRYSCONSTANT, i)
      thiscomp.HenrysConstant.ValChanged = True
      thiscomp.HenrysConstant.UserInput = False

      thiscomp.NormalBoilingPoint.Value = link_ChemProp(PROP_NORMALBOILINGPOINT, i) + 273.15
      thiscomp.NormalBoilingPoint.ValChanged = True
      thiscomp.NormalBoilingPoint.UserInput = False

      thiscomp.MolarVolume.Value = link_ChemProp(PROP_MOLARVOLUMEATNBP, i)
      thiscomp.MolarVolume.ValChanged = True
      thiscomp.MolarVolume.UserInput = False

      thiscomp.LiquidDiffusivity.Value = link_ChemProp(PROP_LIQUIDDIFFUSIVITY, i)
      thiscomp.LiquidDiffusivity.ValChanged = True
      thiscomp.LiquidDiffusivity.UserInput = False

      thiscomp.GasDiffusivity.Value = link_ChemProp(PROP_GASDIFFUSIVITY, i)
      thiscomp.GasDiffusivity.ValChanged = True
      thiscomp.GasDiffusivity.UserInput = False
      
      'STORE COMPONENT INTO MEMORY.
      Data_frmContaminantPropertyEdit.NewNumCompo = Data_frmContaminantPropertyEdit.NewNumCompo + 1
      Data_frmContaminantPropertyEdit.Contaminants(Data_frmContaminantPropertyEdit.NewNumCompo) = thiscomp
    End If
  Next i

  'DISPLAY WARNING/SUCCESS MESSAGE.
  vb3CrLf = Chr$(13) & Chr$(10)
  If (num_imported <> 0) Then
    msg = "Successfully imported " & Trim$(Str$(num_imported)) & " component"
    If (num_imported <> 1) Then msg = msg & "s"
    msg = msg & " from StEPP:" & vb3CrLf
    For i = 1 To link_ChemCount
      If (link_IsImportable(i)) Then
        msg = msg & "    " & Trim$(link_ChemName(i)) & vb3CrLf
      End If
    Next i
    msg = msg & "The properties are for a "
    msg = msg & "pressure of " & Trim$(Str$(link_pressure)) & " Pa "
    msg = msg & "and a "
    msg = msg & "temperature of " & Trim$(Str$(link_temperature)) & " degrees Celcius." & vb3CrLf
    msg = msg & vb3CrLf
    msg = msg & "Don't forget to set the correct values of influent concentration "
    msg = msg & "and treatment objective concentration for each "
    msg = msg & "of these components." & vb3CrLf
  Else
    msg = "Unable to import any components from StEPP." & vb3CrLf
  End If
  num_failed = link_ChemCount - num_imported
  If (num_failed <> 0) Then
    msg = msg & vb3CrLf
    msg = msg & "Failed to import the following component"
    If (num_failed <> 1) Then msg = msg & "s"
    msg = msg & ":" & vb3CrLf
    For i = 1 To link_ChemCount
      If (Not link_IsImportable(i)) Then
        msg = msg & "    " & Trim$(link_ChemName(i)) & vb3CrLf
      End If
    Next i
    msg = msg & vb3CrLf
    msg = msg & "Important note: In order to successfully import a component "
    msg = msg & "from StEPP, the following properties must be available: "
    msg = msg & "Henry's constant, "
    msg = msg & "molecular weight, "
    msg = msg & "normal boiling point, "
    msg = msg & "molar volume at the normal boiling point, "
    msg = msg & "liquid diffusivity, "
    msg = msg & "and gas diffusivity.  "
    msg = msg & "To force an import to occur, you may modify the user input "
    msg = msg & "value of the unavailable properties from within StEPP."
    msg = msg & vb3CrLf
  End If
  MsgBox msg, MB_ICONINFORMATION, Application_Name
  Unload Me

exit_err_cmdImportClipboard_Click:
  Exit Sub
err_nonfatal_cmdImportClipboard_Click:
  MsgBox "An error occurred during the import process.", 48, Application_Name
  GoTo exit_err_cmdImportClipboard_Click
err_cmdImportClipboard_Click:
  MsgBox "An error occurred during the import process.", 48, Application_Name
  Resume exit_err_cmdImportClipboard_Click
End Sub

Private Sub cmdOK_Click()
Dim i As Integer, response As Integer, msg As String
Dim NumPrevious As Integer 'Location of the previous occurrence of the current chemical (if any)
Dim x As rec_frmContaminantPropertyEdit
Dim xu As rec_Units_frmContaminantPropertyEdit

  x = Data_frmContaminantPropertyEdit
  x.CancelledEdit = False
  x.CancelledAdd = False
  
  If (x.DoAdd) Then
    x.NewNumCompo = x.OldNumCompo + 1
    NumPrevious = 0
    For i = 1 To scr1.Chemical - 1
      If scr1.Contaminant(i).Name = txtContaminantName.Text Then
        msg = txtContaminantName.Text & " already appears in your list" & Chr$(13)
        msg = msg + "of contaminants." & Chr$(13) & Chr$(13)
        msg = msg + "Do you wish to replace the previous property values?" & Chr$(13) & Chr$(13)
        response = MsgBox(msg, 36, "Warning")
        NumPrevious = i
        Exit For
      End If
    Next i
    If (NumPrevious = 0) Then
      'Do nothing--calling subroutine will update its contaminant list.
    ElseIf (response = IDYES) Then
      'Do nothing--calling subroutine will update its contaminant list.
    Else
      'Cancel the addition of this contaminant.
      x.CancelledEdit = False
      x.CancelledAdd = True
      x.NewNumCompo = x.OldNumCompo
    End If
  Else
    'Do nothing--calling subroutine will update its contaminant list.
    x.NewNumCompo = x.OldNumCompo
  End If
  x.Contaminants(x.DoEditNumber) = ThisContaminant
  Data_frmContaminantPropertyEdit = x

  'Save units from this screen.
  xu = Units_frmContaminantPropertyEdit
  For i = 0 To 5
    If (i <> 1) Then xu.UnitsProp(i) = GetUnits(UnitsProp(i))
  Next i
  For i = 0 To 1
    xu.UnitsConc(i) = GetUnits(UnitsConc(i))
  Next i
  Units_frmContaminantPropertyEdit = xu
    
  Select Case x.ModelType
    Case MODELTYPE_PACKEDTOWER
      If (frmPTADScreen1.Visible) Then
        frmPTADScreen1.cboSelectCompo.ListIndex = cbochemname.ListIndex
      ElseIf (frmPTADScreen2.Visible) Then
        frmPTADScreen2.cboSelectCompo.ListIndex = cbochemname.ListIndex
      End If
    Case MODELTYPE_SURFACE
      frmSurface.cboDesignContaminant.ListIndex = cbochemname.ListIndex
    Case MODELTYPE_BUBBLE
      frmBubble.cboDesignContaminant.ListIndex = cbochemname.ListIndex
  End Select


'    If (AddFlag) Then
'          NumPrevious = 0
'          For i = 1 To Scr1.Chemical - 1
'              If Scr1.Contaminant(i).Name = txtContaminantName.Text Then
'                 Msg = txtContaminantName.Text & " already appears in your list" & Chr$(13)
'                 Msg = Msg + "of contaminants." & Chr$(13) & Chr$(13)
'                 Msg = Msg + "Do you wish to replace the previous property values?" & Chr$(13) & Chr$(13)
'                 Response = MsgBox(Msg, 36, "Warning")
'                 NumPrevious = i
'                 Exit For
'              End If
'          Next i
'
'          If NumPrevious = 0 Then
'             Scr1.NumChemical = Scr1.NumChemical + 1
'             Scr1.Contaminant(Scr1.NumChemical) = Scr1.Contaminant(0)
'
'             frmListContaminant.ListContaminants.AddItem txtContaminantName.Text
'             frmPTADScreen1.cboDesignContaminant.AddItem txtContaminantName.Text
'             frmPTADScreen1.cboSelectCompo.AddItem txtContaminantName.Text
'
'
'             If Not frmListContaminant.ListContaminants.Visible Then frmListContaminant.ListContaminants.Visible = True
'             'frmListContaminant.ListContaminants.Selected(Scr1.Chemical - 1) = True
'          ElseIf Response = IDYES Then  'Replace previous values of properties for the duplicate chemical with the new values.  Do not move the chemical from its current location in the list.
'             Scr1.Contaminant(NumPrevious).Pressure = Scr1.Contaminant(Scr1.Chemical).Pressure
'             Scr1.Contaminant(NumPrevious).Temperature = Scr1.Contaminant(Scr1.Chemical).Temperature
'
'             Scr1.Contaminant(NumPrevious).MolecularWeight.Value = Scr1.Contaminant(Scr1.Chemical).MolecularWeight.Value
'             Scr1.Contaminant(NumPrevious).MolecularWeight.ValChanged = Scr1.Contaminant(Scr1.Chemical).MolecularWeight.ValChanged
'             Scr1.Contaminant(NumPrevious).MolecularWeight.UserInput = Scr1.Contaminant(Scr1.Chemical).MolecularWeight.UserInput
'
'             Scr1.Contaminant(NumPrevious).HenrysConstant.Value = Scr1.Contaminant(Scr1.Chemical).HenrysConstant.Value
'             Scr1.Contaminant(NumPrevious).HenrysConstant.ValChanged = Scr1.Contaminant(Scr1.Chemical).HenrysConstant.ValChanged
'             Scr1.Contaminant(NumPrevious).HenrysConstant.UserInput = Scr1.Contaminant(Scr1.Chemical).HenrysConstant.UserInput
'
'             Scr1.Contaminant(NumPrevious).MolarVolume.Value = Scr1.Contaminant(Scr1.Chemical).MolarVolume.Value
'             Scr1.Contaminant(NumPrevious).MolarVolume.ValChanged = Scr1.Contaminant(Scr1.Chemical).MolarVolume.ValChanged
'             Scr1.Contaminant(NumPrevious).MolarVolume.UserInput = Scr1.Contaminant(Scr1.Chemical).MolarVolume.UserInput
'
'             Scr1.Contaminant(NumPrevious).NormalBoilingPoint.Value = Scr1.Contaminant(Scr1.Chemical).NormalBoilingPoint.Value
'             Scr1.Contaminant(NumPrevious).NormalBoilingPoint.ValChanged = Scr1.Contaminant(Scr1.Chemical).NormalBoilingPoint.ValChanged
'             Scr1.Contaminant(NumPrevious).NormalBoilingPoint.UserInput = Scr1.Contaminant(Scr1.Chemical).NormalBoilingPoint.UserInput
'
'             Scr1.Contaminant(NumPrevious).LiquidDiffusivity.Value = Scr1.Contaminant(Scr1.Chemical).LiquidDiffusivity.Value
'             Scr1.Contaminant(NumPrevious).LiquidDiffusivity.ValChanged = Scr1.Contaminant(Scr1.Chemical).LiquidDiffusivity.ValChanged
'             Scr1.Contaminant(NumPrevious).LiquidDiffusivity.UserInput = Scr1.Contaminant(Scr1.Chemical).LiquidDiffusivity.UserInput
'
'             Scr1.Contaminant(NumPrevious).GasDiffusivity.Value = Scr1.Contaminant(Scr1.Chemical).GasDiffusivity.Value
'             Scr1.Contaminant(NumPrevious).GasDiffusivity.ValChanged = Scr1.Contaminant(Scr1.Chemical).GasDiffusivity.ValChanged
'             Scr1.Contaminant(NumPrevious).GasDiffusivity.UserInput = Scr1.Contaminant(Scr1.Chemical).GasDiffusivity.UserInput
'
'             Scr1.NumChemical = Scr1.NumChemical - 1
'             Scr1.Chemical = NumPrevious
'             frmListContaminant.ListContaminants.Selected(Scr1.Chemical - 1) = True
'          Else
'             Scr1.NumChemical = Scr1.NumChemical - 1
'             Scr1.Chemical = NumPrevious
'             frmListContaminant.ListContaminants.Selected(Scr1.Chemical - 1) = True
'          End If
'
'    End If

    'If frmListContaminant.mnuOptionsManipulateContaminant(1).Enabled = False Then
    '   frmListContaminant.mnuOptionsManipulateContaminant(1).Enabled = True
    '   frmListContaminant.mnuOptionsManipulateContaminant(3).Enabled = True
    '   frmListContaminant.mnuOptionsManipulateContaminant(4).Enabled = True
    '   frmListContaminant.mnuOptionsSave.Enabled = True
    '   frmListContaminant.mnuOptionsView.Enabled = True
    'End If

  Unload Me
    
End Sub

Private Sub cmdStEPP_Click_OLD()
'
'  'StEPPImportSuccess = False
'  'frmSteppLink.Show 1
'  'If (StEPPImportSuccess) Then
'  '  Unload Me
'  'End If
'
'Dim i As Integer
'Dim j As Integer
'Dim this_chemical As String
'Dim xxx As StEPPLink_Property
'Dim thiscomp As ContaminantPropertyType
'
'  '---- CLIENT-SPECIFIC: Minimize all forms but StEPP Link ...
'  frmContaminantPropertyEdit.Hide
'  If (frmPTADScreen1.Visible) Then
'    frmPTADScreen1.Hide
'    designtype = 1
'  End If
'  If (frmPTADScreen2.Visible) Then
'    frmPTADScreen2.Hide
'    designtype = 2
'  End If
'  If (frmBubble.Visible) Then frmBubble.Hide
'  If (frmSurface.Visible) Then frmSurface.Hide
'
'  '---- CLIENT-SPECIFIC: Miscellaneous variables
'  Select Case Data_frmContaminantPropertyEdit.ModelType
'    Case MODELTYPE_BUBBLE:
'      frmStEPPLink_Pressure = CDbl(bub.OperatingPressure.Value) * 101325#
'      frmStEPPLink_Temperature = CDbl(bub.operatingtemperature.Value) - 273.15
'    Case MODELTYPE_SURFACE:
'      frmStEPPLink_Pressure = CDbl(sur.OperatingPressure.Value) * 101325#
'      frmStEPPLink_Temperature = CDbl(sur.operatingtemperature.Value) - 273.15
'    Case MODELTYPE_PACKEDTOWER:
'      Select Case designtype
'        Case 1:
'          frmStEPPLink_Pressure = CDbl(scr1.OperatingPressure.Value) * 101325#
'          frmStEPPLink_Temperature = CDbl(scr1.operatingtemperature.Value) - 273.15
'        Case 2:
'          frmStEPPLink_Pressure = CDbl(Scr2.OperatingPressure.Value) * 101325#
'          frmStEPPLink_Temperature = CDbl(Scr2.operatingtemperature.Value) - 273.15
'      End Select
'  End Select
'  frmStEPPLink_ClientName = "ASAP"
'  ReDim StEPPLink_CurrentChemicalNames(0 To 0)
'  If (Data_frmContaminantPropertyEdit.OldNumCompo <> 0) Then
'    ReDim StEPPLink_CurrentChemicalNames(1 To Data_frmContaminantPropertyEdit.OldNumCompo)
'    For i = 1 To Data_frmContaminantPropertyEdit.OldNumCompo
'      StEPPLink_CurrentChemicalNames(i) = Trim$(UCase$(Data_frmContaminantPropertyEdit.Contaminants(i).Name))
'    Next i
'  End If
'
'  '---- Call StEPP Link into existence
'  frmSteppLink.Show 1
'
'  '---- Process imported properties
'  If (frmStEPPLink_Success) Then
'    '-- CLIENT-SPECIFIC: Store names of strictly required properties
'    ReDim StEPPLink_RequiredProps(1 To 6)
'    StEPPLink_RequiredProps(1) = "HenrysConstant"
'    StEPPLink_RequiredProps(2) = "MolecularWeight"
'    StEPPLink_RequiredProps(3) = "NormalBoilingPoint"
'    StEPPLink_RequiredProps(4) = "MolarVolumeAtNBP"
'    StEPPLink_RequiredProps(5) = "LiquidDiffusivity"
'    StEPPLink_RequiredProps(6) = "GasDiffusivity"
'
'    '-- Call routine to filter out components that lack any of
'    '.. the properties listed above
'    Call StEPPLink_FilterUnimportable
'
'    '-- CLIENT-SPECIFIC: Import the acceptable components to memory structures
'    For i = 1 To UBound(StEPPLink_ImportSucceeded_Name)
'      this_chemical = StEPPLink_ImportSucceeded_Name(i)
'
'      'Set all property defaults
'      'Call SetComponentDefaults(thiscomp, -1)
'      thiscomp.Influent.Value = 10#
'      thiscomp.TreatmentObjective.Value = 2#
'      xxx = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "MolecularWeight"))
'      thiscomp.Name = xxx.Chemical
'      'thiscomp.Cas = CLng(xxx.Cas)
'
'      'Import each property
'      xxx = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "MolecularWeight"))
'      thiscomp.MolecularWeight.Value = xxx.val
'      thiscomp.MolecularWeight.ValChanged = True
'      thiscomp.MolecularWeight.UserInput = False
'
'      xxx = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "HenrysConstant"))
'      thiscomp.HenrysConstant.Value = xxx.val
'      thiscomp.HenrysConstant.ValChanged = True
'      thiscomp.HenrysConstant.UserInput = False
'
'      xxx = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "NormalBoilingPoint"))
'      thiscomp.NormalBoilingPoint.Value = (xxx.val) + 273.15
'      thiscomp.NormalBoilingPoint.ValChanged = True
'      thiscomp.NormalBoilingPoint.UserInput = False
'
'      xxx = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "MolarVolumeAtNBP"))
'      thiscomp.MolarVolume.Value = xxx.val
'      thiscomp.MolarVolume.ValChanged = True
'      thiscomp.MolarVolume.UserInput = False
'
'      xxx = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "LiquidDiffusivity"))
'      thiscomp.LiquidDiffusivity.Value = xxx.val
'      thiscomp.LiquidDiffusivity.ValChanged = True
'      thiscomp.LiquidDiffusivity.UserInput = False
'      'thiscomp.Refractive_Index = xxx.val
'
'      xxx = StEPPLink_FilteredProps(StEPPLink_FindProp(this_chemical, "GasDiffusivity"))
'      thiscomp.GasDiffusivity.Value = xxx.val
'      thiscomp.GasDiffusivity.ValChanged = True
'      thiscomp.GasDiffusivity.UserInput = False
'
'      'Place imported component into memory
'      Data_frmContaminantPropertyEdit.NewNumCompo = Data_frmContaminantPropertyEdit.NewNumCompo + 1
'      Data_frmContaminantPropertyEdit.Contaminants(Data_frmContaminantPropertyEdit.NewNumCompo) = thiscomp
'    Next i
'
'    '-- Display standard "Import Succeeded" dialog box
'
'    StEPPLink_DontForget = "Remember to set the correct values of influent and treatment objective concentrations for these components."
'    Call StEPPLink_DisplayImportSucceeded
'
'    Unload Me
'  End If
'
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()
Dim i As Integer
Dim PositionLeft As Integer
Dim x As rec_frmContaminantPropertyEdit
Dim xu As rec_Units_frmContaminantPropertyEdit

  Call CenterThisForm(Me)

'tells it to skip certain change events
loading = 0

' DEMO MODE STOP USER FROM ADDING CONTAMINANTS :: TACK
If DemoMode% Then
    txtContaminantName.Enabled = False
    For i% = 0 To 5
        txtContaminantProperties(i%).Enabled = False
    Next i%
'    txtconcentration(0).Enabled = False
'    txtconcentration(1).Enabled = False
    '''lblpropoperatingconditions(0).Enabled = False
    '''lblpropoperatingconditions(1).Enabled = False
End If
' END DEMO STUFF

    'frmPropContaminant.WindowState = 0
    'frmPropContaminant.Height = 7140
    ''Position the form on the screen (Centered in Right Half of It)
    'If WindowState = 0 Then
    '   'don't attempt if screen Minimized or Maximized
    '   PositionLeft = frmPTADScreen1.Left + frmPTADScreen1.Width - Screen.Width / 2
    '   PositionLeft = (PositionLeft / 2 - frmPropContaminant.Width / 2)
    '   Move (Screen.Width / 2 + PositionLeft), (Screen.Height - frmPropContaminant.Height) / 2
    'End If
   ' Call CenterForm(Me)
    cmdOK.Enabled = False
    
    x = Data_frmContaminantPropertyEdit
    Caption = "Contaminant Properties - " & x.ModelName
    x.NewNumCompo = x.OldNumCompo
    If (x.DoAdd) Then

      'New contaminant properties:
      cbochemname.Visible = False

      For i = 0 To 1
        txtConcentration(i).Text = "0.0"
      Next i
      For i = 0 To 5
        txtContaminantProperties(i).Text = "0.0"
      Next i
      txtContaminantName.Enabled = True
      x.DoEditNumber = x.OldNumCompo + 1
      'cmdStEPP.Enabled = True
      'cmdStEPP.Visible = True
      cmdImportClipboard.Enabled = True
      cmdImportClipboard.Visible = True
      cmdImport.Enabled = True
      cmdImport.Visible = True
      Frame1.Visible = True

      'Set default values for ThisContaminant.
      ThisContaminant.Name = ""
      ThisContaminant.Pressure = 0#
      ThisContaminant.Temperature = 0#
      ThisContaminant.AirWaterInterfaceConcentration = 0#
      ThisContaminant.MolecularWeight.Value = 131.4
      ThisContaminant.HenrysConstant.Value = 0.231
      ThisContaminant.MolarVolume.Value = 0.0981
      ThisContaminant.NormalBoilingPoint.Value = 360#
      ThisContaminant.LiquidDiffusivity.Value = 0.000000000656956
      ThisContaminant.GasDiffusivity.Value = 0.00000799877
      ThisContaminant.Influent.Value = 200#
      ThisContaminant.TreatmentObjective.Value = 5#
      ThisContaminant.Effluent.Value = 0#
    Else
        'cmdStEPP.Visible = False
        cmdImportClipboard.Visible = False
        cmdImport.Visible = False
        Frame1.Visible = False

        For i = 1 To x.NewNumCompo
            cbochemname.AddItem x.Contaminants(i).Name
        Next
        cbochemname.ListIndex = x.DoEditNumber - 1
      
      'Display the current contaminant being edited:
      ThisContaminant = x.Contaminants(x.DoEditNumber)
    End If
    txtContaminantName.Text = ThisContaminant.Name
    txtContaminantName.Enabled = True
    txtContaminantProperties(0).Text = Format$(ThisContaminant.MolecularWeight.Value, "0.00")
    txtContaminantProperties(1).Text = Format$(ThisContaminant.HenrysConstant.Value, GetTheFormat(ThisContaminant.HenrysConstant.Value))
    txtContaminantProperties(2).Text = Format$(ThisContaminant.MolarVolume.Value, GetTheFormat(ThisContaminant.MolarVolume.Value))
    txtContaminantProperties(3).Text = Format$(ThisContaminant.NormalBoilingPoint.Value - 273.15, "0.0")
    txtContaminantProperties(4).Text = Format$(ThisContaminant.LiquidDiffusivity.Value, GetTheFormat(ThisContaminant.LiquidDiffusivity.Value))
    txtContaminantProperties(5).Text = Format$(ThisContaminant.GasDiffusivity.Value, GetTheFormat(ThisContaminant.GasDiffusivity.Value))
    txtConcentration(0).Text = Format$(ThisContaminant.Influent.Value, GetTheFormat(ThisContaminant.Influent.Value))
    txtConcentration(1).Text = Format$(ThisContaminant.TreatmentObjective.Value, GetTheFormat(ThisContaminant.TreatmentObjective.Value))
    
    xu = Units_frmContaminantPropertyEdit
    Call LabelsPropContaminant(UNITSTYPE_SI)
    For i = 0 To 5
      If (i <> 1) Then Call SetUnits(UnitsProp(i), xu.UnitsProp(i))
    Next i
    For i = 0 To 1
      Call SetUnits(UnitsConc(i), xu.UnitsConc(i))
    Next i

    Select Case x.ModelType
      Case MODELTYPE_PACKEDTOWER
        'Do nothing.

      Case MODELTYPE_BUBBLE
        'Hide Normal Boiling Point property.
        txtContaminantProperties(3).Visible = False
        lblContaminantProperties(4).Visible = False
        UnitsProp(3).Visible = False
        
        'Hide Gas Diffusivity property.
        txtContaminantProperties(5).Visible = False
        lblContaminantProperties(6).Visible = False
        UnitsProp(5).Visible = False
      
      Case MODELTYPE_SURFACE
        'Hide Normal Boiling Point property.
        txtContaminantProperties(3).Visible = False
        lblContaminantProperties(4).Visible = False
        UnitsProp(3).Visible = False

        'Hide Gas Diffusivity property.
        txtContaminantProperties(5).Visible = False
        lblContaminantProperties(6).Visible = False
        UnitsProp(5).Visible = False

    End Select

    Data_frmContaminantPropertyEdit = x
    loading = 1
End Sub

Private Sub Old_StEPP_Link()
'
'    Dim response As Integer
'
'    On Error GoTo Error_DDE
'       txttestdde(0).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txttestdde(0).LinkTopic = "DStEPP|MainForm"
'       txttestdde(0).LinkItem = "lblSelectedContaminant"
'       txttestdde(0).LinkMode = 3
'       txttestdde(0).LinkRequest
'       txttestdde(0).LinkMode = 0
'       txttestdde(1).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txttestdde(1).LinkTopic = "DStEPP|MainForm"
'       txttestdde(1).LinkItem = "txtOperatingPressure"
'       txttestdde(1).LinkMode = 3
'       txttestdde(1).LinkRequest
'       txttestdde(1).LinkMode = 0
'       txttestdde(2).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txttestdde(2).LinkTopic = "DStEPP|MainForm"
'       txttestdde(2).LinkItem = "txtOperatingTemperature"
'       txttestdde(2).LinkMode = 3
'       txttestdde(2).LinkRequest
'       txttestdde(2).LinkMode = 0
'
'       'Check if contaminant name, operating pressure, operating temperature in StEPP and ASAP agree.  If they don't, print appropriate warning.
'       If txtcontaminantname.Text <> "" Then
'          If UCase$(Trim$(txtcontaminantname.Text)) <> UCase$(Trim$(txttestdde(0).Text)) Then
'             response = MsgBox("Contaminant Name in StEPP = " & Trim$(txttestdde(0).Text) & ".  Contaminant Name in ASAP = " & Trim$(txtcontaminantname.Text) & "." & Chr$(13) & Chr$(13) & "Proceed with DDE Link?", MB_ICONQUESTION + MB_YESNO, "Warning")
'             If response = IDNO Then Exit Sub
'          End If
'       End If
'
'       If Abs((CDbl(frmPTADScreen1!txtOperatingPressure.Text) - CDbl(txttestdde(1).Text))) > TOLERANCE Then
'          response = MsgBox("Operating Pressure in StEPP = " & Trim$(txttestdde(1).Text) & ".  Operating Pressure in ASAP = " & Trim$(frmPTADScreen1!txtOperatingPressure.Text) & "." & Chr$(13) & Chr$(13) & "Proceed with DDE link?", MB_ICONQUESTION + MB_YESNO, "Warning")
'          If response = IDNO Then Exit Sub
'       End If
'
'       If Abs((CDbl(frmPTADScreen1!txtOperatingTemperature.Text) - CDbl(txttestdde(2).Text))) > TOLERANCE Then
'          response = MsgBox("Operating Temperature in StEPP = " & Trim$(txttestdde(2).Text) & ".  Operating Temperature in ASAP = " & Trim$(frmPTADScreen1!txtOperatingTemperature.Text) & "." & Chr$(13) & Chr$(13) & "Proceed with DDE link?", MB_ICONQUESTION + MB_YESNO, "Warning")
'          If response = IDNO Then Exit Sub
'       End If
'
'       If ListContaminantMenuOptionsIndex = 2 Then  '2 --> Add Contaminant
'          Call txtContaminantName_GotFocus
'          txtcontaminantname = Trim$(LCase$(txttestdde(0).Text))
'          Call txtContaminantName_LostFocus
'       End If
'
'       txtcontaminantproperties(0).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txtcontaminantproperties(0).LinkTopic = "DStEPP|MainForm"
'       txtcontaminantproperties(0).LinkItem = "lblContaminantProperties(3)"
'       txtcontaminantproperties(0).LinkMode = 3
'       Call txtContaminantProperties_GotFocus(0)
'       txtcontaminantproperties(0).LinkRequest
'       txtcontaminantproperties(0).LinkMode = 0
'       Call txtContaminantProperties_LostFocus(0)
'
'       txtcontaminantproperties(1).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txtcontaminantproperties(1).LinkTopic = "DStEPP|MainForm"
'       txtcontaminantproperties(1).LinkItem = "lblContaminantProperties(2)"
'       txtcontaminantproperties(1).LinkMode = 3
'       Call txtContaminantProperties_GotFocus(1)
'       txtcontaminantproperties(1).LinkRequest
'       txtcontaminantproperties(1).LinkMode = 0
'       Call txtContaminantProperties_LostFocus(1)
''
'       txtcontaminantproperties(2).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txtcontaminantproperties(2).LinkTopic = "DStEPP|MainForm"
'       txtcontaminantproperties(2).LinkItem = "lblContaminantProperties(7)"
'       txtcontaminantproperties(2).LinkMode = 3
'       Call txtContaminantProperties_GotFocus(2)
'       txtcontaminantproperties(2).LinkRequest
'       txtcontaminantproperties(2).LinkMode = 0
'       Call txtContaminantProperties_LostFocus(2)
'
'       txtcontaminantproperties(3).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txtcontaminantproperties(3).LinkTopic = "DStEPP|MainForm"
'       txtcontaminantproperties(3).LinkItem = "lblContaminantProperties(4)"
'       txtcontaminantproperties(3).LinkMode = 3
'       Call txtContaminantProperties_GotFocus(3)
'       txtcontaminantproperties(3).LinkRequest
'       txtcontaminantproperties(3).LinkMode = 0
'       Call txtContaminantProperties_LostFocus(3)
'
'       txtcontaminantproperties(4).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txtcontaminantproperties(4).LinkTopic = "DStEPP|MainForm"
'       txtcontaminantproperties(4).LinkItem = "lblContaminantProperties(11)"
'       txtcontaminantproperties(4).LinkMode = 3
'       Call txtContaminantProperties_GotFocus(4)
'       txtcontaminantproperties(4).LinkRequest
'       txtcontaminantproperties(4).LinkMode = 0
'       Call txtContaminantProperties_LostFocus(4)
'
'       txtcontaminantproperties(5).LinkTopic = "StEPP|MainForm"
'       If DemoMode% Then txtcontaminantproperties(5).LinkTopic = "DStEPP|MainForm"
'       txtcontaminantproperties(5).LinkItem = "lblContaminantProperties(12)"
'       txtcontaminantproperties(5).LinkMode = 3
'       Call txtContaminantProperties_GotFocus(5)
'       txtcontaminantproperties(5).LinkRequest
'       txtcontaminantproperties(5).LinkMode = 0
'       Call txtContaminantProperties_LostFocus(5)
'
'        Exit Sub
'
'Error_DDE:
'   If Err = 282 Then
'      MsgBox "Error while performing DDE." & Chr$(13) & Chr$(13) & "StEPP must be running in order to perform DDE", 48, "Aeration System Analysis Program - Bubble Aeration"
'   Else
'      MsgBox "Unknown error while performing DDE with StEPP.", 48, "Aeration System Analysis Program - Bubble Aeration"
'   End If
'   Exit Sub
'
'
End Sub

Private Sub txtConcentration_Change(Index As Integer)
Dim i As Integer

  cmdOK.Enabled = True
  If (txtContaminantName.Text = "") Then cmdOK.Enabled = False
  If (cmdOK.Enabled) Then
    For i = 0 To 5
      If (i <> 3) Then
        If (val(txtContaminantProperties(i).Text) <= 0#) Then
          If (txtContaminantProperties(i).Visible) Then
            cmdOK.Enabled = False
          End If
        End If
      End If
      If (i = 3) Then
        If (val(txtContaminantProperties(i).Text) <= -300#) Then
          If (txtContaminantProperties(i).Visible) Then
            cmdOK.Enabled = False
          End If
        End If
      End If
    Next i
  End If
  For i = 0 To 1
    If (val(txtConcentration(i).Text) <= 0#) Then
      cmdOK.Enabled = False
    End If
  Next i

End Sub

Private Sub txtConcentration_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtConcentration(Index), Temp_Text)

End Sub

Private Sub txtConcentration_KeyPress(Index As Integer, KeyAscii As Integer)

    If KeyAscii = 13 Then
       KeyAscii = 0
       SendKeys "{Tab}"
       Exit Sub
    End If

    Call NumberCheck(KeyAscii)

End Sub

Private Sub txtConcentration_LostFocus(Index As Integer)
Dim x As rec_frmContaminantPropertyEdit
Dim NewVal As Double
Dim IsNew As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtConcentration(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

  x = Data_frmContaminantPropertyEdit
  IsNew = False
  
  Select Case Index
    Case 0        'Influent Conc.
      If (Unitted_LostFocus(UNITS_CONCENTRATION, txtConcentration(0), UnitsConc(0), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.Influent.Value = NewVal
        ThisContaminant.Influent.ValChanged = True
        ThisContaminant.Influent.UserInput = True
      End If
    Case 1        'Treatment Obj.
      If (Unitted_LostFocus(UNITS_CONCENTRATION, txtConcentration(1), UnitsConc(1), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.TreatmentObjective.Value = NewVal
        ThisContaminant.TreatmentObjective.ValChanged = True
        ThisContaminant.TreatmentObjective.UserInput = True
      End If
  End Select

  If (IsNew) Then
    x.Contaminants(x.DoEditNumber) = ThisContaminant
    Data_frmContaminantPropertyEdit = x
  End If
  Call LostFocus_Handle(Me, txtConcentration(Index), flag_ok)


End Sub

Private Sub txtContaminantName_Change()
Dim i As Integer
Dim x As rec_frmContaminantPropertyEdit

  txtContaminantName.Text = LTrim$(txtContaminantName.Text)
  cmdOK.Enabled = True
  If txtContaminantName.Text = "" Then cmdOK.Enabled = False
  If cmdOK.Enabled Then
    For i = 0 To 5
      If (i <> 3) Then
        If (val(txtContaminantProperties(i).Text) <= 0#) Then
          If (txtContaminantProperties(i).Visible) Then
            cmdOK.Enabled = False
          End If
        End If
      End If
      If i = 3 Then
        If (val(txtContaminantProperties(i).Text) <= -300#) Then
          If (txtContaminantProperties(i).Visible) Then
            cmdOK.Enabled = False
          End If
        End If
      End If
    Next i
  End If
  For i = 0 To 1
    If (val(txtConcentration(i).Text) <= 0#) Then
      cmdOK.Enabled = False
    End If
  Next i

  If loading Then
    x = Data_frmContaminantPropertyEdit
    If (Not x.DoAdd) Then
      cbochemname.List(x.DoEditNumber - 1) = txtContaminantName.Text
    End If
'cbochemname.AddItem txtcontaminantname.Text
'cbochemname.List(x.doeditnumber - 1) = txtcontaminantname.Text
  End If

End Sub

Private Sub txtContaminantName_GotFocus()
  Call GotFocus_Handle(Me, txtContaminantName, Temp_Text)

End Sub

Private Sub txtContaminantName_KeyPress(KeyAscii As Integer)

    If (KeyAscii = 13) Then
       KeyAscii = 0
       SendKeys "{Tab}"
       Exit Sub
    End If

    If (ListContaminantMenuOptionsIndex = 1) Then   'Edit Contaminant
       KeyAscii = 0
       Exit Sub
    End If

End Sub

Private Sub txtContaminantName_LostFocus()
Dim x As rec_frmContaminantPropertyEdit
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtContaminantName)) Then
     Exit Sub
   End If
   
   flag_ok = True

    txtContaminantName.Text = RTrim$(txtContaminantName.Text)
    If (txtContaminantName.Text <> "") Then
      'x = Data_frmContaminantPropertyEdit
      ThisContaminant.Name = txtContaminantName.Text
      'Data_frmContaminantPropertyEdit = x
    End If
  Call LostFocus_Handle(Me, txtContaminantName, flag_ok)


End Sub

Private Sub txtContaminantProperties_Change(Index As Integer)
Dim i As Integer

  cmdOK.Enabled = True
  If txtContaminantName.Text = "" Then cmdOK.Enabled = False
  If cmdOK.Enabled Then
    For i = 0 To 5
      If i <> 3 Then
        If val(txtContaminantProperties(i).Text) <= 0# Then
          If (txtContaminantProperties(i).Visible) Then
            cmdOK.Enabled = False
          End If
        End If
      End If
      If i = 3 Then
        If val(txtContaminantProperties(i).Text) <= -300# Then
          If (txtContaminantProperties(i).Visible) Then
            cmdOK.Enabled = False
          End If
        End If
      End If
    Next i
  End If
    
  For i = 0 To 1
    If val(txtConcentration(i).Text) <= 0# Then
      cmdOK.Enabled = False
    End If
  Next i

End Sub

Private Sub txtContaminantProperties_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtContaminantProperties(Index), Temp_Text)

End Sub

Private Sub txtContaminantProperties_KeyPress(Index As Integer, KeyAscii As Integer)
  
    If KeyAscii = 13 Then
       KeyAscii = 0
       SendKeys "{Tab}"
       Exit Sub
    End If

    Call NumberCheck(KeyAscii)

End Sub

Private Sub txtContaminantProperties_LostFocus(Index As Integer)
Dim HaveNeededValues As Integer
Dim ValueChanged As Integer
Dim Dummy As Double
Dim TempKelvin As Double, NBPKelvin As Double
Dim x As rec_frmContaminantPropertyEdit
Dim NewVal As Double
Dim IsNew As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtContaminantProperties(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

  x = Data_frmContaminantPropertyEdit
  IsNew = False
  
  Select Case Index
    Case 0        'Molecular Weight
      If (Unitted_LostFocus(UNITS_MW, txtContaminantProperties(0), UnitsProp(0), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.MolecularWeight.Value = NewVal
        ThisContaminant.MolecularWeight.ValChanged = True
        ThisContaminant.MolecularWeight.UserInput = True
      End If
    Case 1        'Henry's Constant
      If (NoUnits_LostFocus(txtContaminantProperties(1), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.HenrysConstant.Value = NewVal
        ThisContaminant.HenrysConstant.ValChanged = True
        ThisContaminant.HenrysConstant.UserInput = True
      End If
    Case 2        'Molar Volume
      If (Unitted_LostFocus(UNITS_MOLARVOLUME, txtContaminantProperties(2), UnitsProp(2), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.MolarVolume.Value = NewVal
        ThisContaminant.MolarVolume.ValChanged = True
        ThisContaminant.MolarVolume.UserInput = True
      End If
    Case 3        'Normal Boiling Point
      If (Unitted_LostFocus(UNITS_TEMPERATURE, txtContaminantProperties(3), UnitsProp(3), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.NormalBoilingPoint.Value = NewVal       '+ 273.15
        ThisContaminant.NormalBoilingPoint.ValChanged = True
        ThisContaminant.NormalBoilingPoint.UserInput = True
      End If
    Case 4        'Liquid Diffusivity
      If (Unitted_LostFocus(UNITS_DIFFUSIVITY, txtContaminantProperties(4), UnitsProp(4), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.LiquidDiffusivity.Value = NewVal
        ThisContaminant.LiquidDiffusivity.ValChanged = True
        ThisContaminant.LiquidDiffusivity.UserInput = True
      End If
    Case 5        'Gas Diffusivity
      If (Unitted_LostFocus(UNITS_DIFFUSIVITY, txtContaminantProperties(5), UnitsProp(5), NewVal, Temp_Text)) Then
        IsNew = True
        ThisContaminant.GasDiffusivity.Value = NewVal
        ThisContaminant.GasDiffusivity.ValChanged = True
        ThisContaminant.GasDiffusivity.UserInput = True
      End If

  End Select

  If (IsNew) Then
    x.Contaminants(x.DoEditNumber) = ThisContaminant
    Data_frmContaminantPropertyEdit = x
  End If
  Call LostFocus_Handle(Me, txtContaminantProperties(Index), flag_ok)


End Sub

Private Sub txtTestDDE_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtTestDDE(Index), Temp_Text)

End Sub

Private Sub txtTestDDE_LostFocus(Index As Integer)
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtTestDDE(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True
  
  Call LostFocus_Handle(Me, txtTestDDE(Index), flag_ok)


End Sub

Private Sub UnitsConc_Click(Index As Integer)
Dim Dummy As Double

  Select Case Index
    Case 0            'Influent Conc.
      Dummy = ThisContaminant.Influent.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsConc(0), txtConcentration(0))

    Case 1            'Treatment Obj.
      Dummy = ThisContaminant.TreatmentObjective.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsConc(1), txtConcentration(1))

  End Select

End Sub

Private Sub UnitsProp_Click(Index As Integer)
Dim Dummy As Double

  Select Case Index
    Case 0            'Molecular Weight
      Dummy = ThisContaminant.MolecularWeight.Value
      Call Unitted_UnitChange(UNITS_MW, Dummy, UnitsProp(0), txtContaminantProperties(0))

    Case 2            'Molar Volume
      Dummy = ThisContaminant.MolarVolume.Value
      Call Unitted_UnitChange(UNITS_MOLARVOLUME, Dummy, UnitsProp(2), txtContaminantProperties(2))

    Case 3            'Normal Boiling Point
      Dummy = ThisContaminant.NormalBoilingPoint.Value
      Call Unitted_UnitChange(UNITS_TEMPERATURE, Dummy, UnitsProp(3), txtContaminantProperties(3))

    Case 4            'Liquid Diffusivity
      Dummy = ThisContaminant.LiquidDiffusivity.Value
      Call Unitted_UnitChange(UNITS_DIFFUSIVITY, Dummy, UnitsProp(4), txtContaminantProperties(4))

    Case 5            'Gas Diffusivity
      Dummy = ThisContaminant.GasDiffusivity.Value
      Call Unitted_UnitChange(UNITS_DIFFUSIVITY, Dummy, UnitsProp(5), txtContaminantProperties(5))

  End Select

End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmFlowsLoadingsScreen2 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Flows and Loadings"
   ClientHeight    =   4320
   ClientLeft      =   4245
   ClientTop       =   2865
   ClientWidth     =   4665
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4320
   ScaleWidth      =   4665
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   810
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   3570
      Width           =   1215
   End
   Begin VB.CommandButton cmdCancel 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "Cancel"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   2610
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   3570
      Width           =   1215
   End
   Begin Threed.SSFrame fraFlowsLoadings 
      Height          =   3135
      Left            =   210
      TabIndex        =   0
      Top             =   150
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   5524
      _StockProps     =   14
      Caption         =   "Pick Flow and Loading Parameters to Specify:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optFlowsLoadings 
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   1
         TabStop         =   0   'False
         Top             =   1350
         Width           =   3975
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Water Loading Rate and Air Loading Rate"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optFlowsLoadings 
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   2
         TabStop         =   0   'False
         Top             =   870
         Width           =   3975
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Water Flow Rate And Air to Water Ratio"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optFlowsLoadings 
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   3
         TabStop         =   0   'False
         Top             =   390
         Width           =   3975
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Water Flow Rate and Air Flow Rate"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Line Line1 
         X1              =   0
         X2              =   4200
         Y1              =   1950
         Y2              =   1950
      End
      Begin VB.Label Label1 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   $"FlowsLoadingsScreen2.frx":0000
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   855
         Left            =   120
         TabIndex        =   4
         Top             =   2070
         Width           =   3975
      End
   End
End
Attribute VB_Name = "frmFlowsLoadingsScreen2"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdCancel_Click()
    frmFlowsLoadingsScreen2.Hide
End Sub

Private Sub cmdOK_Click()
    Dim i As Integer
    Dim CurrentUserOption As Integer

    For i = 0 To 2
        If optFlowsLoadings(i).Value = True Then
           CurrentUserOption = i
        End If
    Next i

    If CurrentUserOption = UsersFlowsLoadingsOption Then
       cmdCancel_Click
       Exit Sub
    End If

    Call SetUpFlowsLoadingsTextBoxes(CurrentUserOption)

    UsersFlowsLoadingsOption = CurrentUserOption

    frmFlowsLoadingsScreen2.Hide
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()
  Call CenterThisForm(Me)
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmMainMenu 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Aeration System Analysis Program (ASAP)"
   ClientHeight    =   6510
   ClientLeft      =   1440
   ClientTop       =   1875
   ClientWidth     =   9495
   DrawStyle       =   1  'Dash
   Icon            =   "MainMenu.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   ScaleHeight     =   6510
   ScaleWidth      =   9495
   Begin VB.CommandButton cmdExit 
      Caption         =   "E&xit"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   3600
      TabIndex        =   6
      Top             =   6030
      Width           =   2325
   End
   Begin Threed.SSPanel pnl_main 
      Height          =   1575
      Index           =   1
      Left            =   2340
      TabIndex        =   7
      Top             =   810
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8700
      _ExtentY        =   2773
      _StockProps     =   15
      Caption         =   "Packed Tower Aeration"
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   6
      Begin VB.CommandButton cmd_titlemethod 
         Caption         =   "Enter Rating Mode"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   900
         TabIndex        =   1
         Top             =   1020
         Width           =   3855
      End
      Begin VB.CommandButton cmd_titlemethod 
         Caption         =   "Enter Design Mode"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   0
         Left            =   900
         TabIndex        =   0
         Top             =   510
         Width           =   3855
      End
      Begin VB.Label lbl_number 
         Caption         =   "2."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   1
         Left            =   420
         TabIndex        =   10
         Top             =   1095
         Width           =   435
      End
      Begin VB.Label lbl_number 
         Caption         =   "1."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   420
         TabIndex        =   9
         Top             =   585
         Width           =   435
      End
   End
   Begin Threed.SSPanel pnl_main 
      Height          =   585
      Index           =   0
      Left            =   2730
      TabIndex        =   8
      Top             =   30
      Width           =   4095
      _Version        =   65536
      _ExtentX        =   7223
      _ExtentY        =   1032
      _StockProps     =   15
      Caption         =   "Main Menu"
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSPanel pnl_main 
      Height          =   1575
      Index           =   2
      Left            =   2340
      TabIndex        =   11
      Top             =   2520
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8700
      _ExtentY        =   2773
      _StockProps     =   15
      Caption         =   "Bubble Aeration"
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   6
      Begin VB.CommandButton cmd_titlemethod 
         Caption         =   "Enter Design Mode"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   900
         TabIndex        =   2
         Top             =   510
         Width           =   3855
      End
      Begin VB.CommandButton cmd_titlemethod 
         Caption         =   "Enter Rating Mode"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   900
         TabIndex        =   3
         Top             =   1020
         Width           =   3855
      End
      Begin VB.Label lbl_number 
         Caption         =   "3."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   2
         Left            =   420
         TabIndex        =   13
         Top             =   585
         Width           =   435
      End
      Begin VB.Label lbl_number 
         Caption         =   "4."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   3
         Left            =   420
         TabIndex        =   12
         Top             =   1095
         Width           =   435
      End
   End
   Begin Threed.SSPanel pnl_main 
      Height          =   1575
      Index           =   3
      Left            =   2340
      TabIndex        =   14
      Top             =   4230
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8700
      _ExtentY        =   2773
      _StockProps     =   15
      Caption         =   "Surface Aeration"
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   6
      Begin VB.CommandButton cmd_titlemethod 
         Caption         =   "Enter Rating Mode"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   900
         TabIndex        =   5
         Top             =   1020
         Width           =   3855
      End
      Begin VB.CommandButton cmd_titlemethod 
         Caption         =   "Enter Design Mode"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   900
         TabIndex        =   4
         Top             =   510
         Width           =   3855
      End
      Begin VB.Label lbl_number 
         Caption         =   "6."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   5
         Left            =   420
         TabIndex        =   16
         Top             =   1095
         Width           =   435
      End
      Begin VB.Label lbl_number 
         Caption         =   "5."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   4
         Left            =   420
         TabIndex        =   15
         Top             =   585
         Width           =   435
      End
   End
   Begin VB.Menu mnuModels 
      Caption         =   "&Models"
      Begin VB.Menu mnuModelsItem 
         Caption         =   "&1 -- Packed Tower Aeration (Design Mode)"
         Index           =   10
      End
      Begin VB.Menu mnuModelsItem 
         Caption         =   "&2 -- Packed Tower Aeration (Rating Mode)"
         Index           =   20
      End
      Begin VB.Menu mnuModelsItem 
         Caption         =   "&3 -- Bubble Aeration (Design Mode)"
         Index           =   30
      End
      Begin VB.Menu mnuModelsItem 
         Caption         =   "&4 -- Bubble Aeration (Rating Mode)"
         Index           =   40
      End
      Begin VB.Menu mnuModelsItem 
         Caption         =   "&5 -- Surface Aeration (Design Mode)"
         Index           =   50
      End
      Begin VB.Menu mnuModelsItem 
         Caption         =   "&6 -- Surface Aeration (Rating Mode)"
         Index           =   60
      End
      Begin VB.Menu mnuModelsItem 
         Caption         =   "-"
         Index           =   198
      End
      Begin VB.Menu mnuModelsItem 
         Caption         =   "E&xit"
         Index           =   199
      End
   End
   Begin VB.Menu mnuHelp 
      Caption         =   "&Help"
      Begin VB.Menu mnuHelpItem 
         Caption         =   "Online Help ..."
         Index           =   5
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "Online Manual ..."
         Index           =   7
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "-"
         Index           =   8
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "View Version History ..."
         Index           =   10
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "View Disclaimer ..."
         Index           =   20
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "Technical Assistance Provided By ..."
         Index           =   30
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "-"
         Index           =   190
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&About ..."
         Index           =   200
      End
   End
End
Attribute VB_Name = "frmMainMenu"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

'Whether Password is needed to use program
'   False --> No Password Needed
'   True --> Password needed
Const Password_Protection_On = False

Dim disclaimer_agreed As Integer
Dim frmMainMenu_Okay_To_Unload As Boolean



Const frmMainMenu_declarations_end = True


Private Sub cmd_passwd_Click_OLD()
'If StrComp(decrypt_string("V\;>Sa["), txt_passwd.Text, 1) Then
'    Unload Me
'    End
'Else
'    Frm_Passwd.Visible = False
'End If
End Sub

Private Sub cmd_title_Click_OLD(Index As Integer)
'  Dim Check_has_seen_disclaimer As String
'  Dim msg$
'
''check_area
'Select Case Index
'Case 0          '// Continue or I Agree button
'    frame_title.Visible = False
'
'    If (disclaimer_agreed = False) Then
'      Check_has_seen_disclaimer = INI_Getsetting("has_seen_disclaimer")
'      If (Check_has_seen_disclaimer = "1") Then
'        disclaimer_agreed = True
'      End If
'    End If
'    If (disclaimer_agreed = False) Then
'      If (Not DemoMode%) And Password_Protection_On Then
'        Frm_Passwd.Top = -400
'        Frm_Passwd.Left = -40
'        Frm_Passwd.Visible = True
'        Frm_Passwd.ZOrder
'        pnl_passwd.Caption = "This Program Needs a Password to Work!" + Chr(13) + "If You Do Not Know the Password." + Chr(13) + "You should not be using the Program."
'        txt_passwd.SetFocus
'      End If
'
'      msg$ = ""
'
'msg$ = "By choosing " & Chr$(34) & "I Agree" & Chr$(34) & " you acknowledge that this software is under development and not guaranteed to be free of errors.  Furthermore there may be errors in the software that lead to erroneous output.  MTU shall not be liable for any loss, damage, injury, or casualty of whatsoever kind, or by whomsoever caused to the person or property of anyone arising out of or resulting from receipt and use of any aspect of the software.  References to specific commercial products, processes, or services by trademark, manufacturer, or otherwise does not necessarily constitute or imply endorsement/recommendation by the authors or the respective organizations under which the software was developed."
'liability.Caption = msg$
'
'      Disclaimer.ZOrder
'      Disclaimer.Visible = True
'      Disclaimer.Move 0, 0
'      cmd_title(0).Caption = "I Agree"
'      cmd_title(0).ZOrder
'      cmd_title(1).ZOrder
'      disclaimer_agreed = True
'
'      cmddisclaimer.Top = cmd_title(0).Top
'      cmddisclaimer.Left = cmd_title(0).Left + cmd_title(0).Width + 200
'      cmddisclaimer.Visible = True
'      cmddisclaimer.ZOrder
'    Else
'      Disclaimer.Visible = False
'      cmd_title(0).Visible = False
'      cmd_title(1).Visible = False
'      cmddisclaimer.Visible = False
'
'      pnl_main(1).Visible = True
'      pnl_main(2).Visible = True
'      pnl_main(3).Visible = True
'    End If
'
'Case 1
'    Unload Me
'    End
'End Select
End Sub

Private Sub cmd_titlemethod_Click(Index As Integer)
    Dim i%

Screen.MousePointer = 11

Select Case Index
    Case 0   ' Packed Tower Design Mode
        CurrMethod% = 0
        CurrMode% = 0
        frmPTADScreen1.Show
        Call StartScreen1DefaultCase
    
    Case 1   ' Packed Tower Rating Mode
        CurrMethod% = 0
        CurrMode% = 1
        ShownScreen1Previously = False
        frmPTADScreen2.Show
        Call StartScreen2DefaultCase

    Case 2   'Bubble Aeration Design Mode
        CurrMethod% = 1
        CurrMode = 0
        frmBubble.Caption = "Bubble Aeration - Design Mode"
        frmBubble!mnuFile(0).Caption = "Switch to &Rating Mode"
        BubbleAerationMode = DESIGN_MODE
        For i% = 1 To 4
            frmBubble!txtTankParameters(i%).Enabled = False
        Next i%
        frmBubble.Show
        Call StartBubbleDefaultCase

    Case 3   'Bubble Aeration Rating Mode
        CurrMethod% = 1
        CurrMode% = 1
        frmBubble.Caption = "Bubble Aeration - Rating Mode"
        frmBubble!mnuFile(0).Caption = "Switch to &Design Mode"
        BubbleAerationMode = RATING_MODE
        bub.TankVolume.UserInput = True
        For i% = 1 To 4
            frmBubble!txtTankParameters(i%).Enabled = True
        Next i%
        frmBubble.Show
        Call StartBubbleDefaultCase

    Case 4   'Surface Aeration Design Mode
        CurrMethod% = 2
        CurrMode% = 0
        frmSurface.Caption = "Surface Aeration - Design Mode"
        frmSurface!mnuFile(0).Caption = "Switch to &Rating Mode"
        SurfaceAerationMode = DESIGN_MODE
        For i% = 1 To 4
            frmSurface!txtTankParameters(i%).Enabled = False
        Next i%
        frmSurface.Show
        Call StartSurfaceDefaultCase

    Case 5   'Surface Aeration Rating Mode
        CurrMethod% = 2
        CurrMode% = 1
        frmSurface.Caption = "Surface Aeration - Rating Mode"
        frmSurface!mnuFile(0).Caption = "Switch to &Design Mode"
        SurfaceAerationMode = RATING_MODE
        sur.TankHydraulicRetentionTime.UserInput = True
        For i% = 1 To 4
            frmSurface!txtTankParameters(i%).Enabled = True
        Next i%
        frmSurface.Show
        Call StartSurfaceDefaultCase
End Select

Screen.MousePointer = 0
'frame_title.Visible = False
frmMainMenu.Hide

End Sub

Private Sub cmddisclaimer_Click_OLD()
'  Call INI_PutSetting("has_seen_disclaimer", "1")
'  Call cmd_title_Click(0)
End Sub

Private Sub cmdExit_Click()
  frmMainMenu_Okay_To_Unload = True
  Unload Me
End Sub

Private Sub Form_Load()
Dim i%
Dim duh As Integer
Dim version_text As String

  frmMainMenu.Width = SCREEN_WIDTH_STANDARD
  frmMainMenu.Height = SCREEN_HEIGHT_STANDARD
  'Center the form on the screen
  If WindowState = 0 Then
    'don't attempt if screen Minimized or Maximized
    Move (Screen.Width - frmMainMenu.Width) / 2, (Screen.Height - frmMainMenu.Height) / 2
  End If
      
  'Disclaimer.Visible = False
  'cmd_title(0).Visible = False
  'cmd_title(1).Visible = False
  'cmddisclaimer.Visible = False

  For i% = 0 To 3
    pnl_main(i%).Left = frmMainMenu.Width / 2 - pnl_main(i%).Width / 2
  Next i%
  'cmdExit.Move frame_title.Width / 2 - cmdExit.Width / 2
  pnl_main(1).Visible = True
  pnl_main(2).Visible = True
  pnl_main(3).Visible = True
  
  Exit Sub





Screen.MousePointer = 11

'---- Setup helpfiles
If (fileexists(App.Path & "\help\asap.hlp")) Then App.HelpFile = App.Path & "\help\asap.hlp"
    
''''If (Not security_ok()) Then Exit Sub

If (StudentMode%) Then
    If (Not fileexists(decrypt_string("es#52k#>h5>2VO52k"))) Then
        MsgBox "MTU Version Only!!", 16
        End
    End If
End If


pnl_main(1).Visible = False
pnl_main(2).Visible = False
pnl_main(3).Visible = False

NL = Chr$(13) & Chr$(10)
disclaimer_agreed = False

''''ChDrive App.Path
''''ChDir App.Path
Call ChangeDir_Main
SaveAndLoadPath = App.Path


'Frm_Passwd.Visible = False
frmMainMenu.Width = SCREEN_WIDTH_STANDARD
frmMainMenu.Height = SCREEN_HEIGHT_STANDARD

'Center the form on the screen
If WindowState = 0 Then
  'don't attempt if screen Minimized or Maximized
  Move (Screen.Width - frmMainMenu.Width) / 2, (Screen.Height - frmMainMenu.Height) / 2
End If

For i% = 0 To 3
  pnl_main(i%).Left = frmMainMenu.Width / 2 - pnl_main(i%).Width / 2
Next i%

'frame_title.ZOrder
'frame_title.Move -50, -200

'pnl_title(0).Move frame_title.Width / 2 - pnl_title(0).Width / 2
'pnl_title(1).Move frame_title.Width / 2 - pnl_title(1).Width / 2
'pnl_title(2).Move frame_title.Width / 2 - pnl_title(2).Width / 2
'cmdExit.Move frame_title.Width / 2 - cmdExit.Width / 2

'cmd_title(0).Top = pnl_title(2).Top + pnl_title(2).Height - 150 + 100
'cmd_title(0).Left = 240
'cmd_title(0).ZOrder
'cmd_title(1).Top = cmd_title(0).Top
'cmd_title(1).Left = SCREEN_WIDTH_STANDARD - cmd_title(1).Width - 240 - 240
'cmd_title(1).ZOrder

'pnl_title(0).Caption = "A S A P" & Chr$(13) & "Aeration System Analysis Program"
'pnl_title(1).Caption = "Packed Tower Aeration" & Chr$(13) & Chr$(13) & "Bubble Aeration" & Chr$(13) & Chr$(13) & "Surface Aeration"
'pnl_title(2).Caption = "CenCITT" & Chr$(13) & "Center for Clean Industrial and Treatment Technologies"
'pnl_title(3).Caption = "Model && Software Developers:" & Chr$(13) & "David R. Hokanson     David W. Hand     John C. Crittenden"
If (StudentMode%) Then
  version_text = "Version 1.00(S)"
Else
  version_text = "Version 1.00"
End If
'pnl_title(4).Caption = version_text & Chr$(13) & Chr$(13) & "Copyright 1993-1997" & Chr$(13) & "Michigan Technological University" & Chr$(13) & "Houghton, Michigan"
    
' -------------------------------------------------------------------------------------
'Initialize Default Power Variables
scr1.Power.BlowerEfficiency = 35#
scr1.Power.PumpEfficiency = 80#
Scr2.Power.BlowerEfficiency = 35#
Scr2.Power.PumpEfficiency = 80#

bub.Power.BlowerEfficiency = 35#
bub.Power.TankWaterDepth = 4#
bub.Power.NumberOfBlowersinEachTank = 1

'picMtu.Picture = LoadPicture(app.Path & "\mtu_logo.bmp")
'picCencitt.Picture = LoadPicture(app.Path & "\cencitt1.bmp")

Me.Show

ReadMainPackingDB
ReadUserPackingDB

''''Call ini_initializethisprogram("asap")

Screen.MousePointer = 0

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  If (frmMainMenu_Okay_To_Unload) Then
    Cancel = False
  Else
    Cancel = True
  End If
End Sub

Private Sub Form_Unload(Cancel As Integer)

    ''''On Error Resume Next

    'Forms for Packed Tower Aeration
    Unload frmAirWaterProperties
    'Unload frmListContaminant
    'Unload frmPropContaminant
    ''''Unload HelpTipForm
    Unload frmShowOndaKLaProperties
    Unload frmSelectPacking
    Unload frmShowPackingProperties
    Unload frmPower
    Unload frmPowerScreen2
    Unload frmFlowsLoadingsScreen2
    'Unload frmListcontaminantScreen2
    'Unload frmPropContaminantScreen2
    Unload frmOptimizeContaminant
    Unload frmPTADScreen1
    Unload frmPTADScreen2

    'Forms for Bubble Aeration
    Unload frmBubble
    Unload frmBubbleEffluentConcentrations
    Unload frmOxygenMassTransferCoeff
    'Unload frmListContaminantBubble
    Unload frmBubblePower
    'Unload frmPropContaminantBubble
    Unload frmBubbleAchievingRemovalEfficiency
    Unload frmWaterPropertiesBubble

    'Forms for Surface Aeration
    Unload frmSurface
    Unload frmSurfaceEffluentConcentrations
    'Unload frmListContaminantSurface
    'Unload frmPropContaminantSurface
    Unload frmWaterPropertiesSurface

    'Forms for all three modules
    ''''Unload frmViewContaminantPropertiesPTAD
    Unload frmViewEffluentConcentrationsASAP

    '
    ' CLOSE ANY WINDOWS WE MISSED.
    '
    Call Close_All_Windows

    '
    ' END THE PROGRAM.
    '
    frmMainMenu_Okay_To_Unload = True
    End

End Sub


'Private Function security_ok() As Integer
'Dim duh As Integer
''---- If distributing via CD, check if this is a valid
''.... copy of the ADSIM program:
''.... (Note: this global var is set in DEMOMODE.BAS)
'
'If (Mode_Distribution_on_CD) Then
'  If ((Not StudentMode) Or (Not fileexists("R:\esbeam\data\tack\esbeam.tck"))) Then
'    If (Not fileexists(App.Path & "\5YVJ058Z.CE3")) Then
'      If (fileexists(GetWindowsDir() & "\etchk.exe")) Then
'        ChDrive GetWindowsDir()
'        ChDir GetWindowsDir()
'        duh = Shell(GetWindowsDir() & "\etchk.exe", 1)
'          DoEvents
'        Do While (True)
'          DoEvents
'          If (fileexists(GetWindowsDir() & "\exit.x")) Then
'            Kill GetWindowsDir() & "\exit.x"
'            DoEvents
'            End
'          End If
'          DoEvents
'          If (fileexists(GetWindowsDir() & "\go.x")) Then
'            Kill GetWindowsDir() & "\go.x"
'            DoEvents
'            Exit Do
'          End If
'        Loop
'      Else
'        security_ok = False
'      End If
'    End If
'  End If
'End If
'
' security_ok = True
' ChDrive App.Path
' ChDir App.Path
'End Function

Private Sub txt_passwd_KeyPress_OLD(KeyAscii As Integer)
'    If KeyAscii = 13 Then
'       KeyAscii = 0
'       cmd_passwd_Click
'       Exit Sub
'    End If
End Sub


Private Sub mnuHelpItem_Click(Index As Integer)
Dim fn_This As String
  Select Case Index
'    Case 5:       'CONTENTS.
'      SendKeys "{F1}", True
    Case 5:       'ONLINE HELP.
      Call Launch_ASAP_HLP_File
    Case 7:       'ONLINE MANUAL.
      fn_This = MAIN_APP_PATH & "\help\asap.pdf"
      If (fileexists(fn_This) = False) Then
        Call Show_Message("The file `" & fn_This & "` is missing.")
        Exit Sub
      End If
      Call LaunchFile_General("", fn_This)
      'Call LaunchFile_General("", MAIN_APP_PATH & "\help\asap.pdf")
    Case 10:      'VIEW VERSION HISTORY.
      fn_This = App.Path & "\dbase\readme.txt"
      If (fileexists(fn_This) = False) Then
        Call Show_Message("The file `" & fn_This & "` is missing.")
        Exit Sub
      End If
      Call Launch_Notepad(fn_This)
    Case 20:      'VIEW DISCLAIMER.
      'SHOW THE DISCLAIMER WINDOW.
      splash_mode = 101
      splash_button_pressed = 0
      frmSplash.Show 1
    Case 30:      'TECHNICAL ASSISTANCE PROVIDED BY.
      frmTechAssistance.Show 1
    Case 200:     'ABOUT.
      frmAbout.Show 1
  End Select
End Sub

Private Sub mnuModelsItem_Click(Index As Integer)
Dim Button_To_Push As Integer
  Button_To_Push = -1
  Select Case Index
    Case 10: Button_To_Push = 0
    Case 20: Button_To_Push = 1
    Case 30: Button_To_Push = 2
    Case 40: Button_To_Push = 3
    Case 50: Button_To_Push = 4
    Case 60: Button_To_Push = 5
    Case 199:
      Call cmdExit_Click
      Exit Sub
  End Select
  If (Button_To_Push <> -1) Then
    Call cmd_titlemethod_Click(Button_To_Push)
    Exit Sub
  End If
End Sub





VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmOptimizeContaminant 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Optimization Results:  Concentrations"
   ClientHeight    =   5025
   ClientLeft      =   3705
   ClientTop       =   2580
   ClientWidth     =   7065
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5025
   ScaleWidth      =   7065
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   5520
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   930
      Width           =   735
   End
   Begin Threed.SSFrame fraDesignContaminant 
      Height          =   2055
      Left            =   210
      TabIndex        =   0
      Top             =   210
      Width           =   4335
      _Version        =   65536
      _ExtentX        =   7641
      _ExtentY        =   3619
      _StockProps     =   14
      Caption         =   "Concentration Profile of the Design Contaminant:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblDesignContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3000
         TabIndex        =   10
         Top             =   1590
         Width           =   1215
      End
      Begin VB.Label lblDesignContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3000
         TabIndex        =   9
         Top             =   1230
         Width           =   1215
      End
      Begin VB.Label lblDesignContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3000
         TabIndex        =   8
         Top             =   870
         Width           =   1215
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Effluent Concentration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   120
         TabIndex        =   7
         Top             =   1590
         Width           =   2655
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Treatment Objective"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   120
         TabIndex        =   6
         Top             =   1230
         Width           =   2655
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Influent Concentration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   5
         Top             =   870
         Width           =   2655
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Name:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   4
         Top             =   390
         Width           =   735
      End
      Begin VB.Label lblDesignContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1080
         TabIndex        =   3
         Top             =   390
         Width           =   3135
      End
   End
   Begin Threed.SSFrame fraOtherContaminants 
      Height          =   2175
      Left            =   210
      TabIndex        =   1
      Top             =   2610
      Width           =   6615
      _Version        =   65536
      _ExtentX        =   11663
      _ExtentY        =   3831
      _StockProps     =   14
      Caption         =   "Concentration Profiles for Other Contaminants:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstOptimizeContaminant 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1590
         Left            =   120
         TabIndex        =   11
         Top             =   390
         Width           =   1935
      End
      Begin VB.Label lblOtherContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   5280
         TabIndex        =   19
         Top             =   1590
         Width           =   1215
      End
      Begin VB.Label lblOtherContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   5280
         TabIndex        =   18
         Top             =   1230
         Width           =   1215
      End
      Begin VB.Label lblOtherContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   5280
         TabIndex        =   17
         Top             =   870
         Width           =   1215
      End
      Begin VB.Label lblOtherContaminant 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3360
         TabIndex        =   16
         Top             =   390
         Width           =   3135
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Effluent Concentration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   2400
         TabIndex        =   15
         Top             =   1590
         Width           =   2655
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Treatment Objective"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   2400
         TabIndex        =   14
         Top             =   1230
         Width           =   2655
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Influent Concentration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   2400
         TabIndex        =   13
         Top             =   870
         Width           =   2655
      End
      Begin VB.Label lblOptimizationFormLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Name:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   2400
         TabIndex        =   12
         Top             =   390
         Width           =   735
      End
   End
End
Attribute VB_Name = "frmOptimizeContaminant"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
    Unload frmOptimizeContaminant
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()

  Call CenterThisForm(Me)
  
  Call LabelsOptimizeContaminantsSI

End Sub

Private Sub lstOptimizeContaminant_Click()
    Dim i As Integer, Tag As Integer

    i = lstOptimizeContaminant.ListIndex + 1
    Tag = scr1.ID_OptimalDesignContaminant

    'Correct for the fact that design contaminant is not
    'in the list
    If i >= Tag Then i = i + 1

    frmOptimizeContaminant!lblOtherContaminant(0).Caption = scr1.Contaminant(i).Name
    frmOptimizeContaminant!lblOtherContaminant(1).Caption = Format$(scr1.Contaminant(i).Influent.Value, GetTheFormat(scr1.Contaminant(i).Influent.Value))
    frmOptimizeContaminant!lblOtherContaminant(2).Caption = Format$(scr1.Contaminant(i).TreatmentObjective.Value, GetTheFormat(scr1.Contaminant(i).TreatmentObjective.Value))
    frmOptimizeContaminant!lblOtherContaminant(3).Caption = Format$(scr1.Contaminant(i).Effluent.Value, GetTheFormat(scr1.Contaminant(i).Effluent.Value))

End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmOxygenMassTransferCoeff 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Find KLa, O2 from Clean Water Oxygen Transfer Test Data"
   ClientHeight    =   6120
   ClientLeft      =   1875
   ClientTop       =   2865
   ClientWidth     =   8925
   ControlBox      =   0   'False
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6120
   ScaleWidth      =   8925
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   555
      Left            =   6510
      TabIndex        =   8
      Top             =   1560
      Width           =   1275
   End
   Begin Threed.SSFrame fraDataAvailable 
      Height          =   2265
      Left            =   120
      TabIndex        =   6
      Top             =   270
      Width           =   4305
      _Version        =   65536
      _ExtentX        =   7594
      _ExtentY        =   3995
      _StockProps     =   14
      Caption         =   "Data Available:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optDataAvailable 
         Height          =   315
         Index           =   2
         Left            =   480
         TabIndex        =   9
         TabStop         =   0   'False
         Top             =   1620
         Width           =   3075
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "No Data Available"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   19.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optDataAvailable 
         Height          =   315
         Index           =   1
         Left            =   480
         TabIndex        =   10
         TabStop         =   0   'False
         Top             =   1020
         Width           =   3075
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "SOTE vs. Qair Data Available"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   19.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optDataAvailable 
         Height          =   315
         Index           =   0
         Left            =   480
         TabIndex        =   11
         TabStop         =   0   'False
         Top             =   360
         Width           =   3075
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "SOTR vs. Qair Data Available"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   19.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin Threed.SSFrame fraDataParameters 
      Height          =   3240
      Left            =   120
      TabIndex        =   7
      Top             =   2700
      Width           =   8565
      _Version        =   65536
      _ExtentX        =   15108
      _ExtentY        =   5715
      _StockProps     =   14
      Caption         =   "Clean Water Oxygen Transfer Test Data Parameters:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtDataParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2400
         TabIndex        =   0
         Top             =   540
         Width           =   1455
      End
      Begin VB.TextBox txtDataParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2400
         TabIndex        =   1
         Top             =   960
         Width           =   1455
      End
      Begin VB.TextBox txtDataParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2400
         TabIndex        =   2
         Top             =   1380
         Width           =   1455
      End
      Begin VB.TextBox txtDataParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2400
         TabIndex        =   3
         Top             =   1800
         Width           =   1455
      End
      Begin VB.TextBox txtDataParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2400
         TabIndex        =   4
         Top             =   2220
         Width           =   1455
      End
      Begin VB.TextBox txtDataParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   2400
         TabIndex        =   5
         Top             =   2640
         Width           =   1455
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "SOTE"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   300
         TabIndex        =   29
         Top             =   540
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "SOTR"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   300
         TabIndex        =   28
         Top             =   960
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Flow Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   300
         TabIndex        =   27
         Top             =   1380
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Barometric Pressure"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   300
         TabIndex        =   26
         Top             =   1800
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Water Depth"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   300
         TabIndex        =   25
         Top             =   2220
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Water Volume"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   300
         TabIndex        =   24
         Top             =   2640
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "C*, 20"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   4620
         TabIndex        =   23
         Top             =   540
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Apparent KLa, 20"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   3960
         TabIndex        =   22
         Top             =   1020
         Width           =   2475
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Phi"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   4560
         TabIndex        =   21
         Top             =   1440
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "True KLa, 20"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   4560
         TabIndex        =   20
         Top             =   1860
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Theta"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   10
         Left            =   4560
         TabIndex        =   19
         Top             =   2280
         Width           =   1815
      End
      Begin VB.Label lblDataParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa, O2 at Operating T"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   11
         Left            =   4320
         TabIndex        =   18
         Top             =   2700
         Width           =   2115
      End
      Begin VB.Label lblDataParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   6720
         TabIndex        =   17
         Top             =   540
         Width           =   1455
      End
      Begin VB.Label lblDataParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   6720
         TabIndex        =   16
         Top             =   1020
         Width           =   1455
      End
      Begin VB.Label lblDataParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   6720
         TabIndex        =   15
         Top             =   1440
         Width           =   1455
      End
      Begin VB.Label lblDataParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   6720
         TabIndex        =   14
         Top             =   1860
         Width           =   1455
      End
      Begin VB.Label lblDataParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   10
         Left            =   6720
         TabIndex        =   13
         Top             =   2280
         Width           =   1455
      End
      Begin VB.Label lblDataParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   11
         Left            =   6720
         TabIndex        =   12
         Top             =   2700
         Width           =   1455
      End
   End
End
Attribute VB_Name = "frmOxygenMassTransferCoeff"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub fraTotalBrakePower_Click()

End Sub
VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmPower 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Power Calculations"
   ClientHeight    =   5475
   ClientLeft      =   3780
   ClientTop       =   2535
   ClientWidth     =   4710
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5475
   ScaleWidth      =   4710
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   492
      Left            =   1740
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   4710
      Width           =   1212
   End
   Begin Threed.SSFrame fraPumpBrakePower 
      Height          =   1215
      Left            =   240
      TabIndex        =   3
      Top             =   2070
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   2138
      _StockProps     =   14
      Caption         =   "Pump Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   3
         Left            =   2520
         TabIndex        =   2
         Top             =   330
         Width           =   1572
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2520
         TabIndex        =   15
         Top             =   690
         Width           =   1575
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pump Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   120
         TabIndex        =   14
         Top             =   690
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pump Efficiency"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   120
         TabIndex        =   13
         Top             =   330
         Width           =   2295
      End
   End
   Begin Threed.SSFrame fraTotalBrakePower 
      Height          =   855
      Left            =   240
      TabIndex        =   4
      Top             =   3540
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   1503
      _StockProps     =   14
      Caption         =   "Total Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   2520
         TabIndex        =   8
         Top             =   360
         Width           =   1575
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Total Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   120
         TabIndex        =   7
         Top             =   360
         Width           =   2295
      End
   End
   Begin Threed.SSFrame fraBlowerBrakePower 
      Height          =   1575
      Left            =   240
      TabIndex        =   5
      Top             =   240
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   2773
      _StockProps     =   14
      Caption         =   "Blower Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   1
         Left            =   2520
         TabIndex        =   1
         Top             =   720
         Width           =   1572
      End
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   0
         Left            =   2520
         TabIndex        =   0
         Top             =   360
         Width           =   1572
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2520
         TabIndex        =   12
         Top             =   1080
         Width           =   1575
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Blower Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   11
         Top             =   1080
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Blower Efficiency"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   10
         Top             =   720
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Inlet Air Temperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   9
         Top             =   360
         Width           =   2295
      End
   End
End
Attribute VB_Name = "frmPower"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
  frmPower.Hide
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()

  Call CenterThisForm(Me)
  Call LabelsPowerSI

End Sub

Private Sub txtPower_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtPower(Index), Temp_Text)
End Sub

Private Sub txtPower_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtPower_LostFocus(Index As Integer)
    Dim ValueChanged As Integer, Dummy As Double
    Dim msg As String
    Dim CalculatedPower As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtPower(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtPower(Index), Temp_Text)

    If Not IsError Then
       Dummy = CDbl(txtPower(Index).Text)
       Select Case Index
          Case 0    'InletAirTemperature
             Call TextNumberChanged(ValueChanged, txtPower(0), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   scr1.Power.InletAirTemperature = Dummy
                Else
                   txtPower(0).Text = Temp_Text
                   txtPower(0).SetFocus
                   Exit Sub
                End If
             End If
          Case 1    'Blower Efficiency
             Call TextNumberChanged(ValueChanged, txtPower(1), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   scr1.Power.BlowerEfficiency = Dummy
                Else
                   txtPower(1).Text = Temp_Text
                   txtPower(1).SetFocus
                   Exit Sub
                End If
             End If
          Case 3    'Pump Efficiency
             Call TextNumberChanged(ValueChanged, txtPower(3), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   scr1.Power.PumpEfficiency = Dummy
                Else
                   txtPower(3).Text = Temp_Text
                   txtPower(3).SetFocus
                   Exit Sub
                End If
             End If

       End Select

       If ValueChanged Then
          Call CalculatePowerScreen1(CalculatedPower)
          If CalculatedPower Then
             frmPower!txtPower(0).Text = Format$(scr1.Power.InletAirTemperature, "0.0")
             frmPower!txtPower(1).Text = Format$(scr1.Power.BlowerEfficiency, "0.0")
             frmPower!lblPower(2).Caption = Format$(scr1.Power.BlowerBrakePower, "0.000")
             frmPower!txtPower(3).Text = Format$(scr1.Power.PumpEfficiency, "0.0")
             frmPower!lblPower(4).Caption = Format$(scr1.Power.PumpBrakePower, "0.000")
             frmPower!lblPower(5).Caption = Format$(scr1.Power.TotalBrakePower, "0.000")
          End If
       End If

    End If
  Call LostFocus_Handle(Me, txtPower(Index), flag_ok)


End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmPowerScreen2 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Power Calculations"
   ClientHeight    =   5475
   ClientLeft      =   450
   ClientTop       =   2280
   ClientWidth     =   4710
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5475
   ScaleWidth      =   4710
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   492
      Left            =   1740
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   4710
      Width           =   1212
   End
   Begin Threed.SSFrame fraPumpBrakePower 
      Height          =   1215
      Left            =   240
      TabIndex        =   4
      Top             =   2070
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   2138
      _StockProps     =   14
      Caption         =   "Pump Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   3
         Left            =   2520
         TabIndex        =   2
         Top             =   330
         Width           =   1572
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pump Efficiency"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   120
         TabIndex        =   7
         Top             =   330
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pump Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   120
         TabIndex        =   6
         Top             =   690
         Width           =   2295
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2520
         TabIndex        =   5
         Top             =   690
         Width           =   1575
      End
   End
   Begin Threed.SSFrame fraTotalBrakePower 
      Height          =   855
      Left            =   240
      TabIndex        =   8
      Top             =   3540
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   1503
      _StockProps     =   14
      Caption         =   "Total Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Total Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   120
         TabIndex        =   10
         Top             =   360
         Width           =   2295
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   2520
         TabIndex        =   9
         Top             =   360
         Width           =   1575
      End
   End
   Begin Threed.SSFrame fraBlowerBrakePower 
      Height          =   1575
      Left            =   240
      TabIndex        =   11
      Top             =   240
      Width           =   4215
      _Version        =   65536
      _ExtentX        =   7429
      _ExtentY        =   2773
      _StockProps     =   14
      Caption         =   "Blower Brake Power:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   0
         Left            =   2520
         TabIndex        =   0
         Top             =   360
         Width           =   1572
      End
      Begin VB.TextBox txtPower 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   1
         Left            =   2520
         TabIndex        =   1
         Top             =   720
         Width           =   1572
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Inlet Air Temperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   15
         Top             =   360
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Blower Efficiency"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   14
         Top             =   720
         Width           =   2295
      End
      Begin VB.Label lblPowerLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Blower Brake Power"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   13
         Top             =   1080
         Width           =   2295
      End
      Begin VB.Label lblPower 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2520
         TabIndex        =   12
         Top             =   1080
         Width           =   1575
      End
   End
End
Attribute VB_Name = "frmPowerScreen2"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
  frmPowerScreen2.Hide
End Sub

Private Sub Form_Activate()
    frmPowerScreen2.WindowState = 0

    'Position the form on the screen (Centered)
    If WindowState = 0 Then
       'don't attempt if screen Minimized or Maximized
       Move (Screen.Width - frmPowerScreen2.Width) / 2, (Screen.Height - frmPowerScreen2.Height) / 2
    
       If frmPTADScreen1.Visible = True Then Move frmPTADScreen1.Left + (frmPTADScreen1.Width / 2) - (frmPowerScreen2.Width / 2), frmPTADScreen1.Top + (frmPTADScreen1.Height / 2) - (frmPowerScreen2.Height / 2)
       If frmPTADScreen2.Visible = True Then Move frmPTADScreen2.Left + (frmPTADScreen2.Width / 2) - (frmPowerScreen2.Width / 2), frmPTADScreen2.Top + (frmPTADScreen2.Height / 2) - (frmPowerScreen2.Height / 2)
       If frmBubble.Visible = True Then Move frmBubble.Left + (frmBubble.Width / 2) - (frmPowerScreen2.Width / 2), frmBubble.Top + (frmBubble.Height / 2) - (frmPowerScreen2.Height / 2)
       If frmSurface.Visible = True Then Move frmSurface.Left + (frmSurface.Width / 2) - (frmPowerScreen2.Width / 2), frmSurface.Top + (frmSurface.Height / 2) - (frmPowerScreen2.Height / 2)
       
    End If


End Sub

Private Sub Form_Load()

    Call LabelsPowerScreen2SI

End Sub

Private Sub txtPower_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtPower(Index), Temp_Text)
End Sub

Private Sub txtPower_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtPower_LostFocus(Index As Integer)
    Dim ValueChanged As Integer, Dummy As Double
    Dim msg As String
    Dim CalculatedPower As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtPower(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtPower(Index), Temp_Text)

    If Not IsError Then
       Dummy = CDbl(txtPower(Index).Text)
       Select Case Index
          Case 0    'InletAirTemperature
             Call TextNumberChanged(ValueChanged, txtPower(0), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   Scr2.Power.InletAirTemperature = Dummy
                Else
                   txtPower(0).Text = Temp_Text
                   txtPower(0).SetFocus
                   Exit Sub
                End If
             End If
          Case 1    'Blower Efficiency
             Call TextNumberChanged(ValueChanged, txtPower(1), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   Scr2.Power.BlowerEfficiency = Dummy
                Else
                   txtPower(1).Text = Temp_Text
                   txtPower(1).SetFocus
                   Exit Sub
                End If
             End If
          Case 3    'Pump Efficiency
             Call TextNumberChanged(ValueChanged, txtPower(3), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   Scr2.Power.PumpEfficiency = Dummy
                Else
                   txtPower(3).Text = Temp_Text
                   txtPower(3).SetFocus
                   Exit Sub
                End If
             End If

       End Select

       If ValueChanged Then
          Call CalculatePowerScreen2(CalculatedPower)
          If CalculatedPower Then
             frmPowerScreen2!txtPower(0).Text = Format$(Scr2.Power.InletAirTemperature, "0.0")
             frmPowerScreen2!txtPower(1).Text = Format$(Scr2.Power.BlowerEfficiency, "0.0")
             frmPowerScreen2!lblPower(2).Caption = Format$(Scr2.Power.BlowerBrakePower, "0.000")
             frmPowerScreen2!txtPower(3).Text = Format$(Scr2.Power.PumpEfficiency, "0.0")
             frmPowerScreen2!lblPower(4).Caption = Format$(Scr2.Power.PumpBrakePower, "0.000")
             frmPowerScreen2!lblPower(5).Caption = Format$(Scr2.Power.TotalBrakePower, "0.000")
          End If
       End If

    End If
  Call LostFocus_Handle(Me, txtPower(Index), flag_ok)


End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Begin VB.Form frmPTADScreen1 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Packed Tower Aeration - Design Mode"
   ClientHeight    =   6795
   ClientLeft      =   1470
   ClientTop       =   2265
   ClientWidth     =   9480
   Icon            =   "PTADScreen1.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   ScaleHeight     =   6795
   ScaleWidth      =   9480
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   870
      Top             =   5430
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   327681
   End
   Begin VB.CommandButton Command1 
      Appearance      =   0  'Flat
      Caption         =   "Concentration Results"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Left            =   930
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   5910
      Width           =   2655
   End
   Begin Threed.SSFrame fraOperatingConditions 
      Height          =   1455
      Left            =   90
      TabIndex        =   9
      Top             =   120
      Width           =   4335
      _Version        =   65536
      _ExtentX        =   7646
      _ExtentY        =   2561
      _StockProps     =   14
      Caption         =   "Operating Conditions:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton lblDisplayAirWaterProperties 
         Appearance      =   0  'Flat
         Caption         =   "Display Physical Properties of Air and Water"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   990
         Width           =   4095
      End
      Begin VB.TextBox txtOperatingTemperature 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1620
         TabIndex        =   1
         Top             =   630
         Width           =   1215
      End
      Begin VB.TextBox txtOperatingPressure 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1620
         TabIndex        =   0
         Top             =   270
         Width           =   1215
      End
      Begin VB.ComboBox txtPUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   2940
         Style           =   2  'Dropdown List
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   270
         Width           =   1275
      End
      Begin VB.ComboBox txtTUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   2940
         Style           =   2  'Dropdown List
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   630
         Width           =   1275
      End
      Begin VB.Label lblOperatingTemperature 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Temperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   300
         TabIndex        =   20
         Top             =   690
         Width           =   1215
      End
      Begin VB.Label lblOperatingPressure 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pressure"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   300
         TabIndex        =   19
         Top             =   330
         Width           =   1215
      End
   End
   Begin Threed.SSFrame fraPackingInformation 
      Height          =   1215
      Left            =   90
      TabIndex        =   10
      Top             =   1830
      Width           =   4335
      _Version        =   65536
      _ExtentX        =   7646
      _ExtentY        =   2138
      _StockProps     =   14
      Caption         =   "Packing:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdSelectPacking 
         Appearance      =   0  'Flat
         Caption         =   "Select Packing Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   22
         TabStop         =   0   'False
         Top             =   720
         Width           =   4095
      End
      Begin VB.CommandButton cmdPackingType 
         Appearance      =   0  'Flat
         Caption         =   "Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   120
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   360
         Width           =   975
      End
      Begin VB.Label lblPackingType 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   1200
         TabIndex        =   24
         Top             =   360
         Width           =   3015
      End
      Begin VB.Label lblPackingTypeLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   120
         TabIndex        =   23
         Top             =   360
         Width           =   855
      End
   End
   Begin Threed.SSFrame fraContaminantInformation 
      Height          =   1815
      Left            =   90
      TabIndex        =   11
      Top             =   3330
      Width           =   4335
      _Version        =   65536
      _ExtentX        =   7646
      _ExtentY        =   3201
      _StockProps     =   14
      Caption         =   "Design Contaminant:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboSelectCompo 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   240
         Style           =   2  'Dropdown List
         TabIndex        =   29
         TabStop         =   0   'False
         Top             =   480
         Width           =   3855
      End
      Begin VB.CommandButton cmdAddComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Add"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   240
         TabIndex        =   28
         TabStop         =   0   'False
         Top             =   840
         Width           =   1035
      End
      Begin VB.CommandButton cmdDeleteComponent 
         Appearance      =   0  'Flat
         Caption         =   "De&lete"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   1380
         TabIndex        =   27
         TabStop         =   0   'False
         Top             =   840
         Width           =   975
      End
      Begin VB.CommandButton cmdEditComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Edit Properties"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   2460
         TabIndex        =   26
         TabStop         =   0   'False
         Top             =   840
         Width           =   1635
      End
      Begin VB.CommandButton cmdDesignContaminant 
         Appearance      =   0  'Flat
         Caption         =   "Optimize with All Contaminants"
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   25
         TabStop         =   0   'False
         Top             =   1320
         Width           =   4095
      End
      Begin VB.Shape Shape1 
         Height          =   795
         Left            =   120
         Top             =   420
         Width           =   4095
      End
   End
   Begin Threed.SSFrame fraFlowsLoadings 
      Height          =   3135
      Left            =   4410
      TabIndex        =   12
      Top             =   120
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   5530
      _StockProps     =   14
      Caption         =   "Flows and Loadings:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   2220
         TabIndex        =   6
         Top             =   2040
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2220
         TabIndex        =   5
         Top             =   1680
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2220
         TabIndex        =   4
         Top             =   1320
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2220
         TabIndex        =   3
         Top             =   960
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2220
         TabIndex        =   2
         Top             =   240
         Width           =   1215
      End
      Begin VB.ComboBox txtFlowsUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   34
         TabStop         =   0   'False
         Top             =   240
         Width           =   1275
      End
      Begin VB.ComboBox txtFlowsUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   4
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   33
         TabStop         =   0   'False
         Top             =   1680
         Width           =   1275
      End
      Begin VB.ComboBox txtFlowsUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   5
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   32
         TabStop         =   0   'False
         Top             =   2040
         Width           =   1275
      End
      Begin VB.ComboBox lblFlowsUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   6
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   31
         TabStop         =   0   'False
         Top             =   2400
         Width           =   1275
      End
      Begin VB.ComboBox lblFlowsUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   7
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   30
         TabStop         =   0   'False
         Top             =   2760
         Width           =   1275
      End
      Begin VB.Label lblFlowsLoadings 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   285
         Index           =   7
         Left            =   2220
         TabIndex        =   48
         Top             =   2760
         Width           =   1215
      End
      Begin VB.Label lblFlowsLoadings 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   285
         Index           =   6
         Left            =   2220
         TabIndex        =   47
         Top             =   2400
         Width           =   1215
      End
      Begin VB.Label lblFlowsLoadings 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   285
         Index           =   1
         Left            =   2220
         TabIndex        =   46
         Top             =   600
         Width           =   1215
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Water Loading Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   120
         TabIndex        =   45
         Top             =   2820
         Width           =   1995
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Loading Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   120
         TabIndex        =   44
         Top             =   2460
         Width           =   1995
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Pressure Drop"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   120
         TabIndex        =   43
         Top             =   2100
         Width           =   1995
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Flow Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   120
         TabIndex        =   42
         Top             =   1740
         Width           =   1995
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air to Water Ratio"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   120
         TabIndex        =   41
         Top             =   1380
         Width           =   1995
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Multiple of (V/Q)min"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   40
         Top             =   1020
         Width           =   1995
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Min Air to Water Ratio"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   39
         Top             =   660
         Width           =   1995
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Water Flow Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   38
         Top             =   300
         Width           =   1995
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( vol./vol. )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3540
         TabIndex        =   37
         Top             =   660
         Width           =   1275
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( - )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3540
         TabIndex        =   36
         Top             =   1020
         Width           =   1275
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( vol./vol. )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3540
         TabIndex        =   35
         Top             =   1380
         Width           =   1275
      End
   End
   Begin Threed.SSFrame fraMassTransferParamters 
      Height          =   1335
      Left            =   4410
      TabIndex        =   13
      Top             =   3330
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   2355
      _StockProps     =   14
      Caption         =   "Mass Transfer Parameters:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtMassTransfer 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2220
         TabIndex        =   8
         Top             =   960
         Width           =   1215
      End
      Begin VB.TextBox txtMassTransfer 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2220
         TabIndex        =   7
         Top             =   600
         Width           =   1215
      End
      Begin VB.ComboBox UnitsMassTransfer 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   51
         TabStop         =   0   'False
         Top             =   240
         Width           =   1275
      End
      Begin VB.ComboBox UnitsMassTransfer 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   50
         TabStop         =   0   'False
         Top             =   960
         Width           =   1275
      End
      Begin VB.CommandButton cmdMassTransferLabel 
         Appearance      =   0  'Flat
         Caption         =   "Onda KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   120
         TabIndex        =   49
         TabStop         =   0   'False
         Top             =   255
         Width           =   1995
      End
      Begin VB.Label lblMassTransfer 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   285
         Index           =   0
         Left            =   2220
         TabIndex        =   55
         Top             =   240
         Width           =   1215
      End
      Begin VB.Label lblMassTransferLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Design KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   360
         TabIndex        =   54
         Top             =   1020
         Width           =   1755
      End
      Begin VB.Label lblMassTransferLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa Safety Factor"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   360
         TabIndex        =   53
         Top             =   660
         Width           =   1755
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( - )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3540
         TabIndex        =   52
         Top             =   660
         Width           =   1275
      End
   End
   Begin Threed.SSFrame fraTowerParamters 
      Height          =   1545
      Left            =   4410
      TabIndex        =   14
      Top             =   4740
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   2725
      _StockProps     =   14
      Caption         =   "Tower Parameters:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox lblTowerUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   59
         TabStop         =   0   'False
         Top             =   270
         Width           =   1275
      End
      Begin VB.ComboBox lblTowerUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   58
         TabStop         =   0   'False
         Top             =   570
         Width           =   1275
      End
      Begin VB.ComboBox lblTowerUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   57
         TabStop         =   0   'False
         Top             =   870
         Width           =   1275
      End
      Begin VB.ComboBox lblTowerUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3540
         Style           =   2  'Dropdown List
         TabIndex        =   56
         TabStop         =   0   'False
         Top             =   1170
         Width           =   1275
      End
      Begin VB.Label lblTowerParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   255
         Index           =   3
         Left            =   2220
         TabIndex        =   67
         Top             =   1170
         Width           =   1215
      End
      Begin VB.Label lblTowerParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   255
         Index           =   2
         Left            =   2220
         TabIndex        =   66
         Top             =   870
         Width           =   1215
      End
      Begin VB.Label lblTowerParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   255
         Index           =   1
         Left            =   2220
         TabIndex        =   65
         Top             =   570
         Width           =   1215
      End
      Begin VB.Label lblTowerParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   255
         Index           =   0
         Left            =   2220
         TabIndex        =   64
         Top             =   270
         Width           =   1215
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Volume"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   480
         TabIndex        =   63
         Top             =   1170
         Width           =   1635
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Height"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   480
         TabIndex        =   62
         Top             =   870
         Width           =   1635
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Diameter"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   480
         TabIndex        =   61
         Top             =   570
         Width           =   1635
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Area"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   480
         TabIndex        =   60
         Top             =   270
         Width           =   1635
      End
   End
   Begin Threed.SSFrame xFrame3D1 
      Height          =   1875
      Left            =   9000
      TabIndex        =   68
      Top             =   6270
      Visible         =   0   'False
      Width           =   4335
      _Version        =   65536
      _ExtentX        =   7646
      _ExtentY        =   3307
      _StockProps     =   14
      Caption         =   "Still Needed until labels are de-linked!"
      ForeColor       =   255
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label xlblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Influent Concentration"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   180
         TabIndex        =   75
         Top             =   270
         Width           =   2535
      End
      Begin VB.Label xlblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Treatment Objective"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   180
         TabIndex        =   74
         Top             =   570
         Width           =   2535
      End
      Begin VB.Label xlblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Percent Removal"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   180
         TabIndex        =   73
         Top             =   870
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2940
         TabIndex        =   72
         Top             =   270
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2940
         TabIndex        =   71
         Top             =   570
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2940
         TabIndex        =   70
         Top             =   870
         Width           =   1095
      End
      Begin VB.Label lblMassTransferLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Onda KLa"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   660
         TabIndex        =   69
         Top             =   1290
         Visible         =   0   'False
         Width           =   1755
      End
   End
   Begin VB.Menu mnuFileMenu 
      Caption         =   "&File"
      Begin VB.Menu mnuFile 
         Caption         =   "Switch to &Rating Mode"
         Index           =   0
         Shortcut        =   ^R
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Open"
         Index           =   3
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Save"
         Index           =   4
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Save &As"
         Index           =   5
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   6
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Print"
         Index           =   7
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &Printer"
            Index           =   0
         End
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &File"
            Index           =   1
         End
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Select Printer"
         Index           =   8
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   9
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Return to &Main Menu"
         Index           =   10
         Shortcut        =   ^M
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   11
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&1 Old File #1"
         Index           =   191
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&2 Old File #2"
         Index           =   192
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&3 Old File #3"
         Index           =   193
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&4 Old File #4"
         Index           =   194
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   199
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&xit"
         Index           =   200
      End
   End
   Begin VB.Menu mnuUnitsMenu 
      Caption         =   "&Units"
      Begin VB.Menu mnuUnits 
         Caption         =   "Standard International (SI)"
         Index           =   0
      End
      Begin VB.Menu mnuUnits 
         Caption         =   "English"
         Index           =   1
      End
   End
   Begin VB.Menu mnuPowerMenu 
      Caption         =   "&Power"
      Begin VB.Menu mnuPower 
         Caption         =   "&Perform Power Calculations"
         Index           =   0
      End
   End
   Begin VB.Menu mnuOptionsMenu 
      Caption         =   "&Results"
      Begin VB.Menu mnuOptions 
         Caption         =   "&View All Concentration Results"
         Index           =   0
      End
      Begin VB.Menu mnuOptions 
         Caption         =   "View &Mass Transfer Parameters"
         Index           =   5
      End
   End
   Begin VB.Menu mnuHelp 
      Caption         =   "&Help"
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&Online Help ..."
         Index           =   300
      End
   End
End
Attribute VB_Name = "frmPTADScreen1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim Temp_Text As String
Dim frmPTADScreen1_Okay_To_Unload As Boolean




Const frmPTADScreen1_declarations_end = True


Private Sub AddPrompt(menuID As Integer, prompt As String)
    menuPrompts(iMenuPrompts).menuID = menuID
    menuPrompts(iMenuPrompts).prompt = prompt
    iMenuPrompts = iMenuPrompts + 1
End Sub

Private Sub cboDesignContaminant_Click()
    
End Sub

Private Sub cboDesignContaminant_GotFocus()
'    Temp_Text = cboDesignContaminant.Text
End Sub

Private Sub cboDesignContaminant_KeyPress(KeyAscii As Integer)
    'Dim i As Integer
    'Dim ComboText As String
    '
    'If KeyAscii <> 13 Then Exit Sub
    'KeyAscii = 0

End Sub

Private Sub cboDesignContaminant_LostFocus()
    'Dim KeyAscii As Integer
    '
    'KeyAscii = 13
    'cboDesignContaminant_KeyPress (KeyAscii)
End Sub

Private Sub cboSelectCompo_Click()
    Dim ContaminantIndex As Integer, i As Integer
    Dim PercentRemoval As Double
    
    ContaminantIndex = cboSelectCompo.ListIndex + 1
    i = ContaminantIndex
    If i = 0 Then Exit Sub
    lblDesignConcentrationValue(0).Caption = Format$(scr1.Contaminant(i).Influent.Value, GetTheFormat(scr1.Contaminant(i).Influent.Value))
    lblDesignConcentrationValue(1).Caption = Format$(scr1.Contaminant(i).TreatmentObjective.Value, GetTheFormat(scr1.Contaminant(i).TreatmentObjective.Value))
    Call REMOVPT(PercentRemoval, scr1.Contaminant(i).Influent.Value, scr1.Contaminant(i).TreatmentObjective.Value)
    lblDesignConcentrationValue(2).Caption = Format$(PercentRemoval, "0.0")
    Call PT1VQMIN(scr1.MinimumAirToWaterRatio.Value, scr1.Contaminant(i).Influent.Value, scr1.Contaminant(i).TreatmentObjective.Value, scr1.Contaminant(i).HenrysConstant.Value)
    lblFlowsLoadings(1).Caption = Format$(scr1.MinimumAirToWaterRatio.Value, GetTheFormat(scr1.MinimumAirToWaterRatio.Value))
    
    scr1.DesignContaminant = scr1.Contaminant(i)
    
    'Update Variables on Screen
    Call GetVQmultVQAndAirFlowRate
    Call GetLoadings
    Call GetTowerAreaAndDiameter
    Call GetOndaMassTransferCoefficient
    Call GetDesignKLaOrKLaSafetyFactor
    Call GetTowerHeightAndVolume

End Sub

Private Sub cmdAddComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer

  If (scr1.NumChemical + 1 > MAXCHEMICAL) Then
     MsgBox "The maximum number of contaminants has been reached.  It is not possible to input more than " & Format$(MAXCHEMICAL, "0") & " contaminants for design.  To add an additional contaminant, another must first be removed.", MB_ICONSTOP, "Packed Tower Aeration"
     cmdAddComponent.Enabled = False
     Exit Sub
  End If

  x.ModelName = "Packed Tower Aeration"
  x.ModelType = MODELTYPE_PACKEDTOWER
  x.DoEditNumber = -1       'Will be set by frmContaminantPropertyEdit.
  x.DoAdd = True
  x.OldNumCompo = cboSelectCompo.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i) = scr1.Contaminant(i)
  Next i

  StEPPImportSuccess = False
  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (StEPPImportSuccess) Or (Not x.CancelledAdd) Then
    For i = x.OldNumCompo + 1 To x.NewNumCompo
      'Incorporate new contaminant.
      If i > 10 Then
       MsgBox "Unable to continue importing file as maximum amount of chemicals in memory reached."
       Me.Show
       Exit Sub
      End If

      scr1.Contaminant(i) = x.Contaminants(i)
      scr1.NumChemical = scr1.NumChemical + 1
      'Incorporate new name into ComboBox.
      cboSelectCompo.AddItem scr1.Contaminant(i).Name
    Next i
  End If
  
  Call SetDesignContaminantEnabled(CInt(cboSelectCompo.ListCount))
  
  If (scr1.NumChemical > 0) Then
    cmdDeleteComponent.Enabled = True
    cmdEditComponent.Enabled = True
    If (cboSelectCompo.ListIndex = -1) Then
      cboSelectCompo.ListIndex = 0
    End If
  End If
 Me.Show
End Sub

Private Sub cmdDeleteComponent_Click()
  Dim i As Integer

  scr1.Chemical = cboSelectCompo.ListIndex + 1
  If (scr1.Chemical = 0) Then Exit Sub

  If MsgBox("Remove" & NL & cboSelectCompo.List(cboSelectCompo.ListIndex), 36, "") = IDYES Then
    cboSelectCompo.RemoveItem cboSelectCompo.ListIndex
    For i = scr1.Chemical To scr1.NumChemical - 1
      scr1.Contaminant(i) = scr1.Contaminant(i + 1)
    Next i
    scr1.NumChemical = scr1.NumChemical - 1
    If (scr1.NumChemical > 0) Then
      cboSelectCompo.ListIndex = 0
    Else
      cmdDeleteComponent.Enabled = False
      cmdEditComponent.Enabled = False
    End If
    Call SetDesignContaminantEnabled(CInt(cboSelectCompo.ListCount))
  End If

    If scr1.NumChemical < 10 Then cmdAddComponent.Enabled = True
End Sub

Private Sub cmdDesignContaminant_Click()
    Call OptimizeDesignContaminant
End Sub

Private Sub cmdEditComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer
Dim AListIndex As Integer

  scr1.Chemical = cboSelectCompo.ListIndex + 1
  If (scr1.Chemical = 0) Then Exit Sub

  x.ModelName = "Packed Tower Aeration"
  x.ModelType = MODELTYPE_PACKEDTOWER
  x.DoEditNumber = cboSelectCompo.ListIndex + 1
  x.DoAdd = False
  x.OldNumCompo = cboSelectCompo.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i) = scr1.Contaminant(i)
  Next i

  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (Not x.CancelledEdit) Then
    For i = 1 To x.NewNumCompo
      scr1.Contaminant(i) = x.Contaminants(i)
    Next i
    If (x.OldNumCompo < x.NewNumCompo) Then
      'Incorporate new names into ComboBox.
      For i = x.OldNumCompo + 1 To x.NewNumCompo
        cboSelectCompo.AddItem scr1.Contaminant(i).Name
      Next i
    End If
    'Update ComboBox for any changed names:
    For i = 1 To x.OldNumCompo
      If (Trim$(cboSelectCompo.List(i - 1)) <> Trim$(scr1.Contaminant(i).Name)) Then
        cboSelectCompo.List(i - 1) = Trim$(scr1.Contaminant(i).Name)
      End If
    Next i
  Else
    Exit Sub
  End If

  'Generate click event on cboSelectCompo
  AListIndex = cboSelectCompo.ListIndex
  cboSelectCompo.ListIndex = -1
  cboSelectCompo.ListIndex = AListIndex

End Sub

Private Sub cmdMassTransferLabel_Click()

    If frmPTADScreen1.lblMassTransfer(0).Caption = "0.0" Then Exit Sub
    frmShowOndaKLaProperties.Show 1

End Sub

Private Sub cmdPackingType_Click()

  ScreenNumber = 1
  CurrentScreen = scr1
  Call ShowPackingProperties

End Sub

Private Sub cmdSelectContaminants_Click()

    'frmListContaminant.Show 1

End Sub

Private Sub cmdSelectPacking_Click()
    Dim i As Integer, CurrPackingIndex As Integer
    
    ReadMainPackingDB
    ReadUserPackingDB

    PackingDatabaseSource = scr1.Packing.SourceDatabase

    If scr1.Packing.Name = "" Then
       scr1.Packing.Name = frmSelectPacking.cboSelectPacking.List(0)
       PackingChanged = True
    End If

    If PackingDatabaseSource = ORIGINALPACKINGDATABASE Then
       For i = 1 To NumPackingsInDatabase
           If DatabasePacking(i).Name = scr1.Packing.Name Then
              CurrPackingIndex = i
              frmSelectPacking!cboSelectPacking.ListIndex = CurrPackingIndex - 1
              Exit For
           End If
       Next i
    ElseIf PackingDatabaseSource = USERMODIFIEDPACKINGDATABASE Then
       For i = 1 To NumUserPackings
           If UserPacking(i).Name = scr1.Packing.Name Then
              CurrPackingIndex = i
              frmSelectPacking.cboSelectPacking.ListIndex = CurrPackingIndex - 1
              Exit For
           End If
       Next i

    End If
    ScreenNumber = 1
    CurrentScreen = scr1
    frmSelectPacking.Show 1
    
    'Reflect changes in packing into Scr1
    scr1 = CurrentScreen

    If scr1.NumChemical > 0 Then
       'Update Variables on Screen
       Call GetVQmultVQAndAirFlowRate
       Call GetLoadings
       Call GetTowerAreaAndDiameter
       Call GetOndaMassTransferCoefficient
       Call GetDesignKLaOrKLaSafetyFactor
       Call GetTowerHeightAndVolume
    End If

End Sub

Private Sub Command1_Click()

Call screen1_results
 

End Sub

Private Sub Form_Activate()
'    Dim hMenu       As Integer
'    Dim hSubMenu    As Integer
'
''Initialize MsgHook and Load Menu Prompts to Display on Status Bar
'    imenuprompts = 0
'
'    MsgHook1.HwndHook = Me.hWnd
'    MsgHook1.Message(WM_MENUSELECT) = True
'    hMenu = GetMenu(Me.hWnd)
'    '
'    ' Load File menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 0)
'    AddPrompt hSubMenu, "File operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Switch to Rating Mode for packed tower aeration"
'    AddPrompt GetMenuItemID(hSubMenu, 2), "Load a design case from a file"
'    AddPrompt GetMenuItemID(hSubMenu, 3), "Save this design case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 4), "Save this design case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 6), "Print this design case"
'    AddPrompt GetMenuItemID(hSubMenu, 7), "Select a printer for printing results"
'    AddPrompt GetMenuItemID(hSubMenu, 9), "Leave packed tower aeration and return to main ASAP menu"
'    AddPrompt GetMenuItemID(hSubMenu, 11), "Exit program"
'
'    '
'    ' Load Units menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 1)
'    AddPrompt hSubMenu, "Units operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Display results in Standard International (SI) units"
'    AddPrompt GetMenuItemID(hSubMenu, 1), "Display results in English units"
'    '
'    ' Load Power menu prompt
'    '
'    hSubMenu = GetSubMenu(hMenu, 2)
'    AddPrompt hSubMenu, "Power operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Perform power calculations"
'    '
'    ' Load Options menu prompt
'    '
'    hSubMenu = GetSubMenu(hMenu, 3)
'    AddPrompt hSubMenu, "Options"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "View Effluent Concentration Results for All Contaminants"

    'Initialize last-few-files list.
    Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ASAP, LASTFEW_ASAP_frmPTADScreen1)

End Sub

Private Sub Form_Load()
    Dim i As Integer
    
  frmPTADScreen1_Okay_To_Unload = False

scr1.NumChemical = 0
frmPTADScreen1.Width = SCREEN_WIDTH_STANDARD
frmPTADScreen1.Height = SCREEN_HEIGHT_STANDARD
    
    'Center the form on the screen
    If WindowState = 0 Then
       'don't attempt if screen Minimized or Maximized
       Move (Screen.Width - frmPTADScreen1.Width) / 2, (Screen.Height - frmPTADScreen1.Height) / 2
    End If
    
    'Initialize Labels on frmPTADScreen1
    Call LabelsPTADScreen1(UNITSTYPE_SI)

    'Initialize Values for Pressure and Temperature
    Call InitializePressureTemperature

    'Initialize values for water density, water viscosity,
    'water surface tension, air density, and air viscosity
    'based on default temperature and pressure
    Call CalculateAirWaterProperties

    'Initialize design packing to a default
    Call InitializePacking
    
    'Initialize value for Water Flow Rate
    Call InitializeWaterFlowRate

    'Initialize value for Multiple of Minimum Air to Water Ratio
    Call InitializeVQminMultiple

    'Initialize Value for Air Pressure Drop
    Call InitializeAirPressureDrop

    'Initialize Value for KLaSafetyFactor
    Call InitializeKLaSafetyFactor

    'Initialize calculated properties text boxes to 0 and disabled
    Call InitializeCalculatedProperties

    Load frmAirWaterProperties
    Load frmShowPackingProperties
    'Load frmListContaminant

End Sub
Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  If (frmPTADScreen1_Okay_To_Unload) Then
    Cancel = False
  Else
    Cancel = True
  End If
End Sub


Private Sub lblDisplayAirWaterProperties_Click()
    If HaveValue(scr1.OperatingPressure.Value) And HaveValue(scr1.operatingtemperature.Value) Then
       CurrentScreen = scr1
       CurrentMode = 1
       frmAirWaterProperties.Show 1
    Else
       MsgBox "You must specify pressure and temperature before physical properties can be displayed.", MB_ICONSTOP, "Error"
    End If
End Sub

Private Sub lblFlowsLoadings_Change(Index As Integer)

  If (Index = 6) Or (Index = 7) Then
    Call lblFlowsUnits_Click(Index)
  End If

End Sub

Private Sub lblFlowsUnits_Click(Index As Integer)

  Select Case Index
    Case 6        'Air Loading Rate
      Call Unitted_UnitChange(UNITS_MASSLOADINGRATE, scr1.AirLoadingRate.Value, lblFlowsUnits(6), lblFlowsLoadings(6))

    Case 7        'Water Loading Rate
      Call Unitted_UnitChange(UNITS_MASSLOADINGRATE, scr1.WaterLoadingRate.Value, lblFlowsUnits(7), lblFlowsLoadings(7))
  End Select

End Sub

Private Sub lblFlowsUnits_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub lblMassTransfer_Change(Index As Integer)

  Call UnitsMassTransfer_Click(0)

End Sub

Private Sub lblPackingType_Click()

  Call cmdPackingType_Click
  
  End Sub

Private Sub lblTowerParameters_Change(Index As Integer)

  Call lblTowerUnits_Click(Index)

End Sub

Private Sub lblTowerUnits_Click(Index As Integer)

  Select Case Index
    Case 0        'Tower Area
      Call Unitted_UnitChange(UNITS_AREA, scr1.TowerArea.Value, lblTowerUnits(0), lblTowerParameters(0))
    
    Case 1        'Tower Diameter
      Call Unitted_UnitChange(UNITS_LENGTH, scr1.TowerDiameter.Value, lblTowerUnits(1), lblTowerParameters(1))
    
    Case 2        'Tower Height
      Call Unitted_UnitChange(UNITS_LENGTH, scr1.TowerHeight.Value, lblTowerUnits(2), lblTowerParameters(2))
    
    Case 3        'Tower Volume
      Call Unitted_UnitChange(UNITS_VOLUME, scr1.TowerVolume.Value, lblTowerUnits(3), lblTowerParameters(3))
    
  End Select

End Sub

Private Sub lblTowerUnits_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub mnuFile_Click(Index As Integer)
    Dim i As Integer
    Dim msg As String, response As Integer

    Screen.MousePointer = 11   'Hourglass

    Select Case Index
       Case 0   'Switch to Rating Mode

          If frmPTADScreen1!lblTowerParameters(3).Caption = "0.0" Then
             Filename$ = "TheDefaultCaseScreen2"
             Call loadscreen2("")
             frmPTADScreen1.Hide
             frmPTADScreen2.Show
             Screen.MousePointer = 0
             Exit Sub
          End If

          If HaveValue(scr1.TowerVolume.Value) Then
             'Give user option to save screen 1 before
             'switching to screen 2
             msg = "Would you like to save the parameters "
             msg = msg + "for this design case to a file "
             msg = msg + "before switching to Rating "
             msg = msg + "Mode?"
             response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "Save Current Design")
             If response = IDYES Then
                Call SaveScreen1
             End If

             'Initialize Values on Screen 2:

             'First, switch back to SI units so we can do a direct copy of the textboxes from this screen to that screen.
             Call LabelsPTADScreen1(UNITSTYPE_SI)
             
             'Design Tower Diameter
             frmPTADScreen2!lblDesignParameters(0).Caption = frmPTADScreen1!lblTowerParameters(1).Caption
             Scr2.TowerDiameter = scr1.TowerDiameter

             'Design Tower Height
             frmPTADScreen2!lblDesignParameters(1).Caption = frmPTADScreen1!lblTowerParameters(2).Caption
             Scr2.TowerHeight = scr1.TowerHeight
       
             'UserSpecified Tower Diameter and Tower Height
             Scr2.SpecifiedTowerDiameter.Value = scr1.TowerDiameter.Value
             Scr2.SpecifiedTowerHeight.Value = scr1.TowerHeight.Value
             frmPTADScreen2!txtTowerParameters(0).Text = frmPTADScreen2!lblDesignParameters(0).Caption
             frmPTADScreen2!txtTowerParameters(1).Text = frmPTADScreen2!lblDesignParameters(1).Caption

             'Calculate Tower Area and Volume with specified tower
             'diameter and tower height
             Call GetTowerAreaAndVolume
             frmPTADScreen2!lblTowerParameters(2).Caption = Format$(Scr2.TowerArea.Value, GetTheFormat(Scr2.TowerArea.Value))
             frmPTADScreen2!lblTowerParameters(3).Caption = Format$(Scr2.TowerVolume.Value, GetTheFormat(Scr2.TowerVolume.Value))

             'Flow and Loading Parameters
             frmPTADScreen2!txtFlowsLoadings(0).Text = frmPTADScreen1!txtFlowsLoadings(0).Text
             frmPTADScreen2!txtFlowsLoadings(0).Enabled = True
             Scr2.WaterFlowRate = scr1.WaterFlowRate
             Scr2.WaterFlowRate.UserInput = True
             If scr1.AirFlowRate.UserInput = True Then
                'Water Flow Rate and air flow rate are initial
                'two flow and loading values that are user input
                'on screen 2
                frmPTADScreen2!txtFlowsLoadings(1).Text = frmPTADScreen1!txtFlowsLoadings(4).Text
                frmPTADScreen2!txtFlowsLoadings(1).Enabled = True
                Scr2.AirFlowRate = scr1.AirFlowRate
                Scr2.AirFlowRate.UserInput = True
                For i = 2 To 4
                    frmPTADScreen2!txtFlowsLoadings(i).Enabled = False
                    frmPTADScreen2!txtFlowsLoadings(i).Text = ""
                Next i
                Scr2.AirToWaterRatio.UserInput = False
                Scr2.AirLoadingRate.UserInput = False
                Scr2.WaterLoadingRate.UserInput = False
                frmFlowsLoadingsScreen2!optFlowsLoadings(0).Value = True
                UsersFlowsLoadingsOption = 0
             Else
                'Water flow rate and air to water ratio are
                'initial two flow and loading values that are
                'user-input on screen 2
                frmPTADScreen2!txtFlowsLoadings(2).Text = frmPTADScreen1!txtFlowsLoadings(3).Text
                frmPTADScreen2!txtFlowsLoadings(2).Enabled = True
                Scr2.AirToWaterRatio = scr1.AirToWaterRatio
                Scr2.AirToWaterRatio.UserInput = True
                For i = 1 To 4
                    If i <> 2 Then
                       frmPTADScreen2!txtFlowsLoadings(i).Enabled = False
                       frmPTADScreen2!txtFlowsLoadings(i).Text = ""
                    End If
                Next i
                Scr2.AirFlowRate.UserInput = False
                Scr2.AirLoadingRate.UserInput = False
                Scr2.WaterLoadingRate.UserInput = False
                frmFlowsLoadingsScreen2!optFlowsLoadings(1).Value = True
                UsersFlowsLoadingsOption = 1
             End If
       

             'Pressure and Temperature
             frmPTADScreen2!txtOperatingPressure.Text = frmPTADScreen1!txtOperatingPressure.Text
             Scr2.OperatingPressure = scr1.OperatingPressure
             Scr2.OperatingPressure.ValChanged = True
             frmPTADScreen2!txtOperatingTemperature.Text = frmPTADScreen1!txtOperatingTemperature.Text
             Scr2.operatingtemperature = scr1.operatingtemperature
             Scr2.operatingtemperature.ValChanged = True

             'Physical Properties
             Call CalculateAirWaterPropertiesScreen2

             'Packing
             frmPTADScreen2!lblPackingType.Caption = frmPTADScreen1!lblPackingType.Caption
             Scr2.Packing = scr1.Packing

             'Contaminant List
             Scr2.NumChemical = scr1.NumChemical
             frmPTADScreen2!cboSelectCompo.Clear
             'frmListcontaminantScreen2!ListContaminants.Clear
             If Scr2.NumChemical > 0 Then
                For i = 1 To Scr2.NumChemical
                    Scr2.Contaminant(i) = scr1.Contaminant(i)
                    frmPTADScreen2!cboSelectCompo.AddItem Scr2.Contaminant(i).Name
                    'frmListcontaminantScreen2!ListContaminants.AddItem Scr2.Contaminant(i).Name
                Next i


                'frmListcontaminantScreen2!mnuOptionsManipulateContaminant(1).Enabled = True
                'frmListcontaminantScreen2!mnuOptionsManipulateContaminant(3).Enabled = True
                'frmListcontaminantScreen2!mnuOptionsManipulateContaminant(4).Enabled = True
                'frmListcontaminantScreen2!mnuOptionsSave.Enabled = True
                'frmListcontaminantScreen2!mnuOptionsView.Enabled = True

                Call SetDesignContaminantEnabledScreen2(Scr2.NumChemical)
             End If

             'Calculated Flows and Loadings
             Call GetFlowsAndLoadingsScreen2

             'KLaSafetyFactor
             Scr2.KLaSafetyFactor.Value = scr1.KLaSafetyFactor.Value
             Scr2.KLaSafetyFactor.UserInput = True
             frmPTADScreen2!txtDesignConcentrationValue(1).Text = Format$(Scr2.KLaSafetyFactor.Value, GetTheFormat(Scr2.KLaSafetyFactor.Value))

             'Calculate properties of the contaminant in the
             'combo box now.

             Scr2.DesignContaminant = scr1.DesignContaminant
             frmPTADScreen2!cboSelectCompo.ListIndex = frmPTADScreen1!cboSelectCompo.ListIndex
             frmPTADScreen2.Caption = "Packed Tower Aeration - Rating Mode (untitled.rat)"

             frmPTADScreen1.Hide
             ShownScreen1Previously = True
             frmPTADScreen2.Show
       
          Else
             frmPTADScreen1.Hide
             frmPTADScreen2.Show
             Filename = "TheDefaultCaseScreen2"
             Call StartScreen2DefaultCase
          End If

       Case 2   'New

       Case 3   'Open
          If HaveValue(scr1.TowerVolume.Value) Then
             If (screen1_savechanges()) Then Exit Sub
          End If

          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          Call loadscreen1("")
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)
          
          SaveAndLoadPath = CurDir$
          ''''ChDir App.Path
          ''''ChDrive App.Path
          Call ChangeDir_Main

       Case 4   'Save
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          Call SaveScreen1
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)
          
          SaveAndLoadPath = CurDir$
          ''''ChDir App.Path
          ''''ChDrive App.Path
          Call ChangeDir_Main

       Case 5   'Save As
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          If Right$(frmPTADScreen1.Caption, 14) <> "(untitled.des)" Then
            Call savefilescreen1(Filename)
          End If
          Call SaveScreen1
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)
          
          SaveAndLoadPath = CurDir$
          ''''ChDir App.Path
          ''''ChDrive App.Path
          Call ChangeDir_Main

       Case 7   'Print
          
          
       Case 8   'Select Printer
            On Error GoTo PrinterError
            CommonDialog1.ShowPrinter
            'CMDialog1.flags = PD_PRINTSETUP
            'CMDialog1.Action = 5
            GoTo ExitSelectPrint
PrinterError:
            Resume ExitSelectPrint:

ExitSelectPrint:

        Case 10   'Return To Main Menu
            If HaveValue(scr1.TowerVolume.Value) Then
               If (screen1_savechanges()) Then Exit Sub
            End If

            'unload Forms for Packed Tower Aeration
            Unload frmAirWaterProperties
            'Unload frmListContaminant
            'Unload frmPropContaminant
            ''''Unload HelpTipForm
            Unload frmShowOndaKLaProperties
            Unload frmSelectPacking
            Unload frmShowPackingProperties
            Unload frmPower
            Unload frmPowerScreen2
            Unload frmFlowsLoadingsScreen2
            'Unload frmListcontaminantScreen2
            'Unload frmPropContaminantScreen2
            Unload frmOptimizeContaminant
            Unload frmPTADScreen1
            Unload frmPTADScreen2
            
            frmMainMenu.Show
        

        Case 200   'Exit
            'Give user option to save design mode before Exiting
            If HaveValue(scr1.TowerVolume.Value) Then
               If (screen1_savechanges()) Then Exit Sub
            End If
                
            
            'unload Forms for Packed Tower Aeration
            Unload frmAirWaterProperties
            'Unload frmListContaminant
            'Unload frmPropContaminant
            ''''Unload HelpTipForm
            Unload frmShowOndaKLaProperties
            Unload frmSelectPacking
            Unload frmShowPackingProperties
            Unload frmPower
            Unload frmPowerScreen2
            Unload frmFlowsLoadingsScreen2
            'Unload frmListcontaminantScreen2
            'Unload frmPropContaminantScreen2
            Unload frmOptimizeContaminant
            Unload frmPTADScreen1
            Unload frmPTADScreen2
            frmPTADScreen1_Okay_To_Unload = True
            Unload frmMainMenu
            End
            
    End Select
    
    If ((Index >= 191) And (Index <= 194)) Then
      'Handle File|Open of a file here.
      On Error GoTo notfound
      ''''ChDrive SaveAndLoadPath
      ''''ChDir SaveAndLoadPath
      Call ChangeDir_Main
      If (Dir(Current_LastFewFilesRec.FileNames(Index - 190)) = "") Then
        Beep
        MsgBox "That file has been moved or deleted.", MB_ICONEXCLAMATION, Application_Name
      Else
        Call loadscreen1(Current_LastFewFilesRec.FileNames(Index - 190))
        'Add this file to the last-few-files list if necessary.
        Call LastFewFiles_MoveFilenameToTop(Filename)
        SaveAndLoadPath = CurDir$
      End If
      ''''ChDir App.Path
      ''''ChDrive App.Path
      Call ChangeDir_Main
    End If

    
    Screen.MousePointer = 0   'Arrow
Exit Sub

notfound:
MsgBox "The file was not found"
Resume Next

End Sub

Private Sub mnuFilePrint_Click(Index As Integer)
    
    Select Case Index
       Case 0   'Print to printer
          Call PrintPTADScreen1
       Case 1   'Print to file
          Call PrintPTADScreen1ToFile
    End Select

End Sub

Private Sub mnuHelpItem_Click(Index As Integer)
  Select Case Index
    'Case 10:
    '  frmabout2.Show 1
    'Case 99:
    '  frmAbout.Show 1
    Case 300:
      Call Launch_ASAP_HLP_File
  End Select
End Sub


Private Sub mnuOptions_Click(Index As Integer)

          
Select Case Index
  Case 0: Call screen1_results

  Case 5: '----- View Mass Transfer Parameters
    Call cmdMassTransferLabel_Click

End Select


End Sub

Private Sub mnuotheritem_Click()
'frmabout2.Show 1
End Sub

Private Sub mnuPopContaminant_Click(Index As Integer)
    'If Index = 1 Then
    '   frmListContaminant.Show 1
    'End If
End Sub

Private Sub mnuPower_Click(Index As Integer)
    Dim CalculatedPower As Integer

    Select Case Index   'Power Calculation

       Case 0
          Call SetPowerPTADScreen1(CalculatedPower)
          If CalculatedPower Then
             frmPower.Left = Screen.Width / 2 - frmPower.Width / 2
             frmPower.Top = Screen.Height / 2 - frmPower.Height / 2
             frmPower.Show 1
          End If
    End Select
End Sub

Private Sub mnuUnits_Click(Index As Integer)

  Select Case Index
    Case 0        'SI
      Call LabelsPTADScreen1(UNITSTYPE_SI)
    Case 1        'English
      Call LabelsPTADScreen1(UNITSTYPE_ENGLISH)
  End Select

End Sub

Private Sub MsgHook1_Message(msg As Integer, wParam As Integer, lParam As Long, Action As Integer, result As Long)
'    Dim i       As Integer
'    Dim found   As Integer
'
'    '
'    ' Got a menu select message ... see if it's for one of our menus
'    '
'    For i = 0 To iMenuPrompts - 1
'        If (menuPrompts(i).menuID = wParam) Then
'            '
'            ' One of our menus ... display prompt message
'            '
'            StatusMessagePanel.Caption = menuPrompts(i).prompt
'            found = True
'            Exit For
'        End If
'    Next
'    '
'    ' Blank prompt message when no menu selected
'    '
'    If (found <> True) Then
'        StatusMessagePanel.Caption = ""
'    End If
'
End Sub

Private Sub Old_HelpTipTimer_Timer()
'temp kill
Exit Sub
'''''''''''''
Dim PointStruct As PointType
 Static PrevioushWnd%
 Dim CurrenthWnd As Integer, TipText As String

If GetActiveWindow() = Me.hWnd Then
  Call GetCursorPos(PointStruct)
  CurrenthWnd% = WindowFromPoint(PointStruct.Y, PointStruct.x)
  If CurrenthWnd <> PrevioushWnd% Then
    PrevioushWnd% = CurrenthWnd
    'HelpTipTimer.Interval = 1
    'Select Case CurrenthWnd%
    '  Case txtOperatingPressure.hWnd    '<---- Here for the text box txtOperatingPressure
    '   StatusMessagePanel.Caption = " Input Operating " & lblOperatingPressure.Caption
    '  Case txtOperatingTemperature.hWnd   '<---- Here for the text box txtOperatingTemperature
    '   StatusMessagePanel.Caption = " Input Operating " & lblOperatingTemperature.Caption
    '  Case lblDisplayAirWaterProperties.hWnd
    '   StatusMessagePanel.Caption = " Specify water density, viscosity, and surface tension; and air density and viscosity"
    'End Select
    ShowHelpTip TipText$
    If Len(TipText$) = 0 Then
      'HelpTipTimer.Interval = 500 'Milliseconds
    End If
  End If
End If

End Sub

Private Sub txtFlowsLoadings_Change(Index As Integer)

'  If (Index = 0) Or (Index = 4) Or (Index = 5) Then
'    Call txtFlowsUnits_Click(Index)
'  End If

End Sub

Private Sub txtFlowsLoadings_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtFlowsLoadings(Index), Temp_Text)

End Sub

Private Sub txtFlowsLoadings_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtFlowsLoadings_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtFlowsLoadings(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

  IsNew = False
  
  Select Case Index
    Case 0        'Water Flow Rate.
      If (Unitted_LostFocus(UNITS_FLOW, txtFlowsLoadings(0), txtFlowsUnits(0), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.WaterFlowRate.ValChanged = True
        scr1.WaterFlowRate.UserInput = True
        scr1.WaterFlowRate.Value = NewVal
      End If

    Case 2        'Multiple of Minimum Air To Water Ratio
      If (NoUnits_LostFocus(txtFlowsLoadings(2), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.MultipleOfMinimumAirToWaterRatio.Value = NewVal
        scr1.MultipleOfMinimumAirToWaterRatio.ValChanged = True
        scr1.MultipleOfMinimumAirToWaterRatio.UserInput = True
        Call SpecifiedVQminMultiple
      End If
      
    Case 3        'Air To Water Ratio
      If (NoUnits_LostFocus(txtFlowsLoadings(3), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.AirToWaterRatio.Value = NewVal
        scr1.AirToWaterRatio.ValChanged = True
        scr1.AirToWaterRatio.UserInput = True
        Call SpecifiedAirToWaterRatio
      End If
        
    Case 4        'Air Flow Rate
      If (Unitted_LostFocus(UNITS_FLOW, txtFlowsLoadings(4), txtFlowsUnits(4), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.AirFlowRate.Value = NewVal
        scr1.AirFlowRate.ValChanged = True
        scr1.AirFlowRate.UserInput = True
        Call SpecifiedAirFlowRate
      End If

    Case 5        'Air Pressure Drop
      If (Unitted_LostFocus(UNITS_PRESSUREPERLENGTH, txtFlowsLoadings(5), txtFlowsUnits(5), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.AirPressureDrop.Value = NewVal
        scr1.AirPressureDrop.ValChanged = True
        scr1.AirPressureDrop.UserInput = True
      End If
  
  End Select

  If (IsNew) Then
    If (Index = 0) Then Call GetVQmultVQAndAirFlowRate
    Call GetLoadings
    Call GetTowerAreaAndDiameter
    Call GetOndaMassTransferCoefficient
    Call GetDesignKLaOrKLaSafetyFactor
    Call GetTowerHeightAndVolume
  End If
  Call LostFocus_Handle(Me, txtFlowsLoadings(Index), flag_ok)


End Sub

Private Sub txtFlowsUnits_Click(Index As Integer)

  Select Case Index
    Case 0        'Water Flow Rate
      Call Unitted_UnitChange(UNITS_FLOW, scr1.WaterFlowRate.Value, txtFlowsUnits(0), txtFlowsLoadings(0))

    Case 4        'Air Flow Rate
      Call Unitted_UnitChange(UNITS_FLOW, scr1.AirFlowRate.Value, txtFlowsUnits(4), txtFlowsLoadings(4))
    
    Case 5        'Air Pressure Drop
      Call Unitted_UnitChange(UNITS_PRESSUREPERLENGTH, scr1.AirPressureDrop.Value, txtFlowsUnits(5), txtFlowsLoadings(5))
  End Select

End Sub

Private Sub txtFlowsUnits_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtFlowsUnits(Index), Temp_Text)

End Sub

Private Sub txtFlowsUnits_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub txtFlowsUnits_LostFocus(Index As Integer)
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtFlowsUnits(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True
  Call LostFocus_Handle(Me, txtFlowsUnits(Index), flag_ok)

 
End Sub

Private Sub txtMassTransfer_Change(Index As Integer)

'  Call UnitsMassTransfer_Click(2)

End Sub

Private Sub txtMassTransfer_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtMassTransfer(Index), Temp_Text)
End Sub

Private Sub txtMassTransfer_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtMassTransfer_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtMassTransfer(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

  IsNew = False
  
  Select Case Index
    Case 1        'KLa Safety Factor
      If (NoUnits_LostFocus(txtMassTransfer(1), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.KLaSafetyFactor.Value = NewVal
        scr1.KLaSafetyFactor.ValChanged = True
        scr1.KLaSafetyFactor.UserInput = True
        Call SpecifiedKLaSafetyFactor
      End If
    
    Case 2        'Design KLa
      If (Unitted_LostFocus(UNITS_INVERSETIME, txtMassTransfer(2), UnitsMassTransfer(2), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.DesignMassTransferCoefficient.Value = NewVal
        scr1.DesignMassTransferCoefficient.ValChanged = True
        scr1.DesignMassTransferCoefficient.UserInput = True
        Call SpecifiedDesignMassTransferCoefficient
      End If
  
  End Select

  If (IsNew) Then
    Call GetTowerHeightAndVolume
  End If
  Call LostFocus_Handle(Me, txtMassTransfer(Index), flag_ok)


End Sub

Private Sub txtOperatingPressure_GotFocus()
    
  Call GotFocus_Handle(Me, txtOperatingPressure, Temp_Text)

End Sub

Private Sub txtOperatingPressure_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingPressure_LostFocus()
Dim NewVal As Double
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingPressure)) Then
     Exit Sub
   End If
   
   flag_ok = True

  If (Unitted_LostFocus(UNITS_PRESSURE, txtOperatingPressure, txtPUnits, NewVal, Temp_Text)) Then
    scr1.OperatingPressure.ValChanged = True
    scr1.OperatingPressure.UserInput = True
    'Note: standard P units are Pa, but
    'OperatingPressure is stored as kPa.
    scr1.OperatingPressure.Value = NewVal * 1# / 101325#

    If (HaveValue(scr1.OperatingPressure.Value) And HaveValue(scr1.operatingtemperature.Value)) Then
      Call CalculateAirWaterProperties
      If (scr1.NumChemical > 0) Then
        'Update Variables on Screen
        Call GetVQmultVQAndAirFlowRate
        Call GetLoadings
        Call GetTowerAreaAndDiameter
        Call GetOndaMassTransferCoefficient
        Call GetDesignKLaOrKLaSafetyFactor
        Call GetTowerHeightAndVolume
      End If
    End If
  End If
  Call LostFocus_Handle(Me, txtOperatingPressure, flag_ok)

  
End Sub

Private Sub txtOperatingTemperature_GotFocus()
    
  Call GotFocus_Handle(Me, txtOperatingTemperature, Temp_Text)
End Sub

Private Sub txtOperatingTemperature_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingTemperature_LostFocus()
Dim NewVal As Double
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingTemperature)) Then
     Exit Sub
   End If
   
   flag_ok = True

  If (Unitted_LostFocus(UNITS_TEMPERATURE, txtOperatingTemperature, txtTUnits, NewVal, Temp_Text)) Then
    scr1.operatingtemperature.ValChanged = True
    scr1.operatingtemperature.UserInput = True
    scr1.operatingtemperature.Value = NewVal

    If (HaveValue(scr1.OperatingPressure.Value) And HaveValue(scr1.operatingtemperature.Value)) Then
      Call CalculateAirWaterProperties

      If scr1.NumChemical > 0 Then
        'Update Variables on Screen
        Call GetVQmultVQAndAirFlowRate
        Call GetLoadings
        Call GetTowerAreaAndDiameter
        Call GetOndaMassTransferCoefficient
        Call GetDesignKLaOrKLaSafetyFactor
        Call GetTowerHeightAndVolume
      End If
    End If
  End If
  Call LostFocus_Handle(Me, txtOperatingTemperature, flag_ok)

    
End Sub

Private Sub txtPUnits_Click()
Dim Dummy As Double

  'Note: Standard P units are Pa, but OperatingPressure
  'is stored internally in kPa units.
  Dummy = scr1.OperatingPressure.Value * 101325#
  Call Unitted_UnitChange(UNITS_PRESSURE, Dummy, txtPUnits, txtOperatingPressure)

End Sub

Private Sub txtPUnits_KeyPress(KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub txtTUnits_Click()
  
  Call Unitted_UnitChange(UNITS_TEMPERATURE, scr1.operatingtemperature.Value, txtTUnits, txtOperatingTemperature)

End Sub

Private Sub txtTUnits_KeyPress(KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsMassTransfer_Click(Index As Integer)

  Select Case Index
    Case 0        'Onda KLa
      Call Unitted_UnitChange(UNITS_INVERSETIME, scr1.Onda.OverallMassTransferCoefficient, UnitsMassTransfer(0), lblMassTransfer(0))
  
    Case 2        'Design KLa
      Call Unitted_UnitChange(UNITS_INVERSETIME, scr1.DesignMassTransferCoefficient.Value, UnitsMassTransfer(2), txtMassTransfer(2))

  End Select
      
End Sub

Private Sub UnitsMassTransfer_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Begin VB.Form frmPTADScreen2 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Packed Tower Aeration - Rating Mode"
   ClientHeight    =   6780
   ClientLeft      =   3270
   ClientTop       =   2130
   ClientWidth     =   9480
   Icon            =   "PTADScreen2.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   ScaleHeight     =   6780
   ScaleWidth      =   9480
   Begin VB.CommandButton Command1 
      Appearance      =   0  'Flat
      Caption         =   "Concentration Results"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Left            =   960
      TabIndex        =   80
      TabStop         =   0   'False
      Top             =   6000
      Width           =   2655
   End
   Begin Threed.SSFrame Frame1 
      Height          =   1095
      Left            =   60
      TabIndex        =   11
      Top             =   120
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   1931
      _StockProps     =   14
      Caption         =   "Design Based On:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox UnitsDesignBasis 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   300
         Width           =   1275
      End
      Begin VB.ComboBox UnitsDesignBasis 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   660
         Width           =   1275
      End
      Begin VB.Label lblDesignParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   1740
         TabIndex        =   22
         Top             =   660
         Width           =   1215
      End
      Begin VB.Label lblDesignParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1740
         TabIndex        =   21
         Top             =   300
         Width           =   1215
      End
      Begin VB.Label lblDesignParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Height"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   20
         Top             =   660
         Width           =   1515
      End
      Begin VB.Label lblDesignParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Diameter"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   19
         Top             =   300
         Width           =   1515
      End
   End
   Begin Threed.SSFrame Frame3D1 
      Height          =   1815
      Left            =   60
      TabIndex        =   12
      Top             =   1290
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   3201
      _StockProps     =   14
      Caption         =   "Tower Parameters:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtTowerParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   1740
         TabIndex        =   0
         Top             =   300
         Width           =   1215
      End
      Begin VB.TextBox txtTowerParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   1740
         TabIndex        =   1
         Top             =   660
         Width           =   1215
      End
      Begin VB.ComboBox UnitsTowerParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   26
         TabStop         =   0   'False
         Top             =   300
         Width           =   1275
      End
      Begin VB.ComboBox UnitsTowerParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   25
         TabStop         =   0   'False
         Top             =   660
         Width           =   1275
      End
      Begin VB.ComboBox UnitsTowerParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   24
         TabStop         =   0   'False
         Top             =   1020
         Width           =   1275
      End
      Begin VB.ComboBox UnitsTowerParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   23
         TabStop         =   0   'False
         Top             =   1380
         Width           =   1275
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Volume"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   -1020
         TabIndex        =   32
         Top             =   1380
         Width           =   2655
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Tower Area"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -1020
         TabIndex        =   31
         Top             =   1020
         Width           =   2655
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Specify Diameter"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   -1020
         TabIndex        =   30
         Top             =   300
         Width           =   2655
      End
      Begin VB.Label lblTowerParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Specify Height"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -1020
         TabIndex        =   29
         Top             =   660
         Width           =   2655
      End
      Begin VB.Label lblTowerParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   1740
         TabIndex        =   28
         Top             =   1020
         Width           =   1215
      End
      Begin VB.Label lblTowerParameters 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   1740
         TabIndex        =   27
         Top             =   1380
         Width           =   1215
      End
   End
   Begin Threed.SSFrame fraOperatingConditions 
      Height          =   1575
      Left            =   60
      TabIndex        =   13
      Top             =   3180
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   2778
      _StockProps     =   14
      Caption         =   "Operating Conditions:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtOperatingPressure 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1740
         TabIndex        =   2
         Top             =   330
         Width           =   1215
      End
      Begin VB.TextBox txtOperatingTemperature 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1740
         TabIndex        =   3
         Top             =   690
         Width           =   1215
      End
      Begin VB.CommandButton lblDisplayAirWaterProperties 
         Appearance      =   0  'Flat
         Caption         =   "Display Physical Properties of Air and Water"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   180
         TabIndex        =   35
         TabStop         =   0   'False
         Top             =   1050
         Width           =   4155
      End
      Begin VB.ComboBox UnitsOpCond 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   34
         TabStop         =   0   'False
         Top             =   330
         Width           =   1275
      End
      Begin VB.ComboBox UnitsOpCond 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3060
         Style           =   2  'Dropdown List
         TabIndex        =   33
         TabStop         =   0   'False
         Top             =   690
         Width           =   1275
      End
      Begin VB.Label lblOperatingPressure 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pressure"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   -1020
         TabIndex        =   37
         Top             =   330
         Width           =   2655
      End
      Begin VB.Label lblOperatingTemperature 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Temperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   -1020
         TabIndex        =   36
         Top             =   690
         Width           =   2655
      End
   End
   Begin Threed.SSFrame fraPacking 
      Height          =   1095
      Left            =   60
      TabIndex        =   14
      Top             =   4830
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   1931
      _StockProps     =   14
      Caption         =   "Packing:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdSelectPacking 
         Appearance      =   0  'Flat
         Caption         =   "Select Packing Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   180
         TabIndex        =   39
         TabStop         =   0   'False
         Top             =   570
         Width           =   4155
      End
      Begin VB.CommandButton cmdPackingType 
         Appearance      =   0  'Flat
         Caption         =   "Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   180
         TabIndex        =   38
         TabStop         =   0   'False
         Top             =   270
         Width           =   855
      End
      Begin VB.Label lblPackingTypeLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   180
         TabIndex        =   41
         Top             =   270
         Width           =   735
      End
      Begin VB.Label lblPackingType 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   1140
         TabIndex        =   40
         Top             =   270
         Width           =   3195
      End
   End
   Begin Threed.SSFrame fraFlowsAndLoadings 
      Height          =   2295
      Left            =   4500
      TabIndex        =   15
      Top             =   120
      Width           =   4875
      _Version        =   65536
      _ExtentX        =   8599
      _ExtentY        =   4048
      _StockProps     =   14
      Caption         =   "Flows and Loadings:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdPickFlowLoadingParameters 
         Appearance      =   0  'Flat
         Caption         =   "Pick Flow and Loading Parameters to Specify"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   180
         TabIndex        =   46
         TabStop         =   0   'False
         Top             =   240
         Width           =   4335
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2160
         TabIndex        =   8
         TabStop         =   0   'False
         Top             =   1860
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2160
         TabIndex        =   4
         Top             =   660
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2160
         TabIndex        =   5
         Top             =   960
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2160
         TabIndex        =   6
         TabStop         =   0   'False
         Top             =   1260
         Width           =   1215
      End
      Begin VB.TextBox txtFlowsLoadings 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2160
         TabIndex        =   7
         TabStop         =   0   'False
         Top             =   1560
         Width           =   1215
      End
      Begin VB.ComboBox UnitsFlows 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   45
         TabStop         =   0   'False
         Top             =   660
         Width           =   1275
      End
      Begin VB.ComboBox UnitsFlows 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   44
         TabStop         =   0   'False
         Top             =   960
         Width           =   1275
      End
      Begin VB.ComboBox UnitsFlows 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   43
         TabStop         =   0   'False
         Top             =   1560
         Width           =   1275
      End
      Begin VB.ComboBox UnitsFlows 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   4
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   42
         TabStop         =   0   'False
         Top             =   1860
         Width           =   1275
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Water Flow Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   -600
         TabIndex        =   52
         Top             =   660
         Width           =   2655
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air to Water Ratio"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -600
         TabIndex        =   51
         Top             =   1260
         Width           =   2655
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Flow Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -600
         TabIndex        =   50
         Top             =   960
         Width           =   2655
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Loading Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   -600
         TabIndex        =   49
         Top             =   1860
         Width           =   2655
      End
      Begin VB.Label lblFlowsLoadingsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Water Loading Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   -600
         TabIndex        =   48
         Top             =   1560
         Width           =   2655
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( - )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3480
         TabIndex        =   47
         Top             =   1260
         Width           =   1275
      End
   End
   Begin Threed.SSFrame Frame3D2 
      Height          =   3705
      Left            =   4500
      TabIndex        =   16
      Top             =   2580
      Width           =   4875
      _Version        =   65536
      _ExtentX        =   8599
      _ExtentY        =   6535
      _StockProps     =   14
      Caption         =   "Contaminant of Interest:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdEditComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Edit Properties"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   2760
         TabIndex        =   63
         TabStop         =   0   'False
         Top             =   690
         Width           =   1875
      End
      Begin VB.CommandButton cmdDeleteComponent 
         Appearance      =   0  'Flat
         Caption         =   "De&lete"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   1560
         TabIndex        =   62
         TabStop         =   0   'False
         Top             =   690
         Width           =   1095
      End
      Begin VB.CommandButton cmdAddComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Add"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   300
         TabIndex        =   61
         TabStop         =   0   'False
         Top             =   690
         Width           =   1155
      End
      Begin VB.ComboBox cboSelectCompo 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   300
         Style           =   2  'Dropdown List
         TabIndex        =   60
         TabStop         =   0   'False
         Top             =   330
         Width           =   4335
      End
      Begin VB.TextBox txtDesignConcentrationValue 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2280
         TabIndex        =   9
         Top             =   1470
         Width           =   1095
      End
      Begin VB.TextBox txtDesignConcentrationValue 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2280
         TabIndex        =   10
         Top             =   1770
         Width           =   1095
      End
      Begin VB.ComboBox UnitsInterest 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   59
         TabStop         =   0   'False
         Top             =   1170
         Width           =   1275
      End
      Begin VB.ComboBox UnitsInterest 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   58
         TabStop         =   0   'False
         Top             =   1770
         Width           =   1275
      End
      Begin VB.ComboBox UnitsInterest 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   57
         TabStop         =   0   'False
         Top             =   2070
         Width           =   1275
      End
      Begin VB.ComboBox UnitsInterest 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   4
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   56
         TabStop         =   0   'False
         Top             =   2370
         Width           =   1275
      End
      Begin VB.ComboBox UnitsInterest 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   5
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   55
         TabStop         =   0   'False
         Top             =   2670
         Width           =   1275
      End
      Begin VB.ComboBox UnitsInterest 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   7
         Left            =   3480
         Style           =   2  'Dropdown List
         TabIndex        =   54
         TabStop         =   0   'False
         Top             =   3270
         Width           =   1275
      End
      Begin VB.CommandButton cmdOndakla 
         Appearance      =   0  'Flat
         Caption         =   "Onda KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   265
         Left            =   180
         TabIndex        =   53
         TabStop         =   0   'False
         Top             =   1155
         Width           =   1935
      End
      Begin VB.Shape Shape1 
         Height          =   795
         Left            =   180
         Top             =   270
         Width           =   4575
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   2280
         TabIndex        =   79
         Top             =   2670
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2280
         TabIndex        =   78
         Top             =   2370
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   2280
         TabIndex        =   77
         Top             =   2070
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Percent Removal"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   -480
         TabIndex        =   76
         Top             =   2970
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Treatment Objective"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   -480
         TabIndex        =   75
         Top             =   2370
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Influent Concentration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   -480
         TabIndex        =   74
         Top             =   2070
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Effluent Concentration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   -480
         TabIndex        =   73
         Top             =   2670
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Pressure Drop"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   -480
         TabIndex        =   72
         Top             =   3270
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Onda KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1020
         TabIndex        =   71
         Top             =   1170
         Width           =   1005
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   2280
         TabIndex        =   70
         Top             =   2970
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa Safety Factor"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -480
         TabIndex        =   69
         Top             =   1470
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Design KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -480
         TabIndex        =   68
         Top             =   1770
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2280
         TabIndex        =   67
         Top             =   1170
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   2280
         TabIndex        =   66
         Top             =   3270
         Width           =   1095
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( - )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3480
         TabIndex        =   65
         Top             =   1470
         Width           =   1275
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( % )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3480
         TabIndex        =   64
         Top             =   2970
         Width           =   1155
      End
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   330
      Top             =   6120
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   327681
   End
   Begin VB.Menu mnuFileMenu 
      Caption         =   "&File"
      Begin VB.Menu mnuFile 
         Caption         =   "Switch to &Design Mode"
         Index           =   0
         Shortcut        =   ^D
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Open"
         Index           =   3
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Save"
         Index           =   4
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Save &As"
         Index           =   5
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   6
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Print"
         Index           =   7
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &Printer"
            Index           =   0
         End
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &File"
            Index           =   1
         End
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Select Printer"
         Index           =   8
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   9
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Return to &Main Menu"
         Index           =   10
         Shortcut        =   ^M
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   11
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&1 Old File #1"
         Index           =   191
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&2 Old File #2"
         Index           =   192
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&3 Old File #3"
         Index           =   193
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&4 Old File #4"
         Index           =   194
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   199
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&xit"
         Index           =   200
      End
   End
   Begin VB.Menu mnuUnitsMenu 
      Caption         =   "&Units"
      Begin VB.Menu mnuUnits 
         Caption         =   "Standard International (SI)"
         Index           =   0
      End
      Begin VB.Menu mnuUnits 
         Caption         =   "English"
         Index           =   1
      End
   End
   Begin VB.Menu mnuPowerMenu 
      Caption         =   "&Power"
      Begin VB.Menu mnuPower 
         Caption         =   "&Perform Power Calculations"
         Index           =   0
      End
   End
   Begin VB.Menu mnuOptionsMenu 
      Caption         =   "&Results"
      Begin VB.Menu mnuoptions 
         Caption         =   "&View All Concentration Results"
         Index           =   0
      End
      Begin VB.Menu mnuoptions 
         Caption         =   "View &Mass Transfer Parameters"
         Index           =   5
      End
   End
   Begin VB.Menu mnuHelp 
      Caption         =   "&Help"
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&Online Help ..."
         Index           =   300
      End
   End
End
Attribute VB_Name = "frmPTADScreen2"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim frmPTADScreen2_Okay_To_Unload As Boolean



Const frmPTADScreen1_declarations_end = True


Private Sub AddPrompt(menuID As Integer, prompt As String)
    menuPrompts(iMenuPrompts).menuID = menuID
    menuPrompts(iMenuPrompts).prompt = prompt
    iMenuPrompts = iMenuPrompts + 1
End Sub

Private Sub cboSelectCompo_Click()
    Dim ContaminantIndex As Integer, i As Integer

    ContaminantIndex = cboSelectCompo.ListIndex + 1
    i = ContaminantIndex
    If i = 0 Then Exit Sub
    Scr2.DesignContaminant = Scr2.Contaminant(i)
    Call GetContaminantConcentrationsScreen2


    'Update Variables on Screen
'    Call GetVQmultVQAndAirFlowRate
'    Call GetLoadings
'    Call GetTowerAreaAndDiameter
'    Call GetOndaMassTransferCoefficient
'    Call GetDesignKLaOrKLaSafetyFactor
'    Call GetTowerHeightAndVolume

End Sub

Private Sub cmdAddComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer

  If (Scr2.NumChemical + 1 > MAXCHEMICAL) Then
     MsgBox "The maximum number of contaminants has been reached.  It is not possible to input more than " & Format$(MAXCHEMICAL, "0") & " contaminants for design.  To add an additional contaminant, another must first be removed.", MB_ICONSTOP, "Packed Tower Aeration"
     cmdAddComponent.Enabled = False
     Exit Sub
  End If

  x.ModelName = "Packed Tower Aeration"
  x.ModelType = MODELTYPE_PACKEDTOWER
  x.DoEditNumber = -1       'Will be set by frmContaminantPropertyEdit.
  x.DoAdd = True
  x.OldNumCompo = cboSelectCompo.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i) = Scr2.Contaminant(i)
  Next i

  StEPPImportSuccess = False
  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (StEPPImportSuccess) Or (Not x.CancelledAdd) Then
    For i = x.OldNumCompo + 1 To x.NewNumCompo
      'Incorporate new contaminant.
      If i > 10 Then
       MsgBox "Unable to continue importing file as maximum amount of chemicals in memory reached."
       Me.Show
       Exit Sub
      End If
        
        Scr2.Contaminant(i) = x.Contaminants(i)
        Scr2.NumChemical = Scr2.NumChemical + 1
        'Incorporate new name into ComboBox.
        cboSelectCompo.AddItem Scr2.Contaminant(i).Name
    Next i
  End If
  
  Call SetDesignContaminantEnabled(CInt(cboSelectCompo.ListCount))
  
  If (Scr2.NumChemical > 0) Then
    cmdDeleteComponent.Enabled = True
    cmdEditComponent.Enabled = True
    If (cboSelectCompo.ListIndex = -1) Then
      cboSelectCompo.ListIndex = 0
    End If
  End If
 Me.Show
End Sub

Private Sub cmdDeleteComponent_Click()
  Dim i As Integer

  Scr2.Chemical = cboSelectCompo.ListIndex + 1
  If (Scr2.Chemical = 0) Then Exit Sub

  If MsgBox("Remove" & NL & cboSelectCompo.List(cboSelectCompo.ListIndex), 36, "") = IDYES Then
    cboSelectCompo.RemoveItem cboSelectCompo.ListIndex
    For i = Scr2.Chemical To Scr2.NumChemical - 1
      Scr2.Contaminant(i) = Scr2.Contaminant(i + 1)
    Next i
    Scr2.NumChemical = Scr2.NumChemical - 1
    If (Scr2.NumChemical > 0) Then
      cboSelectCompo.ListIndex = 0
    Else
      cmdDeleteComponent.Enabled = False
      cmdEditComponent.Enabled = False
    End If
    Call SetDesignContaminantEnabled(CInt(cboSelectCompo.ListCount))
  End If

  If Scr2.NumChemical < 10 Then cmdAddComponent.Enabled = True
End Sub

Private Sub cmdEditComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer
Dim AListIndex As Integer

  Scr2.Chemical = cboSelectCompo.ListIndex + 1
  If (Scr2.Chemical = 0) Then Exit Sub

  x.ModelName = "Packed Tower Aeration"
  x.ModelType = MODELTYPE_PACKEDTOWER
  x.DoEditNumber = cboSelectCompo.ListIndex + 1
  x.DoAdd = False
  x.OldNumCompo = cboSelectCompo.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i) = Scr2.Contaminant(i)
  Next i

  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (Not x.CancelledEdit) Then
    For i = 1 To x.NewNumCompo
      Scr2.Contaminant(i) = x.Contaminants(i)
    Next i
    If (x.OldNumCompo < x.NewNumCompo) Then
      'Incorporate new names into ComboBox.
      For i = x.OldNumCompo + 1 To x.NewNumCompo
        cboSelectCompo.AddItem Scr2.Contaminant(i).Name
      Next i
    End If
    'Update ComboBox for any changed names:
    For i = 1 To x.OldNumCompo
      If (Trim$(cboSelectCompo.List(i - 1)) <> Trim$(Scr2.Contaminant(i).Name)) Then
        cboSelectCompo.List(i - 1) = Trim$(Scr2.Contaminant(i).Name)
      End If
    Next i
  Else
    Exit Sub
  End If

  'Generate click event on cboSelectCompo
  AListIndex = cboSelectCompo.ListIndex
  cboSelectCompo.ListIndex = -1
  cboSelectCompo.ListIndex = AListIndex

End Sub

Private Sub cmdOndakla_Click()
       If frmPTADScreen2.lblDesignConcentrationValue(0).Caption = "0.0" Then Exit Sub
       frmShowOndaKLaProperties.Show 1


End Sub

Private Sub cmdPackingType_Click()

  ScreenNumber = 2
  CurrentScreen = Scr2
  Call ShowPackingProperties

End Sub

Private Sub cmdPickFlowLoadingParameters_Click()

    frmFlowsLoadingsScreen2.Show 1
End Sub

Private Sub cmdSelectContaminants_Click()
    
  'frmListcontaminantScreen2.Show 1

End Sub

Private Sub cmdSelectPacking_Click()
    Dim i As Integer, CurrPackingIndex As Integer

    ReadMainPackingDB
    ReadUserPackingDB
  
    PackingDatabaseSource = Scr2.Packing.SourceDatabase

    If Scr2.Packing.Name = "" Then
       Scr2.Packing.Name = frmSelectPacking.cboSelectPacking.List(0)
       PackingChanged = True
    End If

    If PackingDatabaseSource = ORIGINALPACKINGDATABASE Then
       For i = 1 To NumPackingsInDatabase
           If DatabasePacking(i).Name = Scr2.Packing.Name Then
              CurrPackingIndex = i
              frmSelectPacking.cboSelectPacking.ListIndex = CurrPackingIndex - 1
              Exit For
           End If
       Next i
    ElseIf PackingDatabaseSource = USERMODIFIEDPACKINGDATABASE Then
       For i = 1 To NumUserPackings
           If UserPacking(i).Name = Scr2.Packing.Name Then
              CurrPackingIndex = i
              frmSelectPacking.cboSelectPacking.ListIndex = CurrPackingIndex - 1
              Exit For
           End If
       Next i

    End If

    ScreenNumber = 2
    CurrentScreen = Scr2
    frmSelectPacking.Show 1
    Scr2 = CurrentScreen

    If Scr2.NumChemical > 0 Then
       'Update values on screen
       Call GetContaminantConcentrationsScreen2
    End If

End Sub

Private Sub Command1_Click()
Call screen2_results
End Sub

Private Sub Form_Activate()
'    Dim hMenu       As Integer
'    Dim hSubMenu    As Integer
'
''Initialize MsgHook and Load Menu Prompts to Display on Status Bar
'    imenuprompts = 0
'
'    MsgHook1.HwndHook = Me.hWnd
'    MsgHook1.Message(WM_MENUSELECT) = True
'    hMenu = GetMenu(Me.hWnd)
'    '
'    ' Load File menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 0)
'    AddPrompt hSubMenu, "File operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Switch to Design Mode for packed tower aeration"
'    AddPrompt GetMenuItemID(hSubMenu, 2), "Load a rating case from a file"
'    AddPrompt GetMenuItemID(hSubMenu, 3), "Save this rating case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 4), "Save this rating case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 6), "Print this rating case"
'    AddPrompt GetMenuItemID(hSubMenu, 7), "Select printer for printing results"
'    AddPrompt GetMenuItemID(hSubMenu, 9), "Leave packed tower aeration and return to main ASAP menu"
'    AddPrompt GetMenuItemID(hSubMenu, 11), "Exit program"
'
'    '
'    ' Load Units menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 1)
'    AddPrompt hSubMenu, "Units operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Display results in Standard International (SI) units"
'    AddPrompt GetMenuItemID(hSubMenu, 1), "Display results in English units"
'    '
'    ' Load Power menu prompt
'    '
'    hSubMenu = GetSubMenu(hMenu, 2)
'    AddPrompt hSubMenu, "Power operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Perform power calculations"
'
'    ' Load Options menu prompt
'    '
'    hSubMenu = GetSubMenu(hMenu, 3)
'    AddPrompt hSubMenu, "Options"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "View Effluent Concentration Results for All Contaminants"

    'Initialize last-few-files list.
    Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ASAP, LASTFEW_ASAP_frmPTADScreen2)

End Sub

Private Sub Form_Load()
    
  frmPTADScreen2_Okay_To_Unload = False
  
  frmPTADScreen2.WindowState = 0
  frmPTADScreen2.Width = SCREEN_WIDTH_STANDARD
  frmPTADScreen2.Height = SCREEN_HEIGHT_STANDARD

  'Center the form on the screen
  If (WindowState = 0) Then
    'don't attempt if screen Minimized or Maximized
    Move (Screen.Width - frmPTADScreen2.Width) / 2, (Screen.Height - frmPTADScreen2.Height) / 2
  End If

  Call LabelsPTADScreen2(UNITSTYPE_SI)

  'StatusMessagePanel.BackColor = &HC0C0C0
  'StatusMessagePanel.ForeColor = &H400040
  'StatusBarPanel.BackColor = &HC0C0C0
  'StatusBarPanel.ForeColor = &H400040

End Sub
Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  If (frmPTADScreen2_Okay_To_Unload) Then
    Cancel = False
  Else
    Cancel = True
  End If
End Sub


Private Sub lblDesignConcentration_Click(Index As Integer)
    If Index = 0 Then
       If frmPTADScreen2.lblDesignConcentrationValue(0).Caption = "0.0" Then Exit Sub
       frmShowOndaKLaProperties.Show 1
    End If

End Sub

Private Sub lblDesignConcentrationValue_Change(Index As Integer)

  Call UnitsInterest_Click(Index)

End Sub

Private Sub lblDisplayAirWaterProperties_Click()

    If HaveValue(Scr2.OperatingPressure.Value) And HaveValue(Scr2.operatingtemperature.Value) Then
       CurrentScreen = Scr2
       CurrentMode = 2
       frmAirWaterProperties.Show 1
    Else
       MsgBox "You must specify pressure and temperature before physical properties can be displayed.", MB_ICONSTOP, "Error"
    End If

End Sub

Private Sub lblPackingType_Click()
    
  Call cmdPackingType_Click

End Sub

Private Sub mnuFile_Click(Index As Integer)
  Dim i As Integer, response As Integer
  Dim msg As String
    Screen.MousePointer = 11   'Hourglass

    Select Case Index
       Case 0   'Switch to Design Mode

          If frmPTADScreen2!lblDesignConcentrationValue(6).Caption = "0.0" Then
             Filename$ = "TheDefaultCaseScreen1"
             Call loadscreen1("")
             frmPTADScreen2.Hide
             frmPTADScreen1.Show
             Screen.MousePointer = 0
             Exit Sub
          End If
          

          If HaveValue(Scr2.AirPressureDrop.Value) Then
             'Give user option to save screen 2 before
             'switching to screen 1
             msg = "Would you like to save the parameters "
             msg = msg + "for this optimization case to a file "
             msg = msg + "before switching to Design "
             msg = msg + "Mode?  " & Chr$(13) & Chr$(13)
             msg = msg + "(Note:  Non-saved information will be lost permanently)."
             response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "Save Current Design")
             If response = IDYES Then
                Call SaveScreen2
             End If
          End If

          If ShownScreen1Previously Then   'Show Design Parameters calculated earlier from that case
             frmPTADScreen2.Hide
             scr1.OperatingPressure.ValChanged = True
             Call CalculateAirWaterProperties
             frmPTADScreen1.Show
          Else   'Transfer Parameters from Rating Mode to Design Mode
             'Initialize Values on Screen 1:

             'Pressure and Temperature
             frmPTADScreen1!txtOperatingPressure.Text = frmPTADScreen2!txtOperatingPressure.Text
             scr1.OperatingPressure = Scr2.OperatingPressure
             scr1.OperatingPressure.ValChanged = True
             frmPTADScreen1!txtOperatingTemperature.Text = frmPTADScreen2!txtOperatingTemperature.Text
             scr1.operatingtemperature = Scr2.operatingtemperature
             scr1.operatingtemperature.ValChanged = True

             'Physical Properties
             Call CalculateAirWaterProperties

             'Packing
             frmPTADScreen1!lblPackingType.Caption = frmPTADScreen2!lblPackingType.Caption
             scr1.Packing = Scr2.Packing

             'Contaminant List
             scr1.NumChemical = Scr2.NumChemical
             frmPTADScreen1!cboSelectCompo.Clear
             'frmListContaminant!ListContaminants.Clear
             If scr1.NumChemical > 0 Then
                For i = 1 To scr1.NumChemical
                    scr1.Contaminant(i) = Scr2.Contaminant(i)
                    frmPTADScreen1!cboSelectCompo.AddItem scr1.Contaminant(i).Name
                    'frmListContaminant!ListContaminants.AddItem Scr1.Contaminant(i).Name
                Next i


                'frmListContaminant!mnuOptionsManipulateContaminant(1).Enabled = True
                'frmListContaminant!mnuOptionsManipulateContaminant(3).Enabled = True
                'frmListContaminant!mnuOptionsManipulateContaminant(4).Enabled = True
                'frmListContaminant!mnuOptionsSave.Enabled = True
                'frmListContaminant!mnuOptionsView.Enabled = True

                Call SetDesignContaminantEnabled(CInt(scr1.NumChemical))
             End If

             'Flow and Loading Parameters
             frmPTADScreen1!txtFlowsLoadings(0).Text = frmPTADScreen2!txtFlowsLoadings(0).Text
             scr1.WaterFlowRate = Scr2.WaterFlowRate
             scr1.WaterFlowRate.UserInput = True
             If scr1.AirFlowRate.UserInput = True Then
                frmPTADScreen1!txtFlowsLoadings(4).Text = frmPTADScreen1!txtFlowsLoadings(1).Text
                scr1.AirFlowRate = Scr2.AirFlowRate
                scr1.AirFlowRate.UserInput = True
                scr1.AirToWaterRatio.UserInput = False
                scr1.MultipleOfMinimumAirToWaterRatio.UserInput = False
             Else
                'Consider Air To Water Ratio User Input
                frmPTADScreen1!txtFlowsLoadings(3).Text = frmPTADScreen2!txtFlowsLoadings(2).Text
                scr1.AirToWaterRatio = Scr2.AirToWaterRatio
                scr1.AirToWaterRatio.UserInput = True
                scr1.AirFlowRate.UserInput = False
                scr1.MultipleOfMinimumAirToWaterRatio.UserInput = False
             End If
       
             'KLaSafetyFactor
             scr1.KLaSafetyFactor.Value = Scr2.KLaSafetyFactor.Value
             scr1.KLaSafetyFactor.UserInput = True
             frmPTADScreen1!txtMassTransfer(1).Text = Format$(scr1.KLaSafetyFactor.Value, GetTheFormat(scr1.KLaSafetyFactor.Value))

             'Calculate properties of the contaminant in the
             'combo box now.

             scr1.DesignContaminant = Scr2.DesignContaminant
             frmPTADScreen1!cboSelectCompo.ListIndex = frmPTADScreen2!cboSelectCompo.ListIndex

             frmPTADScreen1.Caption = "Packed Tower Aeration - Design Mode (untitled.des)"

             frmPTADScreen2.Hide
             frmPTADScreen1.Show

          End If

       Case 2   'New

       Case 3   'Open
          If HaveValue(Scr2.TowerVolume.Value) Then
            If (screen2_savechanges()) Then Exit Sub
          End If
          
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          Call loadscreen2("")
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)

          SaveAndLoadPath = CurDir$
          ''''ChDrive App.Path
          ''''ChDir App.Path
          Call ChangeDir_Main

       Case 4   'Save
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          Call SaveScreen2
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)
          
          SaveAndLoadPath = CurDir$
          ''''ChDrive App.Path
          ''''ChDir App.Path
          Call ChangeDir_Main

       Case 5   'Save As
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          If Right$(frmPTADScreen2.Caption, 14) <> "(untitled.rat)" Then Call savefilescreen2(Filename)
          Call SaveScreen2
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)
          
          SaveAndLoadPath = CurDir$
          ''''ChDrive App.Path
          ''''ChDir App.Path
          Call ChangeDir_Main

       Case 7   'Print
          

       Case 8   'Select Printer
            On Error GoTo PrinterError
            'CMDialog1.flags = PD_PRINTSETUP
            'CMDialog1.Action = 5
            CommonDialog1.ShowPrinter
            GoTo ExitSelectPrint
PrinterError:
            Resume ExitSelectPrint:

ExitSelectPrint:

        Case 10   'Return to Main Menu
            If HaveValue(Scr2.TowerVolume.Value) Then
               If (screen2_savechanges()) Then Exit Sub
            End If

            'unload Forms for Packed Tower Aeration
            Unload frmAirWaterProperties
            'Unload frmListContaminant
            'Unload frmPropContaminant
            ''''Unload HelpTipForm
            Unload frmShowOndaKLaProperties
            Unload frmSelectPacking
            Unload frmShowPackingProperties
            Unload frmPower
            Unload frmPowerScreen2
            Unload frmFlowsLoadingsScreen2
            'Unload frmListcontaminantScreen2
            'Unload frmPropContaminantScreen2
            Unload frmOptimizeContaminant
            Unload frmPTADScreen1
            frmPTADScreen2_Okay_To_Unload = True
            Unload frmPTADScreen2
            
            frmMainMenu.Show


        Case 200   'Exit
            'Give user option to save design mode before Exiting
            If HaveValue(Scr2.TowerVolume.Value) Then
               If (screen2_savechanges()) Then Exit Sub
            End If
            
            'unload Forms for Packed Tower Aeration
            Unload frmAirWaterProperties
            'Unload frmListContaminant
            'Unload frmPropContaminant
            ''''Unload HelpTipForm
            Unload frmShowOndaKLaProperties
            Unload frmSelectPacking
            Unload frmShowPackingProperties
            Unload frmPower
            Unload frmPowerScreen2
            Unload frmFlowsLoadingsScreen2
            'Unload frmListcontaminantScreen2
            'Unload frmPropContaminantScreen2
            Unload frmOptimizeContaminant
            Unload frmPTADScreen1
            frmPTADScreen2_Okay_To_Unload = True
            Unload frmPTADScreen2
            Unload frmMainMenu
            End
    
    End Select
    
    If ((Index >= 191) And (Index <= 194)) Then
      'Handle File|Open of a file here.
      ''''ChDrive SaveAndLoadPath
      ''''ChDir SaveAndLoadPath
      Call ChangeDir_Main
      If (Dir(Current_LastFewFilesRec.FileNames(Index - 190)) = "") Then
        Beep
        MsgBox "That file has been moved or deleted.", MB_ICONEXCLAMATION, Application_Name
      Else
        Call loadscreen2(Current_LastFewFilesRec.FileNames(Index - 190))
        'Add this file to the last-few-files list if necessary.
        Call LastFewFiles_MoveFilenameToTop(Filename)
        SaveAndLoadPath = CurDir$
      End If
      ''''ChDir App.Path
      ''''ChDrive App.Path
      Call ChangeDir_Main
    End If

    Screen.MousePointer = 0   'Arrow

End Sub

Private Sub mnuFilePrint_Click(Index As Integer)

    Select Case Index
       Case 0   'Print to printer
          Call PrintPTADScreen2
       Case 1   'Print to file
          Call PrintPTADScreen2ToFile
    End Select

End Sub

Private Sub mnuHelpItem_Click(Index As Integer)
  Select Case Index
    'Case 10:
    '  frmabout2.Show 1
    'Case 99:
    '  frmAbout.Show 1
    Case 300:
      Call Launch_ASAP_HLP_File
  End Select
End Sub

Private Sub mnuOndaKla_Click(Index As Integer)
End Sub

Private Sub mnuOptions_Click(Index As Integer)

  Select Case Index
    Case 0: Call screen2_results
    Case 5:
      If frmPTADScreen2.lblDesignConcentrationValue(0).Caption = "0.0" Then Exit Sub
      frmShowOndaKLaProperties.Show 1
  
  End Select

End Sub

Private Sub mnuotheritem_Click()
'frmabout2.Show 1
End Sub

Private Sub mnuPopContaminant_Click(Index As Integer)
    
    'If Index = 1 Then
    '   If frmListcontaminantScreen2!ListContaminants.ListCount > 0 Then
    '      frmListcontaminantScreen2!ListContaminants.ListIndex = 0
    '   End If
    '
    '   frmListcontaminantScreen2.Show 1
    'End If

End Sub

Private Sub mnuPower_Click(Index As Integer)
    Dim CalculatedPower As Integer

    Select Case Index   'Power Calculation

       Case 0
             Call SetPowerPTADScreen2(CalculatedPower)
             If CalculatedPower Then
                frmPowerScreen2.Left = Screen.Width / 2 - frmPowerScreen2.Width / 2
                frmPowerScreen2.Top = Screen.Height / 2 - frmPowerScreen2.Height / 2
                frmPowerScreen2.Show 1
             End If
    End Select

End Sub

Private Sub mnuUnits_Click(Index As Integer)

  Select Case Index
    Case 0        'SI
      Call LabelsPTADScreen2(UNITSTYPE_SI)
    Case 1        'English
      Call LabelsPTADScreen2(UNITSTYPE_ENGLISH)
  End Select

End Sub

Private Sub MsgHook1_Message(msg As Integer, wParam As Integer, lParam As Long, Action As Integer, result As Long)
'    Dim i       As Integer
'    Dim found   As Integer
'
'    '
'    ' Got a menu select message ... see if it's for one of our menus
'    '
'    For i = 0 To iMenuPrompts - 1
'        If (menuPrompts(i).menuID = wParam) Then
'            '
'            ' One of our menus ... display prompt message
'            '
'            StatusMessagePanel.Caption = menuPrompts(i).prompt
'            found = True
'            Exit For
'        End If
'    Next
'    '
'    ' Blank prompt message when no menu selected
'    '
'    If (found <> True) Then
'        StatusMessagePanel.Caption = ""
'    End If
'
End Sub

Private Sub Old_HelpTipTimer_Timer()
''temp kill
'Exit Sub
'''''''''''''''''''''
'
' Dim PointStruct As PointType
' Static PrevioushWnd%
' Dim CurrenthWnd As Integer, TipText As String
'
'If GetActiveWindow() = Me.hWnd Then
'  Call GetCursorPos(PointStruct)
'  CurrenthWnd% = WindowFromPoint(PointStruct.Y, PointStruct.x)
'  If CurrenthWnd <> PrevioushWnd% Then
'    PrevioushWnd% = CurrenthWnd
'    'HelpTipTimer.Interval = 1
'    Select Case CurrenthWnd%
'      Case txtOperatingPressure.hWnd    '<---- Here for the text box txtOperatingPressure
'       StatusMessagePanel.Caption = " Input Operating " & lblOperatingPressure.Caption
'      Case txtOperatingTemperature.hWnd   '<---- Here for the text box txtOperatingTemperature
'       StatusMessagePanel.Caption = " Input Operating " & lblOperatingTemperature.Caption
'      Case lblDisplayAirWaterProperties.hWnd
'       StatusMessagePanel.Caption = " Specify water density, viscosity, and surface tension; and air density and viscosity"
'      Case txtFlowsLoadings(0).hWnd
'       StatusMessagePanel.Caption = "Input " & lblFlowsLoadingsLabel(0).Caption
'      Case txtFlowsLoadings(1).hWnd
'       StatusMessagePanel.Caption = "Input " & lblFlowsLoadingsLabel(1).Caption
'      Case txtFlowsLoadings(2).hWnd
'       StatusMessagePanel.Caption = "Input " & lblFlowsLoadingsLabel(2).Caption
'      Case txtFlowsLoadings(3).hWnd
'       StatusMessagePanel.Caption = "Input " & lblFlowsLoadingsLabel(3).Caption
'      Case txtFlowsLoadings(4).hWnd
'       StatusMessagePanel.Caption = "Input " & lblFlowsLoadingsLabel(4).Caption
'    End Select
'    ShowHelpTip TipText$
'    If Len(TipText$) = 0 Then
'      'HelpTipTimer.Interval = 500 'Milliseconds
'    End If
'  End If
'End If
'
End Sub

Private Sub txtDesignConcentrationValue_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtDesignConcentrationValue(Index), Temp_Text)
End Sub

Private Sub txtDesignConcentrationValue_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtDesignConcentrationValue_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtDesignConcentrationValue(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

  IsNew = False
  
  Select Case Index
    Case 1        'KLa Safety Factor
      If (NoUnits_LostFocus(txtDesignConcentrationValue(1), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.KLaSafetyFactor.Value = NewVal
        Scr2.KLaSafetyFactor.ValChanged = True
        Scr2.KLaSafetyFactor.UserInput = True
        Call SpecifiedKLaSafetyFactorScreen2
      End If
    
    Case 2        'Design KLa
      If (Unitted_LostFocus(UNITS_INVERSETIME, txtDesignConcentrationValue(2), UnitsInterest(2), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.DesignMassTransferCoefficient.Value = NewVal
        Scr2.DesignMassTransferCoefficient.ValChanged = True
        Scr2.DesignMassTransferCoefficient.UserInput = True
        Call SpecifiedDesignKLaScreen2
      End If

  End Select

  If (IsNew) Then
    Call GetContaminantConcentrationsScreen2
  End If

  Call LostFocus_Handle(Me, txtDesignConcentrationValue(Index), flag_ok)


End Sub

Private Sub txtFlowsLoadings_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtFlowsLoadings(Index), Temp_Text)
End Sub

Private Sub txtFlowsLoadings_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtFlowsLoadings_LostFocus(Index As Integer)
Dim i As Integer
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtFlowsLoadings(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

  'Exit Subroutine if not in a text box user can
  'currently specify
  If UsersFlowsLoadingsOption = 0 Then
    Select Case Index
      Case 2 To 4
        Exit Sub
    End Select
  ElseIf UsersFlowsLoadingsOption = 1 Then
    Select Case Index
      Case 1, 3, 4
        Exit Sub
    End Select
  ElseIf UsersFlowsLoadingsOption = 2 Then
    Select Case Index
      Case 0 To 2
        Exit Sub
    End Select
  End If
  
  IsNew = False
  
  Select Case Index

    Case 0        'Water Flow Rate.
      If (Unitted_LostFocus(UNITS_FLOW, txtFlowsLoadings(0), UnitsFlows(0), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.WaterFlowRate.Value = NewVal
        Scr2.WaterFlowRate.ValChanged = True
      End If

    Case 1        'Air Flow Rate
      If (Unitted_LostFocus(UNITS_FLOW, txtFlowsLoadings(1), UnitsFlows(1), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.AirFlowRate.Value = NewVal
        Scr2.AirFlowRate.ValChanged = True
      End If
      
    Case 2        'Air To Water Ratio
      If (NoUnits_LostFocus(txtFlowsLoadings(2), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.AirToWaterRatio.Value = NewVal
        Scr2.AirToWaterRatio.ValChanged = True
      End If
        
    Case 3        'Water Loading Rate
      If (Unitted_LostFocus(UNITS_MASSLOADINGRATE, txtFlowsLoadings(3), UnitsFlows(3), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.WaterLoadingRate.Value = NewVal
        Scr2.WaterLoadingRate.ValChanged = True
      End If

    Case 4        'Air Loading Rate
      If (Unitted_LostFocus(UNITS_MASSLOADINGRATE, txtFlowsLoadings(4), UnitsFlows(4), NewVal, Temp_Text)) Then
        IsNew = True
        scr1.AirLoadingRate.Value = NewVal
        scr1.AirLoadingRate.ValChanged = True
      End If
  
  End Select

  If (IsNew) Then
    Call GetFlowsAndLoadingsScreen2

    If Scr2.NumChemical > 0 Then
      'Update Variables on Screen
      Call GetContaminantConcentrationsScreen2
'      Call GetVQmultVQAndAirFlowRate
'      Call GetLoadings
'      Call GetTowerAreaAndDiameter
'      Call GetOndaMassTransferCoefficient
'      Call GetDesignKLaOrKLaSafetyFactor
'      Call GetTowerHeightAndVolume
    End If
  End If

  Call LostFocus_Handle(Me, txtFlowsLoadings(Index), flag_ok)


End Sub

Private Sub txtOperatingPressure_GotFocus()
    
  Call GotFocus_Handle(Me, txtOperatingPressure, Temp_Text)
End Sub

Private Sub txtOperatingPressure_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingPressure_LostFocus()
Dim NewVal As Double
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingPressure)) Then
     Exit Sub
   End If
   
   flag_ok = True

  If (Unitted_LostFocus(UNITS_PRESSURE, txtOperatingPressure, UnitsOpCond(0), NewVal, Temp_Text)) Then
    Scr2.OperatingPressure.ValChanged = True
    Scr2.OperatingPressure.UserInput = True
    'Note: standard P units are Pa, but
    'OperatingPressure is stored as kPa.
    Scr2.OperatingPressure.Value = NewVal * 1# / 101325#

    If (HaveValue(Scr2.OperatingPressure.Value) And HaveValue(Scr2.operatingtemperature.Value)) Then
      Call CalculateAirWaterPropertiesScreen2
      Call GetFlowsAndLoadingsScreen2

      If (Scr2.NumChemical > 0) Then
        'Update Variables on Screen
        Call GetContaminantConcentrationsScreen2
'        Call GetVQmultVQAndAirFlowRate
'        Call GetLoadings
'        Call GetTowerAreaAndDiameter
'        Call GetOndaMassTransferCoefficient
'        Call GetDesignKLaOrKLaSafetyFactor
'        Call GetTowerHeightAndVolume
      End If
    End If
  End If
  Call LostFocus_Handle(Me, txtOperatingPressure, flag_ok)

  
End Sub

Private Sub txtOperatingTemperature_GotFocus()
    
  Call GotFocus_Handle(Me, txtOperatingTemperature, Temp_Text)
End Sub

Private Sub txtOperatingTemperature_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingTemperature_LostFocus()
Dim NewVal As Double
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingTemperature)) Then
     Exit Sub
   End If
   
   flag_ok = True

  If (Unitted_LostFocus(UNITS_TEMPERATURE, txtOperatingTemperature, UnitsOpCond(1), NewVal, Temp_Text)) Then
    Scr2.operatingtemperature.ValChanged = True
    Scr2.operatingtemperature.UserInput = True
    Scr2.operatingtemperature.Value = NewVal

    If (HaveValue(Scr2.OperatingPressure.Value) And HaveValue(Scr2.operatingtemperature.Value)) Then
      Call CalculateAirWaterPropertiesScreen2
      Call GetFlowsAndLoadingsScreen2
      
      If (Scr2.NumChemical > 0) Then
        'Update Variables on Screen
        Call GetContaminantConcentrationsScreen2
             
'        Call GetVQmultVQAndAirFlowRate
'        Call GetLoadings
'        Call GetTowerAreaAndDiameter
'        Call GetOndaMassTransferCoefficient
'        Call GetDesignKLaOrKLaSafetyFactor
'        Call GetTowerHeightAndVolume
      End If
    End If
  End If
  Call LostFocus_Handle(Me, txtOperatingTemperature, flag_ok)

    
End Sub

Private Sub txtTowerParameters_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtTowerParameters(Index), Temp_Text)
End Sub

Private Sub txtTowerParameters_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtTowerParameters_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtTowerParameters(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

  IsNew = False
  If txtTowerParameters(Index) > 2000 Then
    MsgBox "Invalid input:  the input range is (0 to 2000 m)"
    Exit Sub
  End If

  Select Case Index
    Case 0        'Specify Diameter.
      If (Unitted_LostFocus(UNITS_LENGTH, txtTowerParameters(0), UnitsTowerParam(0), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.SpecifiedTowerDiameter.Value = NewVal
        Scr2.SpecifiedTowerDiameter.ValChanged = True
        Scr2.SpecifiedTowerDiameter.UserInput = True
      End If

    Case 1        'Specify Height.
      If (Unitted_LostFocus(UNITS_LENGTH, txtTowerParameters(1), UnitsTowerParam(1), NewVal, Temp_Text)) Then
        IsNew = True
        Scr2.SpecifiedTowerHeight.Value = NewVal
        Scr2.SpecifiedTowerHeight.ValChanged = True
        Scr2.SpecifiedTowerHeight.UserInput = True
      End If
    
  End Select

  If (IsNew) Then
    Call GetTowerAreaAndVolume
    Call GetFlowsAndLoadingsScreen2
       
    If (Scr2.NumChemical > 0) Then
      'Update Variables on Screen
      Call GetContaminantConcentrationsScreen2
'
'      Call GetVQmultVQAndAirFlowRate
'      Call GetLoadings
'      Call GetTowerAreaAndDiameter
'      Call GetOndaMassTransferCoefficient
'      Call GetDesignKLaOrKLaSafetyFactor
'      Call GetTowerHeightAndVolume
    End If
    
  End If
  Call LostFocus_Handle(Me, txtTowerParameters(Index), flag_ok)


End Sub

Private Sub UnitsDesignBasis_Click(Index As Integer)

  Select Case Index
    Case 0        'Tower Diameter
      Call Unitted_UnitChange(UNITS_LENGTH, Scr2.TowerDiameter.Value, UnitsDesignBasis(0), lblDesignParameters(0))
    
    Case 1        'Tower Height
      Call Unitted_UnitChange(UNITS_LENGTH, Scr2.TowerHeight.Value, UnitsDesignBasis(1), lblDesignParameters(1))
  
  End Select

End Sub

Private Sub UnitsDesignBasis_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsFlows_Click(Index As Integer)

  Select Case Index
    Case 0        'Water Flow Rate
      Call Unitted_UnitChange(UNITS_FLOW, Scr2.WaterFlowRate.Value, UnitsFlows(0), txtFlowsLoadings(0))
    
    Case 1        'Air Flow Rate
      Call Unitted_UnitChange(UNITS_FLOW, Scr2.AirFlowRate.Value, UnitsFlows(1), txtFlowsLoadings(1))
  
    Case 3        'Water Loading Rate
      Call Unitted_UnitChange(UNITS_MASSLOADINGRATE, Scr2.WaterLoadingRate.Value, UnitsFlows(3), txtFlowsLoadings(3))
  
    Case 4        'Air Loading Rate
      Call Unitted_UnitChange(UNITS_MASSLOADINGRATE, Scr2.AirLoadingRate.Value, UnitsFlows(4), txtFlowsLoadings(4))
  
  End Select

End Sub

Private Sub UnitsFlows_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsInterest_Click(Index As Integer)
Dim Dummy As Double
Dim ContaminantIndex As Integer
Dim i As Integer

  ContaminantIndex = cboSelectCompo.ListIndex + 1
  i = ContaminantIndex

  On Error GoTo err_UnitsInterest_Click

  Select Case Index
    Case 0            'Onda KLa
      Dummy = Scr2.Onda.OverallMassTransferCoefficient
      Call Unitted_UnitChange(UNITS_INVERSETIME, Dummy, UnitsInterest(0), lblDesignConcentrationValue(0))

    Case 2            'Design KLa
      Dummy = Scr2.DesignMassTransferCoefficient.Value
      Call Unitted_UnitChange(UNITS_INVERSETIME, Dummy, UnitsInterest(2), txtDesignConcentrationValue(2))

    Case 3            'Influent Concentration
      Dummy = Scr2.DesignContaminant.Influent.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsInterest(3), lblDesignConcentrationValue(3))

    Case 4            'Treatment Objective
      Dummy = Scr2.DesignContaminant.TreatmentObjective.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsInterest(4), lblDesignConcentrationValue(4))

    Case 5            'Effluent Concentration
      Dummy = Scr2.DesignContaminant.Effluent.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsInterest(5), lblDesignConcentrationValue(5))

    Case 7            'Air Pressure Drop
      Dummy = Scr2.AirPressureDrop.Value
      Call Unitted_UnitChange(UNITS_PRESSUREPERLENGTH, Dummy, UnitsInterest(7), lblDesignConcentrationValue(7))
      If (Dummy < -1) Then
        lblDesignConcentrationValue(7) = "N/A"
      End If

  End Select

exit_UnitsInterest_Click:
  Exit Sub

err_UnitsInterest_Click:
  Resume exit_UnitsInterest_Click

End Sub

Private Sub UnitsInterest_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsOpCond_Click(Index As Integer)
Dim Dummy As Double

  Select Case Index
    Case 0
      'Note: Standard P units are Pa, but OperatingPressure
      'is stored internally in kPa units.
      Dummy = Scr2.OperatingPressure.Value * 101325#
      Call Unitted_UnitChange(UNITS_PRESSURE, Dummy, UnitsOpCond(0), txtOperatingPressure)

    Case 1
      Call Unitted_UnitChange(UNITS_TEMPERATURE, Scr2.operatingtemperature.Value, UnitsOpCond(1), txtOperatingTemperature)
    
  End Select

End Sub

Private Sub UnitsOpCond_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsTowerParam_Click(Index As Integer)

  Select Case Index
    Case 0        'Specify Diameter
      Call Unitted_UnitChange(UNITS_LENGTH, Scr2.SpecifiedTowerDiameter.Value, UnitsTowerParam(0), txtTowerParameters(0))
    
    Case 1        'Specify Height
      Call Unitted_UnitChange(UNITS_LENGTH, Scr2.SpecifiedTowerHeight.Value, UnitsTowerParam(1), txtTowerParameters(1))
  
    Case 2        'Tower Area
      Call Unitted_UnitChange(UNITS_AREA, Scr2.TowerArea.Value, UnitsTowerParam(2), lblTowerParameters(2))
  
    Case 3        'Tower Volume
      Call Unitted_UnitChange(UNITS_VOLUME, Scr2.TowerVolume.Value, UnitsTowerParam(3), lblTowerParameters(3))
  
  End Select

End Sub

Private Sub UnitsTowerParam_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmSelectPacking 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Select Packing"
   ClientHeight    =   5250
   ClientLeft      =   2400
   ClientTop       =   3405
   ClientWidth     =   7935
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5250
   ScaleWidth      =   7935
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Caption         =   "Select Current Packing Properties"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4020
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   4110
      Width           =   3495
   End
   Begin VB.CommandButton cmdCancel 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "Cancel"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4020
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   4710
      Width           =   3495
   End
   Begin Threed.SSFrame fraPackingDatabase 
      Height          =   4935
      Left            =   120
      TabIndex        =   7
      Top             =   120
      Width           =   3495
      _Version        =   65536
      _ExtentX        =   6159
      _ExtentY        =   8700
      _StockProps     =   14
      Caption         =   "Original Database"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboSelectPacking 
         Appearance      =   0  'Flat
         Height          =   4275
         Left            =   120
         Style           =   1  'Simple Combo
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   450
         Width           =   3255
      End
   End
   Begin Threed.SSFrame fraPackingProperties 
      Height          =   3435
      Left            =   3720
      TabIndex        =   8
      Top             =   120
      Width           =   4125
      _Version        =   65536
      _ExtentX        =   7276
      _ExtentY        =   6059
      _StockProps     =   14
      Caption         =   "Packing Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPackingNumericalProperties 
         Appearance      =   0  'Flat
         Height          =   288
         Index           =   0
         Left            =   2550
         TabIndex        =   1
         Top             =   990
         Width           =   1452
      End
      Begin VB.TextBox txtPackingNumericalProperties 
         Appearance      =   0  'Flat
         Height          =   288
         Index           =   1
         Left            =   2550
         TabIndex        =   2
         Top             =   1350
         Width           =   1452
      End
      Begin VB.TextBox txtPackingNumericalProperties 
         Appearance      =   0  'Flat
         Height          =   288
         Index           =   2
         Left            =   2550
         TabIndex        =   3
         Top             =   1710
         Width           =   1452
      End
      Begin VB.TextBox txtPackingNumericalProperties 
         Appearance      =   0  'Flat
         Height          =   288
         Index           =   3
         Left            =   2550
         TabIndex        =   4
         Top             =   2070
         Width           =   1452
      End
      Begin VB.TextBox txtPackingStringProperties 
         Appearance      =   0  'Flat
         Height          =   288
         Index           =   0
         Left            =   750
         TabIndex        =   0
         Top             =   390
         Width           =   3252
      End
      Begin VB.TextBox txtPackingStringProperties 
         Appearance      =   0  'Flat
         Height          =   288
         Index           =   1
         Left            =   1470
         TabIndex        =   5
         Top             =   2550
         Width           =   2532
      End
      Begin VB.TextBox txtPackingStringProperties 
         Appearance      =   0  'Flat
         Height          =   288
         Index           =   2
         Left            =   1470
         TabIndex        =   6
         Top             =   2910
         Width           =   2532
      End
      Begin VB.Label lblPackingProperties 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Name"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   150
         TabIndex        =   17
         Top             =   390
         Width           =   495
      End
      Begin VB.Label lblPackingProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Nominal Size"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   150
         TabIndex        =   16
         Top             =   990
         Width           =   2175
      End
      Begin VB.Label lblPackingProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Packing Factor"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   150
         TabIndex        =   15
         Top             =   1350
         Width           =   2175
      End
      Begin VB.Label lblPackingProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Sp. Surf. Area"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   150
         TabIndex        =   14
         Top             =   1710
         Width           =   2175
      End
      Begin VB.Label lblPackingProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Crit. Surf. Tension"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   150
         TabIndex        =   13
         Top             =   2070
         Width           =   2175
      End
      Begin VB.Label lblPackingProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Material"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   150
         TabIndex        =   12
         Top             =   2550
         Width           =   1095
      End
      Begin VB.Label lblPackingProperties 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Source"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   150
         TabIndex        =   11
         Top             =   2910
         Width           =   1095
      End
      Begin VB.Line Line1 
         X1              =   30
         X2              =   4110
         Y1              =   2430
         Y2              =   2430
      End
      Begin VB.Line Line2 
         X1              =   30
         X2              =   4110
         Y1              =   870
         Y2              =   870
      End
   End
   Begin VB.Menu mnuPackDatabaseMenu 
      Caption         =   "&Database"
      Begin VB.Menu mnuPackDatabase 
         Caption         =   "&Original Database"
         Index           =   0
      End
      Begin VB.Menu mnuPackDatabase 
         Caption         =   "&User-Modified Database"
         Index           =   1
      End
      Begin VB.Menu mnuPackDatabase 
         Caption         =   "-"
         Index           =   2
      End
      Begin VB.Menu mnuPackDatabase 
         Caption         =   "O&ptions"
         Index           =   3
         Begin VB.Menu mnuPackDatabaseOptions 
            Caption         =   "&Remove Packing"
            Index           =   0
         End
      End
   End
End
Attribute VB_Name = "frmSelectPacking"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cboSelectPacking_Click()
    Dim i As Integer, j As Integer

    i = cboSelectPacking.ListIndex + 1

    If mnuPackDatabase(0).Checked = True Then

       If PackingChanged = False And PackingDatabaseSource = ORIGINALPACKINGDATABASE Then
          If Trim$(cboSelectPacking.Text) <> CurrentScreen.Packing.Name Then
             PackingChanged = True
          End If
       End If

       If PackingChanged = False And PackingDatabaseSource = USERMODIFIEDPACKINGDATABASE Then
          PackingChanged = True
       End If

       txtPackingStringProperties(0).Text = DatabasePacking(i).Name
       txtPackingNumericalProperties(0).Text = Format$(DatabasePacking(i).NominalSize, GetTheFormat(DatabasePacking(i).NominalSize))
       txtPackingNumericalProperties(1).Text = Format$(DatabasePacking(i).PackingFactor, GetTheFormat(DatabasePacking(i).PackingFactor))
       txtPackingNumericalProperties(2).Text = Format$(DatabasePacking(i).SpecificSurfaceArea, GetTheFormat(DatabasePacking(i).SpecificSurfaceArea))
       txtPackingNumericalProperties(3).Text = Format$(DatabasePacking(i).CriticalSurfaceTension, GetTheFormat(DatabasePacking(i).CriticalSurfaceTension))
       txtPackingStringProperties(1).Text = DatabasePacking(i).Material
       txtPackingStringProperties(2).Text = DatabasePacking(i).source

    Else
       PackingValuesChanged = False
       
       If PackingChanged = False And PackingDatabaseSource = USERMODIFIEDPACKINGDATABASE Then
          If Trim$(cboSelectPacking.Text) <> CurrentScreen.Packing.Name Then
             PackingChanged = True
          End If
       End If

       If PackingChanged = False And PackingDatabaseSource = ORIGINALPACKINGDATABASE Then
          PackingChanged = True
       End If
       
       txtPackingStringProperties(0).Text = UserPacking(i).Name
       txtPackingNumericalProperties(0).Text = Format$(UserPacking(i).NominalSize, GetTheFormat(UserPacking(i).NominalSize))
       txtPackingNumericalProperties(1).Text = Format$(UserPacking(i).PackingFactor, GetTheFormat(UserPacking(i).PackingFactor))
       txtPackingNumericalProperties(2).Text = Format$(UserPacking(i).SpecificSurfaceArea, GetTheFormat(UserPacking(i).SpecificSurfaceArea))
       txtPackingNumericalProperties(3).Text = Format$(UserPacking(i).CriticalSurfaceTension, GetTheFormat(UserPacking(i).CriticalSurfaceTension))
       txtPackingStringProperties(1).Text = UserPacking(i).Material
       txtPackingStringProperties(2).Text = UserPacking(i).source
    End If
End Sub

Private Sub cboSelectPacking_KeyPress(KeyAscii As Integer)
    Dim ComboText As String
    Dim i As Integer
    Dim msg As String

    If KeyAscii <> 13 Then Exit Sub   'Exit if Enter not pressed
    KeyAscii = 0

    ComboText = cboSelectPacking.Text

    'Check if Text Entered in Combo Box matches a
    'Packing type in the database and if so, select that
    'packing


    If mnuPackDatabase(0).Checked = True Then
       For i = 1 To NumPackingsInDatabase
           If Trim$(ComboText) = DatabasePacking(i).Name Then
              cboSelectPacking.ListIndex = i - 1
              cboSelectPacking_Click
              Exit Sub
           End If
       Next i
    Else
       For i = 1 To NumUserPackings
           If Trim$(ComboText) = UserPacking(i).Name Then
              cboSelectPacking.ListIndex = i - 1
              cboSelectPacking_Click
              Exit Sub
           End If
       Next i
    End If

    'If the packing type entered does not match, prepare
    'for input if we're in user-modified database

    If mnuPackDatabase(0).Checked = False Then
       txtPackingStringProperties(0).Text = ComboText
       txtPackingNumericalProperties(0).Text = Format$(DefaultPacking.NominalSize, GetTheFormat(DefaultPacking.NominalSize))
       txtPackingNumericalProperties(1).Text = Format$(DefaultPacking.PackingFactor, GetTheFormat(DefaultPacking.PackingFactor))
       txtPackingNumericalProperties(2).Text = Format$(DefaultPacking.SpecificSurfaceArea, GetTheFormat(DefaultPacking.SpecificSurfaceArea))
       txtPackingNumericalProperties(3).Text = Format$(DefaultPacking.CriticalSurfaceTension, GetTheFormat(DefaultPacking.CriticalSurfaceTension))
       txtPackingStringProperties(1).Text = DefaultPacking.Material
       txtPackingStringProperties(2).Text = "User"
      
       PackingValuesChanged = True
       PackingChanged = True
       txtPackingNumericalProperties(0).SetFocus
    Else
       For i = 1 To NumPackingsInDatabase
           If Trim$(ComboText) = Left$(DatabasePacking(i).Name, Len(ComboText)) Then
              cboSelectPacking.ListIndex = i - 1
              cboSelectPacking_Click
              Exit Sub
           End If
       Next i

       msg = "Packing with specified name not in original database.  "
       msg = msg + "Please specify another name or switch to the "
       msg = msg + "user-modified database if you would like to "
       msg = msg + "enter your own packing data."
       MsgBox msg, MB_ICONSTOP, "Packing Not Found"


       If cboSelectPacking.ListCount > 0 Then
          For i = 1 To NumPackingsInDatabase
              If UCase$(DatabasePacking(i).Name) = UCase$(scr1.Packing.Name) Then
                 cboSelectPacking.ListIndex = i - 1
                 Exit For
              Else
                 cboSelectPacking.ListIndex = 0
              End If
          Next i
          cboSelectPacking_Click
       End If
    End If
End Sub

Private Sub cmdCancel_Click()
    Dim i As Integer
    
    If PackingDatabaseSource = ORIGINALPACKINGDATABASE Then
       If Not mnuPackDatabase(0).Checked Then
          mnuPackDatabase(0).Checked = True
          mnuPackDatabase(1).Checked = False
          mnuPackDatabase(3).Enabled = False
          cboSelectPacking.Clear
          For i = 1 To NumPackingsInDatabase
              cboSelectPacking.AddItem DatabasePacking(i).Name
          Next i
       End If
    Else
       If Not mnuPackDatabase(1).Checked Then
          mnuPackDatabase(1).Checked = True
          mnuPackDatabase(0).Checked = False
          mnuPackDatabase(3).Enabled = True
          cboSelectPacking.Clear
          For i = 1 To NumUserPackings
              cboSelectPacking.AddItem UserPacking(i).Name
          Next i
       End If
    End If

    mnuPackDatabase(0).Checked = True
    mnuPackDatabase(1).Checked = False
    
    PackingValuesChanged = False
    PackingChanged = False
    frmSelectPacking.Hide
End Sub

Private Sub cmdOK_Click()
    Dim i As Integer, msg As String
    Dim response As Integer, Answer As Integer
    Dim MustOverwrite As Integer
    Dim NumToOverwrite As Integer  'Index of packing to overwrite (if necessary) in user-modified packing database
    Dim demostr$

'  DEMO STUFF ::TACK
    demostr$ = cboSelectPacking.Text
    If demomode_check_packing(demostr$) = 1 Then Exit Sub
'  END DEMO STUFF

    If Not PackingChanged Then
       frmSelectPacking.Hide
       Exit Sub
    End If

    If mnuPackDatabase(0).Checked = True Then
       PackingDatabaseSource = ORIGINALPACKINGDATABASE
    Else
       PackingDatabaseSource = USERMODIFIEDPACKINGDATABASE
    
        'Warn User if accepting this new contaminant would
        'overwrite an item already in database if any of
        'the values for packing properties have changed

        If PackingValuesChanged Then

           'Make sure user's name does not duplicate a
           'packing name in the original database and
           'if it does, exit the subroutine
           For i = 1 To NumPackingsInDatabase
               If UCase$(DatabasePacking(i).Name) = UCase$(txtPackingStringProperties(0).Text) Then
                  msg = "The name of your packing can not duplicate "
                  msg = msg + "the name of a packing in the original "
                  msg = msg + "packing database.  Please select a new "
                  msg = msg + "name for your packing."
                  MsgBox msg, MB_ICONSTOP, "Duplicate Name Error"
                  txtPackingStringProperties(0).SetFocus
                  Exit Sub
               End If
           Next i

           MustOverwrite = False
           For i = 1 To NumUserPackings
               If txtPackingStringProperties(0).Text = UserPacking(i).Name Then
                  msg = "Packing with name " & UserPacking(i).Name & Chr$(13)
                  msg = msg + "already exists in database." & Chr$(13) & Chr$(13)
                  msg = msg + "Do you wish to overwrite previous database values?"
                  response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "Warning")
                  If response = IDNO Then
                     txtPackingStringProperties(0).SetFocus
                     Exit Sub
                  End If
                  MustOverwrite = True
                  NumToOverwrite = i
                  Exit For
               End If
           Next i
        End If
    End If

    CurrentScreen.Packing.Name = txtPackingStringProperties(0).Text
    CurrentScreen.Packing.NominalSize = CDbl(txtPackingNumericalProperties(0).Text)
    CurrentScreen.Packing.PackingFactor = CDbl(txtPackingNumericalProperties(1).Text)
    CurrentScreen.Packing.SpecificSurfaceArea = CDbl(txtPackingNumericalProperties(2).Text)
    CurrentScreen.Packing.CriticalSurfaceTension = CDbl(txtPackingNumericalProperties(3).Text)
    CurrentScreen.Packing.Material = txtPackingStringProperties(1).Text
    CurrentScreen.Packing.source = txtPackingStringProperties(2).Text
    CurrentScreen.Packing.SourceDatabase = PackingDatabaseSource
    CurrentScreen.Packing.ValChanged = True

    If Trim$(fraPackingDatabase.Caption) = "Original Database" Then
       CurrentScreen.Packing.UserInput = False
    Else
       CurrentScreen.Packing.UserInput = True
    End If

    If ScreenNumber = 1 Then
       frmPTADScreen1!lblPackingType.Caption = CurrentScreen.Packing.Name
    ElseIf ScreenNumber = 2 Then
       frmPTADScreen2!lblPackingType.Caption = CurrentScreen.Packing.Name
    End If

    'Add new packing to user-modified database if it has been modified

    If (PackingDatabaseSource = USERMODIFIEDPACKINGDATABASE) And (PackingValuesChanged = True) Then
       Select Case MustOverwrite
          Case True
             i = NumToOverwrite
          Case False
             msg = CurrentScreen.Packing.Name & " has been added to the "
             msg = msg + "user-modified packing database."
             MsgBox msg, MB_ICONINFORMATION, ""
             i = NumUserPackings + 1
             NumUserPackings = i
             frmSelectPacking.cboSelectPacking.AddItem CurrentScreen.Packing.Name
       End Select

       UserPacking(i).Name = CurrentScreen.Packing.Name
       UserPacking(i).NominalSize = CurrentScreen.Packing.NominalSize
       UserPacking(i).PackingFactor = CurrentScreen.Packing.PackingFactor
       UserPacking(i).SpecificSurfaceArea = CurrentScreen.Packing.SpecificSurfaceArea
       UserPacking(i).CriticalSurfaceTension = CurrentScreen.Packing.CriticalSurfaceTension
       UserPacking(i).Material = CurrentScreen.Packing.Material
       UserPacking(i).source = CurrentScreen.Packing.source
       UserPacking(i).SourceDatabase = PackingDatabaseSource
       UserPacking(i).ValChanged = False
       UserPacking(i).UserInput = CurrentScreen.Packing.UserInput

       'Give user the option to permanently update the user-modified database by writing the changes to disk
       WriteUserPackingDB

    End If

    mnuPackDatabase(0).Checked = True
    mnuPackDatabase(1).Checked = False
    
    PackingChanged = False
    ShownPackingProperties = False
    frmSelectPacking.Hide

End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()

  Call CenterThisForm(Me)

'  DEMO STUFF STOP THE UER FROM CHANGING PROPERTIES OF PACKING MATERIALS::TACK
    If DemoMode% Then
        frmSelectPacking!txtPackingStringProperties(0).Enabled = False
        frmSelectPacking!txtPackingStringProperties(1).Enabled = False
        frmSelectPacking!txtPackingStringProperties(2).Enabled = False
        frmSelectPacking!txtPackingNumericalProperties(0).Enabled = False
        frmSelectPacking!txtPackingNumericalProperties(1).Enabled = False
        frmSelectPacking!txtPackingNumericalProperties(2).Enabled = False
        frmSelectPacking!txtPackingNumericalProperties(3).Enabled = False
    End If
'  END DEMO STUFF

    frmSelectPacking.WindowState = 0
    

    Call LabelsSelectPackingPropertiesSI

    PackingChanged = False
    PackingValuesChanged = False
End Sub

Private Sub mnuPackDatabase_Click(Index As Integer)
    Dim i As Integer, CurrPackingIndex As Integer

    CurrPackingIndex = -1

    Select Case Index
       Case 0    'Original Database
            If Not mnuPackDatabase(0).Checked Then
               mnuPackDatabase(0).Checked = True
               fraPackingDatabase.Caption = "Original Database"
               mnuPackDatabase(1).Checked = False
               mnuPackDatabase(3).Enabled = False
               cboSelectPacking.Clear
               For i = 1 To NumPackingsInDatabase
                   cboSelectPacking.AddItem DatabasePacking(i).Name
                   If DatabasePacking(i).Name = CurrentScreen.Packing.Name Then CurrPackingIndex = i
               Next i
               If CurrPackingIndex = -1 Then   'Currently Selected Packing not in database
                  PackingChanged = True
                  cboSelectPacking.ListIndex = 0
                  cboSelectPacking_Click
                  
               Else
                  PackingChanged = False
                  cboSelectPacking.ListIndex = CurrPackingIndex - 1
                  cboSelectPacking_Click
                  
               End If
            End If
       Case 1    'User-Modified Database
            If Not mnuPackDatabase(1).Checked Then
               mnuPackDatabase(0).Checked = False
               mnuPackDatabase(1).Checked = True
               mnuPackDatabase(3).Enabled = True
               fraPackingDatabase.Caption = "User-Modified Database"
               cboSelectPacking.Clear
               
               For i = 1 To NumUserPackings
                   cboSelectPacking.AddItem UserPacking(i).Name
                   If UserPacking(i).Name = CurrentScreen.Packing.Name Then CurrPackingIndex = i
               Next i
            End If
               If CurrPackingIndex = -1 Then   'Currently Selected Packing not in database
                  PackingChanged = True
                  cboSelectPacking.ListIndex = 0
                  cboSelectPacking_Click
                  
               Else
                  PackingChanged = False
                  cboSelectPacking.ListIndex = CurrPackingIndex - 1
                  cboSelectPacking_Click
                  
               End If

    End Select
End Sub

Private Sub mnuPackDatabaseOptions_Click(Index As Integer)
    Dim msg As String, i As Integer
    Dim NumToRemove As Integer
    Dim response As Integer

    Select Case Index
       Case 0    'Remove selected packing from database

          NumToRemove = -1
          For i = 1 To NumUserPackings
              If Trim$(cboSelectPacking.Text) = UserPacking(i).Name Then
                 NumToRemove = i
                 If (Trim$(cboSelectPacking.Text) = CurrentScreen.Packing.Name) And (PackingDatabaseSource = USERMODIFIEDPACKINGDATABASE) Then
                    MsgBox "You are not allowed to remove the currently selected packing type from the database.  Recommendation: First, select a different packing type, and second, remove this packing type.", MB_ICONSTOP, "Error"
                    Exit Sub
                 End If
                 Exit For
              End If
          Next i

          If NumToRemove = -1 Then
             MsgBox "The packing selected for removal (" & Trim$(cboSelectPacking.Text) & ") is not an item in the user-modified database.", MB_ICONSTOP, "Error"
             Exit Sub
          End If

          msg = "Do you really want to remove "
          msg = msg + cboSelectPacking.Text + " from the "
          msg = msg + "User-Modified Packing Database?"
          response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "")

          If response = IDNO Then Exit Sub
          cboSelectPacking.RemoveItem (NumToRemove - 1)
          For i = NumToRemove To NumUserPackings - 1
              UserPacking(i).Name = UserPacking(i + 1).Name
              UserPacking(i).NominalSize = UserPacking(i + 1).NominalSize
              UserPacking(i).PackingFactor = UserPacking(i + 1).PackingFactor
              UserPacking(i).SpecificSurfaceArea = UserPacking(i + 1).SpecificSurfaceArea
              UserPacking(i).CriticalSurfaceTension = UserPacking(i + 1).CriticalSurfaceTension
              UserPacking(i).Material = UserPacking(i + 1).Material
              UserPacking(i).source = UserPacking(i + 1).source
              UserPacking(i).ValChanged = UserPacking(i + 1).ValChanged
              UserPacking(i).UserInput = UserPacking(i + 1).UserInput
          Next i

          NumUserPackings = NumUserPackings - 1

          'Give user the option to permanently update the user-modified database by writing the changes to disk

          'NOTE (4/9/98): These two confirmation requests are handled
          'right in the WriteUserPackingDB() routine, therefore they are commented out.  EJO.
          'msg = "Would you like to PERMANENTLY update "
          'msg = msg + "the changes in the user-modified database "
          'msg = msg + "to disk?"
          'Response = MsgBox(msg, MB_ICONQUESTION + MB_YESNO, "")
          'If Response = IDYES Then
          '   Response = MsgBox("This can not be undone.", MB_OKCANCEL + MB_ICONEXCLAMATION, "Warning")
          '   If Response = IDOK Then
                Call WriteUserPackingDB
          '   End If
          'End If

          If cboSelectPacking.ListCount > 0 Then
             cboSelectPacking.ListIndex = 0
             cboSelectPacking_Click
          End If

     End Select
          
End Sub

Private Sub txtPackingNumericalProperties_Change(Index As Integer)
    Dim i As Integer

    cmdOK.Enabled = True
    
    If txtPackingStringProperties(0).Text = "" Then cmdOK.Enabled = False

    If cmdOK.Enabled Then
       For i = 0 To 3
           If val(txtPackingNumericalProperties(i).Text) <= 0# Then
              cmdOK.Enabled = False
           End If
       Next i
    End If

End Sub

Private Sub txtPackingNumericalProperties_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtPackingNumericalProperties(Index), Temp_Text)
End Sub

Private Sub txtPackingNumericalProperties_KeyPress(Index As Integer, KeyAscii As Integer)
    Dim msg As String

    If KeyAscii = 13 Then
       KeyAscii = 0
       SendKeys "{Tab}"
       Exit Sub
    End If

    If mnuPackDatabase(0).Checked = True Then
       KeyAscii = 0   'User does not have option to modify values in the original database
       msg = "Values in the original database can not be modified.  "
       msg = msg + "If you wish to enter your own values, switch to the "
       msg = msg + "User-Modified Database in the Database menu."
       MsgBox msg, 16, "Warning"
    Else
       Call NumberCheck(KeyAscii)
    End If

End Sub

Private Sub txtPackingNumericalProperties_LostFocus(Index As Integer)
    Dim ValueChanged As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtPackingNumericalProperties(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtPackingNumericalProperties(Index), Temp_Text)

    If Not IsError Then
       Call TextNumberChanged(ValueChanged, txtPackingNumericalProperties(Index), Temp_Text)

       If ValueChanged Then
          PackingChanged = True
          PackingValuesChanged = True
       End If
    End If
  Call LostFocus_Handle(Me, txtPackingNumericalProperties(Index), flag_ok)


End Sub

Private Sub txtPackingStringProperties_Change(Index As Integer)
    Dim i As Integer

    If Index <> 0 Then Exit Sub   'The user is not required to enter values for Material or Source to execute program
    txtPackingStringProperties(Index).Text = Trim$(txtPackingStringProperties(Index).Text)
    cmdOK.Enabled = True
    If txtPackingStringProperties(Index).Text = "" Then cmdOK.Enabled = False
    If cmdOK.Enabled Then
       For i = 0 To 3
           If val(txtPackingNumericalProperties(i).Text) <= 0# Then
              cmdOK.Enabled = False
           End If
       Next i
    End If

End Sub

Private Sub txtPackingStringProperties_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtPackingStringProperties(Index), Temp_Text)
End Sub

Private Sub txtPackingStringProperties_KeyPress(Index As Integer, KeyAscii As Integer)
  Dim msg As String

    If KeyAscii = 13 Then
       KeyAscii = 0
       SendKeys "{Tab}"
       Exit Sub
    End If

    If mnuPackDatabase(0).Checked = True Then
       KeyAscii = 0   'User does not have option to modify values in the original database
       msg = "Values in the original database can not be modified.  "
       msg = msg + "If you wish to enter your own values, switch to the "
       msg = msg + "User-Modified Database in the Database menu."
       MsgBox msg, 16, "Warning"
    End If

End Sub

Private Sub txtPackingStringProperties_LostFocus(Index As Integer)
    Dim ValueChanged As Integer
Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtPackingStringProperties(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True


    txtPackingStringProperties(Index).Text = Trim$(txtPackingStringProperties(Index).Text)
    Call TextStringChanged(ValueChanged, txtPackingStringProperties(Index), Temp_Text)
    If ValueChanged Then
       PackingValuesChanged = True
       PackingChanged = True
    End If
  Call LostFocus_Handle(Me, txtPackingStringProperties(Index), flag_ok)


End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmShowOndaKLaProperties 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Mass Transfer Properties"
   ClientHeight    =   5895
   ClientLeft      =   5055
   ClientTop       =   1935
   ClientWidth     =   5400
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5895
   ScaleWidth      =   5400
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   2460
      TabIndex        =   21
      TabStop         =   0   'False
      Top             =   5040
      Width           =   615
   End
   Begin Threed.SSFrame fraShowOndaMassTransfer 
      Height          =   4455
      Left            =   240
      TabIndex        =   0
      Top             =   210
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8700
      _ExtentY        =   7853
      _StockProps     =   14
      Caption         =   "Mass Transfer Parameters (Onda Correlation):"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Line Line3 
         X1              =   0
         X2              =   4920
         Y1              =   3840
         Y2              =   3840
      End
      Begin VB.Line Line2 
         X1              =   0
         X2              =   4920
         Y1              =   3000
         Y2              =   3000
      End
      Begin VB.Line Line1 
         X1              =   0
         X2              =   4920
         Y1              =   1800
         Y2              =   1800
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   3600
         TabIndex        =   20
         Top             =   3960
         Width           =   1215
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Overall M.T. Coeff. = Onda KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   120
         TabIndex        =   19
         Top             =   3960
         Width           =   3255
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   3600
         TabIndex        =   18
         Top             =   3480
         Width           =   1215
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   3600
         TabIndex        =   17
         Top             =   3120
         Width           =   1215
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Gas Phase M.T. Coefficient"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   120
         TabIndex        =   16
         Top             =   3480
         Width           =   3255
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Liq. Phase M.T. Coefficient"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   120
         TabIndex        =   15
         Top             =   3120
         Width           =   3255
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   3600
         TabIndex        =   14
         Top             =   2640
         Width           =   1215
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3600
         TabIndex        =   13
         Top             =   2280
         Width           =   1215
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3600
         TabIndex        =   12
         Top             =   1920
         Width           =   1215
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Total Mass Transfer Resistance"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   120
         TabIndex        =   11
         Top             =   2640
         Width           =   3255
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Gas Phase M.T. Resistance"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   120
         TabIndex        =   10
         Top             =   2280
         Width           =   3255
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Liq. Phase M.T. Resistance"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   120
         TabIndex        =   9
         Top             =   1920
         Width           =   3255
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3600
         TabIndex        =   8
         Top             =   1440
         Width           =   1215
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3600
         TabIndex        =   7
         Top             =   1080
         Width           =   1215
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3600
         TabIndex        =   6
         Top             =   720
         Width           =   1215
      End
      Begin VB.Label lblOndaProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3600
         TabIndex        =   5
         Top             =   360
         Width           =   1215
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Packing Wetted Surf. Area"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   120
         TabIndex        =   4
         Top             =   1440
         Width           =   3255
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Weber Number"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   3
         Top             =   1080
         Width           =   3255
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Froude Number"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   2
         Top             =   720
         Width           =   3255
      End
      Begin VB.Label lblOndaPropertiesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   " Reynold's Number"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   1
         Top             =   360
         Width           =   3255
      End
   End
End
Attribute VB_Name = "frmShowOndaKLaProperties"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
    frmShowOndaKLaProperties.Hide
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()
    
  Call CenterThisForm(Me)
  Call LabelsShowOndaKLaSI
    
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmShowPackingProperties 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Properties of Selected Packing"
   ClientHeight    =   5310
   ClientLeft      =   3420
   ClientTop       =   3240
   ClientWidth     =   5085
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5310
   ScaleWidth      =   5085
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   2130
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   4650
      Width           =   735
   End
   Begin Threed.SSFrame fraPackingSource 
      Height          =   735
      Left            =   690
      TabIndex        =   15
      Top             =   3720
      Width           =   3615
      _Version        =   65536
      _ExtentX        =   6371
      _ExtentY        =   1291
      _StockProps     =   14
      Caption         =   "Above Packing Properties From:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblShowPackingProperties 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   390
         TabIndex        =   16
         Top             =   330
         Width           =   2895
      End
   End
   Begin Threed.SSFrame fraPackingProperties 
      Height          =   3375
      Left            =   120
      TabIndex        =   0
      Top             =   150
      Width           =   4815
      _Version        =   65536
      _ExtentX        =   8493
      _ExtentY        =   5953
      _StockProps     =   14
      Caption         =   "Packing Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblShowPackingProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   1980
         TabIndex        =   14
         Top             =   2910
         Width           =   2655
      End
      Begin VB.Label lblShowPackingProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   1980
         TabIndex        =   13
         Top             =   2550
         Width           =   2655
      End
      Begin VB.Label lblShowPackingProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3180
         TabIndex        =   12
         Top             =   2070
         Width           =   1455
      End
      Begin VB.Label lblShowPackingProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3180
         TabIndex        =   11
         Top             =   1710
         Width           =   1455
      End
      Begin VB.Label lblShowPackingProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3180
         TabIndex        =   10
         Top             =   1350
         Width           =   1455
      End
      Begin VB.Label lblShowPackingProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3180
         TabIndex        =   9
         Top             =   990
         Width           =   1455
      End
      Begin VB.Label lblShowPackingProperties 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1140
         TabIndex        =   8
         Top             =   390
         Width           =   3495
      End
      Begin VB.Line Line2 
         X1              =   60
         X2              =   4740
         Y1              =   2430
         Y2              =   2430
      End
      Begin VB.Line Line1 
         X1              =   60
         X2              =   4740
         Y1              =   870
         Y2              =   870
      End
      Begin VB.Label lblShowPackingPropertesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Source"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   420
         TabIndex        =   7
         Top             =   2910
         Width           =   1335
      End
      Begin VB.Label lblShowPackingPropertesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Material"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   420
         TabIndex        =   6
         Top             =   2550
         Width           =   1335
      End
      Begin VB.Label lblShowPackingPropertesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Crit. Surf. Tension"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   180
         TabIndex        =   5
         Top             =   2070
         Width           =   2895
      End
      Begin VB.Label lblShowPackingPropertesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Sp. Surf. Area"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   420
         TabIndex        =   4
         Top             =   1710
         Width           =   2655
      End
      Begin VB.Label lblShowPackingPropertesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Packing Factor"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   420
         TabIndex        =   3
         Top             =   1350
         Width           =   2655
      End
      Begin VB.Label lblShowPackingPropertesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Nominal Size"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   420
         TabIndex        =   2
         Top             =   990
         Width           =   2655
      End
      Begin VB.Label lblShowPackingPropertesLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Name"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   180
         TabIndex        =   1
         Top             =   390
         Width           =   735
      End
   End
End
Attribute VB_Name = "frmShowPackingProperties"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
    frmShowPackingProperties.Hide
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()
    
  Call CenterThisForm(Me)
  
  Call LabelsShowPackingPropertiesSI

End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmSplash 
   Appearance      =   0  'Flat
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'Fixed Dialog
   ClientHeight    =   5745
   ClientLeft      =   1695
   ClientTop       =   3645
   ClientWidth     =   9165
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   5745
   ScaleWidth      =   9165
   Begin Threed.SSPanel sspanel_disclaimer 
      Height          =   3795
      Left            =   9210
      TabIndex        =   19
      Top             =   4890
      Width           =   8325
      _Version        =   65536
      _ExtentX        =   14684
      _ExtentY        =   6694
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel SSPanel3 
         Height          =   3075
         Left            =   120
         TabIndex        =   21
         Top             =   570
         Width           =   8085
         _Version        =   65536
         _ExtentX        =   14261
         _ExtentY        =   5424
         _StockProps     =   15
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.Label lblDisclaimer 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            BackStyle       =   0  'Transparent
            Caption         =   "lblDisclaimer"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   2895
            Left            =   90
            TabIndex        =   22
            Top             =   90
            Width           =   7845
         End
      End
      Begin VB.Label lblDisclaimerTitle 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Disclaimer"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   525
         Left            =   60
         TabIndex        =   20
         Top             =   60
         Width           =   8175
      End
   End
   Begin Threed.SSPanel sspanel_logos 
      Height          =   3795
      Left            =   420
      TabIndex        =   4
      Top             =   1170
      Width           =   8325
      _Version        =   65536
      _ExtentX        =   14684
      _ExtentY        =   6694
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel Panel3D3 
         Height          =   825
         Left            =   120
         TabIndex        =   9
         Top             =   900
         Width           =   8055
         _Version        =   65536
         _ExtentX        =   14208
         _ExtentY        =   1455
         _StockProps     =   15
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.Label lbldesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   " "
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   1
            Left            =   120
            TabIndex        =   23
            Top             =   450
            Width           =   2055
         End
         Begin VB.Label lbldesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Model and Software:"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   0
            Left            =   120
            TabIndex        =   12
            Top             =   180
            Width           =   2055
         End
         Begin VB.Label lblAuthors 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "David R. Hokanson     David W. Hand     John C. Crittenden"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   0
            Left            =   2340
            TabIndex        =   11
            Top             =   180
            Width           =   5595
         End
         Begin VB.Label lblAuthors 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Eric J. Oman"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   1
            Left            =   2340
            TabIndex        =   10
            Top             =   450
            Width           =   5595
         End
      End
      Begin VB.PictureBox picLogos 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'None
         ForeColor       =   &H80000008&
         Height          =   1755
         Index           =   0
         Left            =   120
         Picture         =   "Splash.frx":0000
         ScaleHeight     =   1755
         ScaleWidth      =   1815
         TabIndex        =   6
         Top             =   1830
         Width           =   1815
      End
      Begin VB.PictureBox picLogos 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'None
         ForeColor       =   &H80000008&
         Height          =   1755
         Index           =   1
         Left            =   6360
         Picture         =   "Splash.frx":3776
         ScaleHeight     =   1755
         ScaleWidth      =   1815
         TabIndex        =   5
         Top             =   1830
         Width           =   1815
      End
      Begin Threed.SSPanel SSPanel1 
         Height          =   1425
         Left            =   2190
         TabIndex        =   13
         Top             =   2010
         Width           =   3765
         _Version        =   65536
         _ExtentX        =   6641
         _ExtentY        =   2514
         _StockProps     =   15
         Caption         =   "SSPanel1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Version {ver} {STANDARD}"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   0
            Left            =   60
            TabIndex        =   18
            Top             =   120
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Expires on MM/DD/YYYY"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   1
            Left            =   60
            TabIndex        =   17
            Top             =   360
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Copyright {years}"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   2
            Left            =   60
            TabIndex        =   16
            Top             =   600
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Michigan Technological University"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   3
            Left            =   60
            TabIndex        =   15
            Top             =   840
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Houghton, Michigan"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   4
            Left            =   60
            TabIndex        =   14
            Top             =   1080
            Width           =   3645
         End
      End
      Begin VB.Label lblCompany 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "CenCITT"
         ForeColor       =   &H80000008&
         Height          =   225
         Index           =   0
         Left            =   60
         TabIndex        =   8
         Top             =   150
         Width           =   8175
      End
      Begin VB.Label lblCompany 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Center for Clean Industrial and Treatment Technologies"
         ForeColor       =   &H80000008&
         Height          =   225
         Index           =   1
         Left            =   60
         TabIndex        =   7
         Top             =   420
         Width           =   8175
      End
   End
   Begin VB.CommandButton cmdExit 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "E&xit"
      Height          =   525
      Left            =   7440
      TabIndex        =   2
      Top             =   5070
      Width           =   1305
   End
   Begin VB.CommandButton cmdButton2 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "I agree, never show again"
      Height          =   525
      Left            =   1950
      TabIndex        =   1
      Top             =   5070
      Width           =   2535
   End
   Begin VB.CommandButton cmdButton1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "&Continue"
      Height          =   525
      Left            =   420
      TabIndex        =   0
      Top             =   5070
      Width           =   1455
   End
   Begin Threed.SSPanel sspanel_maintitle 
      Height          =   945
      Left            =   420
      TabIndex        =   3
      Top             =   120
      Width           =   8325
      _Version        =   65536
      _ExtentX        =   14684
      _ExtentY        =   1667
      _StockProps     =   15
      Caption         =   "Aeration Simulation Analysis Program (ASAP)"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmSplash"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Private Sub cmdButton1_Click()
  splash_button_pressed = 1
  Unload Me
End Sub

Private Sub cmdButton2_Click()
  splash_button_pressed = 2
  Unload Me
End Sub

Private Sub cmdExit_Click()
  splash_button_pressed = 3
  Unload Me
End Sub

Private Sub Form_Load()
Dim s As String
'Call debug_output("L1")
  Me.Height = 6165
  Me.Width = 9300
  Me.Left = (Screen.Width - Me.Width) / 2
  Me.Top = (Screen.Height - Me.Height) / 2
'Call debug_output("L2")
  If (splash_mode = 0) Then
    'SHOW THE CONTINUE/EXIT FRONT WINDOW.
'Call debug_output("L3")
    cmdButton1.Visible = True
    cmdButton1.Caption = "&Continue"
    cmdButton2.Visible = False
    cmdExit.Visible = True
    'VERSION INFO.
    lblVersionInfo(0).Caption = "Version " & get_program_version_with_build_info()
    'EXPIRATION INFO.
    lblVersionInfo(1).Caption = get_expiration_info()
    'COPYRIGHT INFO.
    lblVersionInfo(2).Caption = "Copyright " & AppCopyrightYears
    'ETC.
    sspanel_disclaimer.Visible = False
    'cmdButton1.SetFocus
    cmdButton1.TabIndex = 0
'Call debug_output("L4")
  End If
  'If (splash_mode = 1) Then
  If (splash_mode = 1) Or (splash_mode = 101) Then
'Call debug_output("L5")
    'SHOW THE DISCLAIMER WINDOW.
    If (splash_mode = 101) Then
      cmdButton1.Visible = False
      cmdButton2.Visible = False
      cmdExit.Visible = True
      cmdExit.Caption = "&Close"
    Else
      cmdButton1.Visible = True
      cmdButton1.Caption = "I Agree"
      cmdButton2.Visible = True
      cmdExit.Visible = True
    End If
    'cmdButton1.Visible = True
    'cmdButton1.Caption = "I Agree"
    'cmdButton2.Visible = True
    'cmdExit.Visible = True
    sspanel_logos.Visible = False
    sspanel_disclaimer.Left = sspanel_logos.Left
    sspanel_disclaimer.Top = sspanel_logos.Top
    sspanel_disclaimer.Visible = True
    s = "By choosing " & Chr$(34) & "I Agree" & Chr$(34) & " you acknowledge that "
    s = s & "this software is under development and not guaranteed to be free "
    s = s & "of errors.  Furthermore there may be errors in the software that "
    s = s & "lead to erroneous output.  MTU shall not be liable for any loss, "
    s = s & "damage, injury, or casualty of whatsoever kind, or by whomsoever "
    s = s & "caused to the person or property of anyone arising out of or "
    s = s & "resulting from receipt and use of any aspect of the software.  "
    s = s & "References to specific commercial products, processes, or services "
    s = s & "by trademark, manufacturer, or otherwise does not necessarily "
    s = s & "constitute or imply endorsement/recommendation by the authors or "
    s = s & "the respective organizations under which the software "
    s = s & "was developed."
    lblDisclaimer.Caption = s
    'cmdButton1.SetFocus
    cmdButton1.TabIndex = 0
'Call debug_output("L6")
  End If
End Sub

Private Sub Form_Unload(Cancel As Integer)
  If (splash_button_pressed = 0) Then
    'If they got here, they must have selected "Close",
    'so perform the exit functionality.
    splash_button_pressed = 3
  End If
End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Begin VB.Form frmSurface 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Surface Aeration"
   ClientHeight    =   6795
   ClientLeft      =   2385
   ClientTop       =   2400
   ClientWidth     =   9480
   Icon            =   "Surface.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   ScaleHeight     =   6795
   ScaleWidth      =   9480
   Begin VB.TextBox txtFlowParameters 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   0
      Left            =   6870
      TabIndex        =   6
      Top             =   90
      Width           =   1215
   End
   Begin VB.ComboBox UnitsFlowParam 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   0
      Left            =   8130
      Style           =   2  'Dropdown List
      TabIndex        =   57
      TabStop         =   0   'False
      Top             =   90
      Width           =   1155
   End
   Begin VB.TextBox txtPowerInput 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Left            =   1830
      TabIndex        =   2
      Top             =   1470
      Width           =   1215
   End
   Begin VB.ComboBox UnitsPowerInput 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   3090
      Style           =   2  'Dropdown List
      TabIndex        =   25
      TabStop         =   0   'False
      Top             =   1470
      Width           =   1275
   End
   Begin VB.CommandButton Command1 
      Appearance      =   0  'Flat
      Caption         =   "Concentration Results"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Left            =   1080
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   6120
      Width           =   2655
   End
   Begin Threed.SSFrame fraOperatingConditions 
      Height          =   1275
      Left            =   60
      TabIndex        =   13
      Top             =   120
      Width           =   4395
      _Version        =   65536
      _ExtentX        =   7752
      _ExtentY        =   2249
      _StockProps     =   14
      Caption         =   "Operating Conditions:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton lblDisplayAirWaterProperties 
         Appearance      =   0  'Flat
         Caption         =   "Display Physical Properties of Water"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   150
         TabIndex        =   22
         TabStop         =   0   'False
         Top             =   900
         Width           =   4155
      End
      Begin VB.TextBox txtOperatingTemperature 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1770
         TabIndex        =   1
         Top             =   540
         Width           =   1215
      End
      Begin VB.TextBox txtOperatingPressure 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   1770
         TabIndex        =   0
         Top             =   240
         Width           =   1215
      End
      Begin VB.ComboBox UnitsOpCond 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3030
         Style           =   2  'Dropdown List
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   240
         Width           =   1275
      End
      Begin VB.ComboBox UnitsOpCond 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3030
         Style           =   2  'Dropdown List
         TabIndex        =   20
         TabStop         =   0   'False
         Top             =   540
         Width           =   1275
      End
      Begin VB.Label lblOperatingTemperature 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Temperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   -990
         TabIndex        =   24
         Top             =   540
         Width           =   2655
      End
      Begin VB.Label lblOperatingPressure 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pressure"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   -990
         TabIndex        =   23
         Top             =   240
         Width           =   2655
      End
   End
   Begin Threed.SSFrame fraOxygen 
      Height          =   1395
      Left            =   60
      TabIndex        =   14
      Top             =   1890
      Width           =   4395
      _Version        =   65536
      _ExtentX        =   7752
      _ExtentY        =   2461
      _StockProps     =   14
      Caption         =   "Oxygen (reference compound):"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboOxygen 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   1350
         Style           =   2  'Dropdown List
         TabIndex        =   29
         TabStop         =   0   'False
         Top             =   300
         Width           =   2955
      End
      Begin VB.TextBox txtOxygen 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   1770
         TabIndex        =   4
         Top             =   1020
         Width           =   1215
      End
      Begin VB.TextBox txtOxygen 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   1770
         TabIndex        =   3
         Top             =   660
         Width           =   1215
      End
      Begin VB.ComboBox UnitsOxygenRef 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3030
         Style           =   2  'Dropdown List
         TabIndex        =   28
         TabStop         =   0   'False
         Top             =   660
         Width           =   1275
      End
      Begin VB.ComboBox UnitsOxygenRef 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3030
         Style           =   2  'Dropdown List
         TabIndex        =   27
         TabStop         =   0   'False
         Top             =   1020
         Width           =   1275
      End
      Begin VB.Label lblOxygenLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa Method:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   30
         TabIndex        =   32
         Top             =   360
         Width           =   1215
      End
      Begin VB.Label lblOxygenLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -990
         TabIndex        =   31
         Top             =   1020
         Width           =   2655
      End
      Begin VB.Label lblOxygenLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Liquid Diffusivity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -990
         TabIndex        =   30
         Top             =   660
         Width           =   2655
      End
   End
   Begin Threed.SSFrame fraContaminantInformation 
      Height          =   2655
      Left            =   60
      TabIndex        =   15
      Top             =   3360
      Width           =   4395
      _Version        =   65536
      _ExtentX        =   7752
      _ExtentY        =   4683
      _StockProps     =   14
      Caption         =   "Design Contaminant:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtDesignConcentrationValue 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   1890
         TabIndex        =   5
         Top             =   2280
         Width           =   1095
      End
      Begin VB.ComboBox cboDesignContaminant 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   210
         Style           =   2  'Dropdown List
         TabIndex        =   39
         TabStop         =   0   'False
         Top             =   480
         Width           =   3975
      End
      Begin VB.CommandButton cmdAddComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Add"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   210
         TabIndex        =   38
         TabStop         =   0   'False
         Top             =   840
         Width           =   1035
      End
      Begin VB.CommandButton cmdDeleteComponent 
         Appearance      =   0  'Flat
         Caption         =   "De&lete"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   1350
         TabIndex        =   37
         TabStop         =   0   'False
         Top             =   840
         Width           =   975
      End
      Begin VB.CommandButton cmdEditComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Edit Properties"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         HelpContextID   =   20
         Left            =   2430
         TabIndex        =   36
         TabStop         =   0   'False
         Top             =   840
         Width           =   1755
      End
      Begin VB.ComboBox UnitsDesignContam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3030
         Style           =   2  'Dropdown List
         TabIndex        =   35
         TabStop         =   0   'False
         Top             =   1380
         Width           =   1275
      End
      Begin VB.ComboBox UnitsDesignContam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3030
         Style           =   2  'Dropdown List
         TabIndex        =   34
         TabStop         =   0   'False
         Top             =   1680
         Width           =   1275
      End
      Begin VB.ComboBox UnitsDesignContam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3030
         Style           =   2  'Dropdown List
         TabIndex        =   33
         TabStop         =   0   'False
         Top             =   2280
         Width           =   1275
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "KLa"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   -750
         TabIndex        =   47
         Top             =   2280
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Influent Conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   -750
         TabIndex        =   46
         Top             =   1380
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Treatment Obj."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -750
         TabIndex        =   45
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentration 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Desired % Removal"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   -750
         TabIndex        =   44
         Top             =   1980
         Width           =   2535
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1890
         TabIndex        =   43
         Top             =   1380
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   1890
         TabIndex        =   42
         Top             =   1680
         Width           =   1095
      End
      Begin VB.Label lblDesignConcentrationValue 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   1890
         TabIndex        =   41
         Top             =   1980
         Width           =   1095
      End
      Begin VB.Shape Shape1 
         Height          =   795
         Left            =   90
         Top             =   420
         Width           =   4215
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( % )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3030
         TabIndex        =   40
         Top             =   1980
         Width           =   1155
      End
   End
   Begin Threed.SSFrame fraTankParameters 
      Height          =   1815
      Left            =   4440
      TabIndex        =   16
      Top             =   510
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   3201
      _StockProps     =   14
      Caption         =   "Tank Parameters"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2430
         TabIndex        =   7
         Top             =   240
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2430
         TabIndex        =   8
         Top             =   540
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2430
         TabIndex        =   9
         Top             =   840
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2430
         TabIndex        =   10
         Top             =   1140
         Width           =   1215
      End
      Begin VB.TextBox txtTankParameters 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2430
         TabIndex        =   11
         Top             =   1440
         Width           =   1215
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   51
         TabStop         =   0   'False
         Top             =   540
         Width           =   1155
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   50
         TabStop         =   0   'False
         Top             =   840
         Width           =   1155
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   49
         TabStop         =   0   'False
         Top             =   1140
         Width           =   1155
      End
      Begin VB.ComboBox UnitsTankParam 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   4
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   48
         TabStop         =   0   'False
         Top             =   1440
         Width           =   1155
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "No. of Tanks (series)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   -390
         TabIndex        =   56
         Top             =   300
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Retention Time (1 Tank)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   -390
         TabIndex        =   55
         Top             =   600
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Retention Time (All Tanks)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   -390
         TabIndex        =   54
         Top             =   900
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Volume (1 Tank)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   -390
         TabIndex        =   53
         Top             =   1200
         Width           =   2715
      End
      Begin VB.Label lblTankParametersLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Volume (All Tanks)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   -390
         TabIndex        =   52
         Top             =   1500
         Width           =   2715
      End
   End
   Begin Threed.SSFrame fraConcentrationResults 
      Height          =   2115
      Left            =   4440
      TabIndex        =   17
      Top             =   2400
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   3731
      _StockProps     =   14
      Caption         =   "Concentration Results:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdConcentrationResults 
         Appearance      =   0  'Flat
         Caption         =   "View Effluent Concentrations from All Tanks"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   90
         TabIndex        =   61
         TabStop         =   0   'False
         Top             =   990
         Width           =   4755
      End
      Begin VB.ComboBox UnitsConcResults 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   60
         TabStop         =   0   'False
         Top             =   630
         Width           =   1155
      End
      Begin VB.ComboBox UnitsConcResults 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   59
         TabStop         =   0   'False
         Top             =   1410
         Width           =   1155
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Compound"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   -150
         TabIndex        =   70
         Top             =   330
         Width           =   1155
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Ci to Tank 1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   -270
         TabIndex        =   69
         Top             =   630
         Width           =   2595
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Ce from Last Tank"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   -270
         TabIndex        =   68
         Top             =   1470
         Width           =   2595
      End
      Begin VB.Label lblConcentrationResultsLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Achieved % Removal"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   -270
         TabIndex        =   67
         Top             =   1830
         Width           =   2595
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1170
         TabIndex        =   66
         Top             =   330
         Width           =   2715
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2430
         TabIndex        =   65
         Top             =   630
         Width           =   1215
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   2430
         TabIndex        =   64
         Top             =   1410
         Width           =   1215
      End
      Begin VB.Label lblConcentrationResults 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2430
         TabIndex        =   63
         Top             =   1770
         Width           =   1215
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( % )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3690
         TabIndex        =   62
         Top             =   1770
         Width           =   1155
      End
   End
   Begin Threed.SSFrame fraPower 
      Height          =   1275
      Left            =   4440
      TabIndex        =   18
      Top             =   4590
      Width           =   4935
      _Version        =   65536
      _ExtentX        =   8705
      _ExtentY        =   2249
      _StockProps     =   14
      Caption         =   "Power Calculation:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtPowerCalculation 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2430
         TabIndex        =   12
         Top             =   240
         Width           =   1215
      End
      Begin VB.ComboBox UnitsPowerCalc 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   72
         TabStop         =   0   'False
         Top             =   600
         Width           =   1155
      End
      Begin VB.ComboBox UnitsPowerCalc 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3690
         Style           =   2  'Dropdown List
         TabIndex        =   71
         TabStop         =   0   'False
         Top             =   900
         Width           =   1155
      End
      Begin VB.Label lblPowerCalculationLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Aerator Motor Efficiency"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   -390
         TabIndex        =   78
         Top             =   300
         Width           =   2715
      End
      Begin VB.Label lblPowerCalculationLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Power Required per Tank"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   -390
         TabIndex        =   77
         Top             =   660
         Width           =   2715
      End
      Begin VB.Label lblPowerCalculationLabel 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Total Power Required"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   -390
         TabIndex        =   76
         Top             =   960
         Width           =   2715
      End
      Begin VB.Label lblPowerCalculation 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2430
         TabIndex        =   75
         Top             =   600
         Width           =   1215
      End
      Begin VB.Label lblPowerCalculation 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2430
         TabIndex        =   74
         Top             =   900
         Width           =   1215
      End
      Begin VB.Label lblMisc 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "( % )"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3690
         TabIndex        =   73
         Top             =   240
         Width           =   1155
      End
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   360
      Top             =   6150
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   327681
   End
   Begin VB.Label lblFlowParametersLabel 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Flow Rate"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   4050
      TabIndex        =   58
      Top             =   150
      Width           =   2715
   End
   Begin VB.Label lblPowerInputLabel 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Power Input, P/V"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   195
      Left            =   -990
      TabIndex        =   26
      Top             =   1530
      Width           =   2715
   End
   Begin VB.Menu mnuFileMenu 
      Caption         =   "&File"
      Begin VB.Menu mnuFile 
         Caption         =   "Switch Modes"
         Index           =   0
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Open"
         Index           =   3
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Save"
         Index           =   4
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Save &As"
         Index           =   5
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   6
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&Print"
         Index           =   7
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &Printer"
            Index           =   0
         End
         Begin VB.Menu mnuFilePrint 
            Caption         =   "To &File"
            Index           =   1
         End
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Select Printer"
         Index           =   8
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   9
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Return to &Main Menu"
         Index           =   10
         Shortcut        =   ^M
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   11
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&1 Old File #1"
         Index           =   191
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&2 Old File #2"
         Index           =   192
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&3 Old File #3"
         Index           =   193
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&4 Old File #4"
         Index           =   194
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   199
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&xit"
         Index           =   200
      End
   End
   Begin VB.Menu mnuUnitsMenu 
      Caption         =   "&Units"
      Begin VB.Menu mnuUnits 
         Caption         =   "Standard International (SI)"
         Index           =   0
      End
      Begin VB.Menu mnuUnits 
         Caption         =   "English"
         Index           =   1
      End
   End
   Begin VB.Menu mnuOptionsMenu 
      Caption         =   "&Results"
      Begin VB.Menu mnuOptions 
         Caption         =   "&View All Concentration Results"
         Index           =   0
      End
   End
   Begin VB.Menu mnuHelp 
      Caption         =   "&Help"
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&Online Help ..."
         Index           =   300
      End
   End
End
Attribute VB_Name = "frmSurface"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim Temp_Text As String
Dim frmSurface_Okay_To_Unload As Boolean



Const frmSurface_declarations_end = True


Private Sub AddPrompt(menuID As Integer, prompt As String)
    menuPrompts(iMenuPrompts).menuID = menuID
    menuPrompts(iMenuPrompts).prompt = prompt
    iMenuPrompts = iMenuPrompts + 1
End Sub

Private Sub cboDesignContaminant_Click()
Dim ContaminantIndex As Integer, i As Integer
Dim PercentRemoval As Double
Dim Dummy As Double

    ContaminantIndex = cboDesignContaminant.ListIndex + 1
    i = ContaminantIndex
    If i = 0 Then Exit Sub
    sur.DesignContaminant = sur.Contaminant(i)

    'Update Design Contaminant | Influent Conc.
    'lblDesignConcentrationValue(0).Caption = Format$(sur.Contaminant(i).Influent.Value, "0.0")
    Call UnitsDesignContam_Click(0)
    ''''Dummy = sur.Contaminant(i).Influent.Value
    ''''Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsDesignContam(0), lblDesignConcentrationValue(0))
    
    'Update Design Contaminant | Treatment Obj.
    'lblDesignConcentrationValue(1).Caption = Format$(sur.Contaminant(i).TreatmentObjective.Value, "0.0")
    Call UnitsDesignContam_Click(1)
    ''''Dummy = sur.Contaminant(i).TreatmentObjective.Value
    ''''Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsDesignContam(1), lblDesignConcentrationValue(1))
    
    'Call the FORTRAN routine.
    Call REMOVBUB(sur.DesiredPercentRemoval, sur.Contaminant(i).Influent.Value, sur.Contaminant(i).TreatmentObjective.Value)
    
    lblDesignConcentrationValue(2).Caption = Format$(sur.DesiredPercentRemoval, "0.0")
    
    lblConcentrationResults(0).Caption = cboDesignContaminant.Text
    
    'Update Concentration Results | Ci to Tank 1.
    'lblConcentrationResults(1).Caption = lblDesignConcentrationValue(0).Caption
    Call UnitsConcResults_Click(1)
    
    'Update Concentration Results | Ce from Last Tank.
    Call UnitsConcResults_Click(3)
    'UPDATED_UNITS

    Call CalculateContaminantMTCoeffSurface
    
    'Update Concentration Results | KLa.
    Call UnitsDesignContam_Click(3)
    
    If SurfaceAerationMode = DESIGN_MODE Then
       Call CalculateRetentionTimeSurface
    End If
    Call CalculateTausAndTankVolumesSurface
    Call CalculateEffluentConcentrationsSurface
    Call CalculatePowerSurface

    'Update Tank Parameters:
    For i = 1 To 4
      Call UnitsTankParam_Click(i)
    Next i

End Sub

Private Sub cboDesignContaminant_GotFocus()
    Temp_Text = cboDesignContaminant.Text
End Sub

Private Sub cboDesignContaminant_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub cboDesignContaminant_LostFocus()
  'Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub cboOxygen_Click()
   
   If cboOxygen.ListIndex = 0 Then   'Clean Water Oxygen Transfer Test Data
      If sur.Oxygen.KLaMethod = 2 Then
         sur.Oxygen.KLaMethod = 1
         Call CalculateOxygenMTCoeffSurface
      End If
   Else
      sur.Oxygen.KLaMethod = 2
      sur.Oxygen.MassTransferCoefficient.UserInput = True
   End If

End Sub

Private Sub cmdAddComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer

  If (sur.NumChemical + 1 > MAXCHEMICAL) Then
     MsgBox "The maximum number of contaminants has been reached.  It is not possible to input more than " & Format$(MAXCHEMICAL, "0") & " contaminants for design.  To add an additional contaminant, another must first be removed.", MB_ICONSTOP, "Surface Aeration"
     cmdAddComponent.Enabled = False
     Exit Sub
  End If

  x.ModelName = "Surface Aeration"
  x.ModelType = MODELTYPE_SURFACE
  x.DoEditNumber = -1       'Will be set by frmContaminantPropertyEdit.
  x.DoAdd = True
  x.OldNumCompo = cboDesignContaminant.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i).Name = sur.Contaminant(i).Name
    x.Contaminants(i).MolecularWeight.Value = sur.Contaminant(i).MolecularWeight.Value
    x.Contaminants(i).HenrysConstant.Value = sur.Contaminant(i).HenrysConstant.Value
    x.Contaminants(i).MolarVolume.Value = sur.Contaminant(i).MolarVolume.Value
    x.Contaminants(i).LiquidDiffusivity.Value = sur.Contaminant(i).LiquidDiffusivity.Value
    x.Contaminants(i).Influent.Value = sur.Contaminant(i).Influent.Value
    x.Contaminants(i).TreatmentObjective.Value = sur.Contaminant(i).TreatmentObjective.Value
  Next i

  StEPPImportSuccess = False
  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (StEPPImportSuccess) Or (Not x.CancelledAdd) Then
    For i = x.OldNumCompo + 1 To x.NewNumCompo
      
      If i > 10 Then
       MsgBox "Unable to continue importing file as maximum amount of chemicals in memory reached."
       Me.Show
       Exit Sub
      End If
      
      'Incorporate new contaminant.
      sur.Contaminant(i).Name = x.Contaminants(i).Name
      sur.Contaminant(i).MolecularWeight.Value = x.Contaminants(i).MolecularWeight.Value
      sur.Contaminant(i).HenrysConstant.Value = x.Contaminants(i).HenrysConstant.Value
      sur.Contaminant(i).MolarVolume.Value = x.Contaminants(i).MolarVolume.Value
      sur.Contaminant(i).LiquidDiffusivity.Value = x.Contaminants(i).LiquidDiffusivity.Value
      sur.Contaminant(i).Influent.Value = x.Contaminants(i).Influent.Value
      sur.Contaminant(i).TreatmentObjective.Value = x.Contaminants(i).TreatmentObjective.Value
      sur.NumChemical = sur.NumChemical + 1
      'Incorporate new name into ComboBox.
      cboDesignContaminant.AddItem sur.Contaminant(i).Name


    Next i
  End If
  
  Call SetDesignContaminantEnabledSurface(CInt(cboDesignContaminant.ListCount))
  
  If (sur.NumChemical > 0) Then
    cmdDeleteComponent.Enabled = True
    cmdEditComponent.Enabled = True
    If (cboDesignContaminant.ListIndex = -1) Then
      cboDesignContaminant.ListIndex = 0
    End If
  End If
  Me.Show
End Sub

Private Sub cmdConcentrationResults_Click()
    frmSurfaceEffluentConcentrations.Show 1

End Sub

Private Sub cmdDeleteComponent_Click()
  Dim i As Integer

  sur.Chemical = cboDesignContaminant.ListIndex + 1
  If (sur.Chemical = 0) Then Exit Sub

  If MsgBox("Remove" & NL & cboDesignContaminant.List(cboDesignContaminant.ListIndex), 36, "") = IDYES Then
    cboDesignContaminant.RemoveItem cboDesignContaminant.ListIndex
    For i = sur.Chemical To sur.NumChemical - 1
      sur.Contaminant(i) = sur.Contaminant(i + 1)
    Next i
    sur.NumChemical = sur.NumChemical - 1
    If (sur.NumChemical > 0) Then
      cboDesignContaminant.ListIndex = 0
    Else
      cmdDeleteComponent.Enabled = False
      cmdEditComponent.Enabled = False
    End If
    Call SetDesignContaminantEnabledSurface(CInt(cboDesignContaminant.ListCount))
  End If

  If sur.NumChemical < 10 Then cmdAddComponent.Enabled = True
End Sub

Private Sub cmdEditComponent_Click()
Dim x As rec_frmContaminantPropertyEdit
Dim i As Integer
Dim AListIndex As Integer

  sur.Chemical = cboDesignContaminant.ListIndex + 1
  If (sur.Chemical = 0) Then Exit Sub

  x.ModelName = "Surface Aeration"
  x.ModelType = MODELTYPE_SURFACE
  x.DoEditNumber = cboDesignContaminant.ListIndex + 1
  x.DoAdd = False
  x.OldNumCompo = cboDesignContaminant.ListCount
  For i = 1 To x.OldNumCompo
    x.Contaminants(i).Name = sur.Contaminant(i).Name
    x.Contaminants(i).MolecularWeight.Value = sur.Contaminant(i).MolecularWeight.Value
    x.Contaminants(i).HenrysConstant.Value = sur.Contaminant(i).HenrysConstant.Value
    x.Contaminants(i).MolarVolume.Value = sur.Contaminant(i).MolarVolume.Value
    x.Contaminants(i).LiquidDiffusivity.Value = sur.Contaminant(i).LiquidDiffusivity.Value
    x.Contaminants(i).Influent.Value = sur.Contaminant(i).Influent.Value
    x.Contaminants(i).TreatmentObjective.Value = sur.Contaminant(i).TreatmentObjective.Value
  Next i

  Data_frmContaminantPropertyEdit = x
  frmContaminantPropertyEdit.Show 1
  x = Data_frmContaminantPropertyEdit

  If (Not x.CancelledEdit) Then
    For i = 1 To x.NewNumCompo
      sur.Contaminant(i).Name = x.Contaminants(i).Name
      sur.Contaminant(i).MolecularWeight.Value = x.Contaminants(i).MolecularWeight.Value
      sur.Contaminant(i).HenrysConstant.Value = x.Contaminants(i).HenrysConstant.Value
      sur.Contaminant(i).MolarVolume.Value = x.Contaminants(i).MolarVolume.Value
      sur.Contaminant(i).LiquidDiffusivity.Value = x.Contaminants(i).LiquidDiffusivity.Value
      sur.Contaminant(i).Influent.Value = x.Contaminants(i).Influent.Value
      sur.Contaminant(i).TreatmentObjective.Value = x.Contaminants(i).TreatmentObjective.Value
    Next i
    If (x.OldNumCompo < x.NewNumCompo) Then
      'Incorporate new names into ComboBox.
      For i = x.OldNumCompo + 1 To x.NewNumCompo
        cboDesignContaminant.AddItem sur.Contaminant(i).Name
      Next i
    End If
    'Update ComboBox for any changed names:
    For i = 1 To x.OldNumCompo
      If (Trim$(cboDesignContaminant.List(i - 1)) <> Trim$(sur.Contaminant(i).Name)) Then
        cboDesignContaminant.List(i - 1) = Trim$(sur.Contaminant(i).Name)
      End If
    Next i
  Else
     Exit Sub
  End If

  'Generate click event on cboDesignContaminant
  AListIndex = cboDesignContaminant.ListIndex
  cboDesignContaminant.ListIndex = -1
  cboDesignContaminant.ListIndex = AListIndex

End Sub

Private Sub cmdSelectContaminants_Click()
    'frmListContaminantSurface.Show 1
End Sub

Private Sub Command1_Click()
Call surface_results
End Sub

Private Sub Form_Activate()
'    Dim hMenu       As Integer
'    Dim hSubMenu    As Integer
'
''Initialize MsgHook and Load Menu Prompts to Display on Status Bar
'    imenuprompts = 0
'
'    MsgHook1.HwndHook = Me.hWnd
'    MsgHook1.Message(WM_MENUSELECT) = True
'    hMenu = GetMenu(Me.hWnd)
'    '
'    ' Load File menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 0)
'    AddPrompt hSubMenu, "File operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Switch modes for surface aeration"
'    AddPrompt GetMenuItemID(hSubMenu, 2), "Load a design case from a file"
'    AddPrompt GetMenuItemID(hSubMenu, 3), "Save this design case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 4), "Save this design case to a file"
'    AddPrompt GetMenuItemID(hSubMenu, 6), "Print this design case"
'    AddPrompt GetMenuItemID(hSubMenu, 7), "Select printer for printing results"
'    AddPrompt GetMenuItemID(hSubMenu, 9), "Leave surface aeration and return to main ASAP menu"
'    AddPrompt GetMenuItemID(hSubMenu, 11), "Exit program"
'
'    '
'    ' Load Units menu prompts
'    '
'    hSubMenu = GetSubMenu(hMenu, 1)
'    AddPrompt hSubMenu, "Units operations"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "Display results in Standard International (SI) units"
'    AddPrompt GetMenuItemID(hSubMenu, 1), "Display results in English units"
'    '
'    ' Load Options menu prompt
'    '
'    hSubMenu = GetSubMenu(hMenu, 2)
'    AddPrompt hSubMenu, "Options"
'    AddPrompt GetMenuItemID(hSubMenu, 0), "View Effluent Concentration Results for All Contaminants"

    'Initialize last-few-files list.
    Call frmSurface_InitializeLastFewFilesList

End Sub

Private Sub Form_Load()
    Dim i As Integer

    frmSurface_Okay_To_Unload = False
    sur.NumChemical = 0
    frmSurface.WindowState = 0
    frmSurface.Width = SCREEN_WIDTH_STANDARD
    frmSurface.Height = SCREEN_HEIGHT_STANDARD
    'StatusMessagePanel.BackColor = &HC0C0C0
    'StatusMessagePanel.ForeColor = &H400040
    'StatusBarPanel.BackColor = &HC0C0C0
    'StatusBarPanel.ForeColor = &H400040
    


    'Center the form on the screen
    If WindowState = 0 Then
       'don't attempt if screen Minimized or Maximized
       Move (Screen.Width - frmSurface.Width) / 2, (Screen.Height - frmSurface.Height) / 2
    End If


    'Initialize Labels on frmSurface
    Call LabelsSurface(UNITSTYPE_SI)


    'Load KLa Method Combo box
    cboOxygen.AddItem "Roberts & Dandliker Corr."
    cboOxygen.AddItem "User Input"


    Load frmWaterPropertiesSurface
    


End Sub

Private Sub frmSurface_InitializeLastFewFilesList()

  'Initialize last-few-files list.
  Select Case SurfaceAerationMode
    Case DESIGN_MODE:
      Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ASAP, LASTFEW_ASAP_frmSurface_DESIGN)
    Case RATING_MODE:
      Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ASAP, LASTFEW_ASAP_frmSurface_RATING)
  End Select

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  If (frmSurface_Okay_To_Unload) Then
    Cancel = False
  Else
    Cancel = True
  End If
End Sub

Private Sub lblDisplayAirWaterProperties_Click()
    If HaveValue(sur.OperatingPressure.Value) And HaveValue(sur.operatingtemperature.Value) Then
       frmWaterPropertiesSurface.Show 1
    Else
       MsgBox "You must specify pressure and temperature before physical properties can be displayed.", MB_ICONSTOP, "Error"
    End If
End Sub

Private Sub mnuFile_Click(Index As Integer)
    Dim i As Integer
    Dim msg As String, response As Integer

    Screen.MousePointer = 11   'Hourglass
    Select Case Index
       Case 0   'Switch Surface Aeration Modes
          Select Case SurfaceAerationMode
             
             Case DESIGN_MODE   'Switch to Rating Mode
                If lblConcentrationResults(4).Caption <> "" Then
                   'Give user option to save design mode before
                   'switching to rating mode
                   msg = "Would you like to save the parameters "
                   msg = msg + "for this design case to a file "
                   msg = msg + "before switching to Rating "
                   msg = msg + "Mode?"
                   response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "Save Current Design")
                   If response = IDYES Then
                      Call SaveSurface
                   End If

                   frmSurface.Caption = "Surface Aeration - Rating Mode (untitled.sur)"
                   frmSurface!mnuFile(0).Caption = "Switch to &Design Mode"
                   SurfaceAerationMode = RATING_MODE
                
                   'Initialize last-few-files list.
                   Call frmSurface_InitializeLastFewFilesList
                   
                   sur.TankVolume.UserInput = True
                   For i = 1 To 4
                       frmSurface!txtTankParameters(i).Enabled = True
                   Next i
                   Call CalculateMinAirToWaterRatio
                Else
                   SurfaceAerationMode = RATING_MODE
                   Filename$ = "TheDefaultCaseSurface"
                   Call loadsurface("")
                End If

             Case RATING_MODE   'Switch to Design Mode
                If lblConcentrationResults(4).Caption <> "" Then
                   'Give user option to save rating mode before
                   'switching to design mode
                   msg = "Would you like to save the parameters "
                   msg = msg + "for this rating case to a file "
                   msg = msg + "before switching to Design "
                   msg = msg + "Mode?"
                   response = MsgBox(msg, MB_ICONquestion + MB_YESNO, "Save Current Design")
                   If response = IDYES Then
                      Call SaveSurface
                   End If
    
                   frmSurface.Caption = "Surface Aeration - Design Mode (untitled.sur)"
                   frmSurface!mnuFile(0).Caption = "Switch to &Rating Mode"
                   SurfaceAerationMode = DESIGN_MODE
                   
                   'Initialize last-few-files list.
                   Call frmSurface_InitializeLastFewFilesList
                   
                   sur.CodeForTausAndTankVolumes = 1
                   Call CalculateRetentionTimeSurface
                   Call CalculateTausAndTankVolumesSurface
                   For i = 1 To 4
                       frmSurface!txtTankParameters(i).Enabled = False
                   Next i
                   Call CalculateEffluentConcentrationsSurface
                Else
                   SurfaceAerationMode = DESIGN_MODE
                   Filename$ = "TheDefaultCaseSurface"
                   Call loadsurface("")
                End If
          End Select

       Case 3   'Open
          If frmSurface!lblConcentrationResults(4).Caption <> "" Then
            If (surface_savechanges()) Then Exit Sub
          End If
          
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          Call loadsurface("")
            
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)

          SaveAndLoadPath = CurDir$
          ''''ChDir App.Path
          ''''ChDrive App.Path
          Call ChangeDir_Main

       Case 4   'Save
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          Call SaveSurface
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)

          SaveAndLoadPath = CurDir$
          ''''ChDir App.Path
          ''''ChDrive App.Path
          Call ChangeDir_Main

       Case 5   'Save As
          ''''ChDrive SaveAndLoadPath
          ''''ChDir SaveAndLoadPath
          Call ChangeDir_Main
          If Right$(frmSurface.Caption, 14) <> "(untitled.sur)" Then Call savefilesurface(Filename)
          Call SaveSurface
          
          'Add this file to the last-few-files list if necessary.
          Call LastFewFiles_MoveFilenameToTop(Filename)

          SaveAndLoadPath = CurDir$
          ''''ChDir App.Path
          ''''ChDrive App.Path
          Call ChangeDir_Main

       Case 7   'Print
          

       Case 8   'Select Printer
            On Error GoTo PrinterError
            ''''CMDialog1.flags = PD_PRINTSETUP
            ''''CMDialog1.Action = 5
            CommonDialog1.ShowPrinter
            GoTo ExitSelectPrint:
PrinterError:
            Resume ExitSelectPrint:

ExitSelectPrint:

        Case 10   'Return To Main Menu
            
            If frmSurface!lblConcentrationResults(4).Caption <> "" Then
              If (surface_savechanges()) Then Exit Sub
            End If
            
            'Unload Forms for Surface Aeration
            frmSurface_Okay_To_Unload = True
            Unload frmSurface
            Unload frmSurfaceEffluentConcentrations
            'Unload frmListContaminantSurface
            'Unload frmPropContaminantSurface
            Unload frmWaterPropertiesSurface
            
            frmMainMenu.Show
            
        
        Case 200   'Exit
            'Give user option to save design mode before Exiting

            If frmSurface!lblConcentrationResults(4).Caption <> "" Then
              If (surface_savechanges()) Then Exit Sub
            End If

            'Unload Forms for Surface Aeration
            frmSurface_Okay_To_Unload = True
            Unload frmSurface
            Unload frmSurfaceEffluentConcentrations
            'Unload frmListContaminantSurface
            'Unload frmPropContaminantSurface
            Unload frmWaterPropertiesSurface
            Unload frmMainMenu
            End
       
    End Select

    If ((Index >= 191) And (Index <= 194)) Then
      'Handle File|Open of a file here.
      ''''ChDrive SaveAndLoadPath
      ''''ChDir SaveAndLoadPath
      Call ChangeDir_Main
      If (Dir(Current_LastFewFilesRec.FileNames(Index - 190)) = "") Then
        Beep
        MsgBox "That file has been moved or deleted.", MB_ICONEXCLAMATION, Application_Name
      Else
        Call loadsurface(Current_LastFewFilesRec.FileNames(Index - 190))
        'Add this file to the last-few-files list if necessary.
        Call LastFewFiles_MoveFilenameToTop(Filename)
        SaveAndLoadPath = CurDir$
      End If
      ''''ChDrive App.Path
      ''''ChDir App.Path
      Call ChangeDir_Main
    End If
    
    Screen.MousePointer = 0   'Arrow

End Sub

Private Sub mnuFilePrint_Click(Index As Integer)

    Select Case Index
       Case 0   'Print to printer
          Call PrintSurface
       Case 1   'Print to file
          Call PrintSurfaceToFile
    End Select

End Sub

Private Sub mnuHelpItem_Click(Index As Integer)
  Select Case Index
    'Case 10:
    '  frmabout2.Show 1
    'Case 99:
    '  frmAbout.Show 1
    Case 300:
      Call Launch_ASAP_HLP_File
  End Select
End Sub

Private Sub mnuOptions_Click(Index As Integer)
Call surface_results

End Sub

Private Sub mnuotheritem_Click()
'frmabout2.Show 1
End Sub

Private Sub mnuUnits_Click(Index As Integer)
  
  Select Case Index
    Case 0        'SI
      Call LabelsSurface(UNITSTYPE_SI)
    Case 1        'English
      Call LabelsSurface(UNITSTYPE_ENGLISH)
  End Select

End Sub

Private Sub MsgHook1_Message(msg As Integer, wParam As Integer, lParam As Long, Action As Integer, result As Long)
'    Dim i       As Integer
'    Dim found   As Integer
'
'    '
'    ' Got a menu select message ... see if it's for one of our menus
'    '
'    For i = 0 To iMenuPrompts - 1
'        If (menuPrompts(i).menuID = wParam) Then
'            '
'            ' One of our menus ... display prompt message
'            '
'            StatusMessagePanel.Caption = menuPrompts(i).prompt
'            found = True
'            Exit For
'        End If
'    Next
'    '
'    ' Blank prompt message when no menu selected
'    '
'    If (found <> True) Then
'        StatusMessagePanel.Caption = ""
'    End If
'
End Sub

Private Sub Old_HelpTipTimer_Timer()
''temp kill
'Exit Sub
''''''''''''''''''''''''
'
' Dim PointStruct As PointType
' Static PrevioushWnd%
' Dim CurrenthWnd As Integer, TipText As String
'
'If GetActiveWindow() = Me.hWnd Then
'  Call GetCursorPos(PointStruct)
'  CurrenthWnd% = WindowFromPoint(PointStruct.Y, PointStruct.x)
'  If CurrenthWnd <> PrevioushWnd% Then
'    PrevioushWnd% = CurrenthWnd
'    'HelpTipTimer.Interval = 1
'    Select Case CurrenthWnd%
'      Case txtOperatingPressure.hWnd    '<---- Here for the text box txtOperatingPressure
'       StatusMessagePanel.Caption = " Input Operating " & lblOperatingPressure.Caption
'      Case txtOperatingTemperature.hWnd   '<---- Here for the text box txtOperatingTemperature
'       StatusMessagePanel.Caption = " Input Operating " & lblOperatingTemperature.Caption
'      Case lblDisplayAirWaterProperties.hWnd
'       StatusMessagePanel.Caption = " Specify water density, viscosity, and surface tension; and air density and viscosity"
'    End Select
'    ShowHelpTip TipText$
'    If Len(TipText$) = 0 Then
'      'HelpTipTimer.Interval = 500 'Milliseconds
'    End If
'  End If
'End If
'
End Sub

Private Sub txtDesignConcentrationValue_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtDesignConcentrationValue(Index), Temp_Text)
End Sub

Private Sub txtDesignConcentrationValue_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtDesignConcentrationValue_LostFocus(Index As Integer)
    Dim ValueChanged As Integer, Dummy As Double
    Dim msg As String
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtDesignConcentrationValue(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True


    Call TextHandleError(IsError, txtDesignConcentrationValue(Index), Temp_Text)

    If Not IsError Then
       Dummy = CDbl(txtDesignConcentrationValue(Index).Text)
       Select Case Index
          Case 3    'Contaminant Mass Transfer Coefficient
             Call TextNumberChanged(ValueChanged, txtDesignConcentrationValue(3), Temp_Text)
             If ValueChanged Then
                If HaveValue(Dummy) Then
                   sur.ContaminantMassTransferCoefficient.Value = Dummy
                   sur.ContaminantMassTransferCoefficient.ValChanged = True
                   sur.ContaminantMassTransferCoefficient.UserInput = True
                Else
                   txtDesignConcentrationValue(3).Text = Temp_Text
                   txtDesignConcentrationValue(3).SetFocus
                   Exit Sub
                End If
             End If

       End Select

       If ValueChanged Then
          If SurfaceAerationMode = DESIGN_MODE Then
             Call CalculateRetentionTimeSurface
             Call CalculateTausAndTankVolumesSurface
          End If

          Call CalculateEffluentConcentrationsSurface
          Call CalculatePowerSurface
       End If

    End If
  Call LostFocus_Handle(Me, txtDesignConcentrationValue(Index), flag_ok)


End Sub

Private Sub txtFlowParameters_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtFlowParameters(Index), Temp_Text)
End Sub

Private Sub txtFlowParameters_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtFlowParameters_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtFlowParameters(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True


  If (Unitted_LostFocus(UNITS_FLOW, txtFlowParameters(0), UnitsFlowParam(0), NewVal, Temp_Text)) Then
    sur.WaterFlowRate.ValChanged = True
    sur.WaterFlowRate.UserInput = True
    sur.WaterFlowRate.Value = NewVal
    Call CalculateRetentionTimesAndTankVolumes

    If (SurfaceAerationMode = DESIGN_MODE) Then
      Call CalculateRetentionTimeSurface
      Call CalculateTausAndTankVolumesSurface
    Else
      Call CalculateTausAndTankVolumesSurface
    End If
    Call CalculateEffluentConcentrationsSurface
  End If
  Call LostFocus_Handle(Me, txtFlowParameters(Index), flag_ok)


End Sub

Private Sub txtOperatingPressure_GotFocus()
  
    
  Call GotFocus_Handle(Me, txtOperatingPressure, Temp_Text)

End Sub

Private Sub txtOperatingPressure_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingPressure_LostFocus()
Dim NewVal As Double
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingPressure)) Then
     Exit Sub
   End If
   
   flag_ok = True


  If (Unitted_LostFocus(UNITS_PRESSURE, txtOperatingPressure, UnitsOpCond(0), NewVal, Temp_Text)) Then
    sur.OperatingPressure.ValChanged = True
    sur.OperatingPressure.UserInput = True
    'Note: standard P units are Pa, but
    'OperatingPressure is stored as kPa.
    sur.OperatingPressure.Value = NewVal * 1# / 101325#

    If (HaveValue(sur.OperatingPressure.Value) And HaveValue(sur.operatingtemperature.Value)) Then
      Call CalculateWaterPropertiesSurface
      If sur.NumChemical > 0 Then
        'Update Variables on Screen
      End If
    End If
  End If
  Call LostFocus_Handle(Me, txtOperatingPressure, flag_ok)


End Sub

Private Sub txtOperatingTemperature_GotFocus()
    
  Call GotFocus_Handle(Me, txtOperatingTemperature, Temp_Text)
End Sub

Private Sub txtOperatingTemperature_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOperatingTemperature_LostFocus()
Dim NewVal As Double
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOperatingTemperature)) Then
     Exit Sub
   End If
   
   flag_ok = True


  If (Unitted_LostFocus(UNITS_TEMPERATURE, txtOperatingTemperature, UnitsOpCond(1), NewVal, Temp_Text)) Then
    sur.operatingtemperature.ValChanged = True
    sur.operatingtemperature.UserInput = True
    sur.operatingtemperature.Value = NewVal

    If (HaveValue(sur.OperatingPressure.Value) And HaveValue(sur.operatingtemperature.Value)) Then
      Call CalculateWaterPropertiesSurface
      Call CalculateOxygenLiquidDiffSurface
      If cboOxygen.ListIndex = 0 Then
        Call CalculateOxygenMTCoeffSurface
      End If
         
      If (sur.NumChemical > 0) Then
        Call CalculateContaminantMTCoeffSurface
        If SurfaceAerationMode = DESIGN_MODE Then
          Call CalculateRetentionTimeSurface
          Call CalculateTausAndTankVolumesSurface
        End If
        Call CalculateEffluentConcentrationsSurface
        Call CalculatePowerSurface
      End If
    End If
  End If
  Call LostFocus_Handle(Me, txtOperatingTemperature, flag_ok)
                               
End Sub

Private Sub txtOxygen_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtOxygen(Index), Temp_Text)
End Sub

Private Sub txtOxygen_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtOxygen_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtOxygen(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True


  IsNew = False
  
  Select Case Index
    Case 1        'Liquid Diffusivity.
      If (Unitted_LostFocus(UNITS_DIFFUSIVITY, txtOxygen(1), UnitsOxygenRef(1), NewVal, Temp_Text)) Then
        IsNew = True
        sur.Oxygen.LiquidDiffusivity.Value = NewVal
        sur.Oxygen.LiquidDiffusivity.ValChanged = True
        sur.Oxygen.LiquidDiffusivity.UserInput = True
      End If

    Case 2        'KLa.
      If (Unitted_LostFocus(UNITS_INVERSETIME, txtOxygen(2), UnitsOxygenRef(2), NewVal, Temp_Text)) Then
        IsNew = True
        sur.Oxygen.MassTransferCoefficient.Value = NewVal
        sur.Oxygen.MassTransferCoefficient.ValChanged = True
        sur.Oxygen.MassTransferCoefficient.UserInput = True
      End If
    
  End Select

  If (IsNew) Then
    Select Case Index
      Case 1
        If HaveValue(sur.OperatingPressure.Value) And HaveValue(sur.operatingtemperature.Value) And HaveValue(sur.Oxygen.LiquidDiffusivity.Value) Then
          If sur.NumChemical > 0 Then
            Call CalculateContaminantMTCoeffSurface
            If SurfaceAerationMode = DESIGN_MODE Then
              Call CalculateRetentionTimeSurface
              Call CalculateTausAndTankVolumesSurface
            End If
            Call CalculateEffluentConcentrationsSurface
            Call CalculatePowerSurface
          End If
        End If
      
      Case 2
        If HaveValue(sur.OperatingPressure.Value) And HaveValue(sur.operatingtemperature.Value) And HaveValue(sur.Oxygen.LiquidDiffusivity.Value) And HaveValue(sur.Oxygen.MassTransferCoefficient.Value) Then
          If sur.NumChemical > 0 Then
            Call CalculateContaminantMTCoeffSurface
            If SurfaceAerationMode = DESIGN_MODE Then
              Call CalculateRetentionTimeSurface
              Call CalculateTausAndTankVolumesSurface
            End If
            Call CalculateEffluentConcentrationsSurface
            Call CalculatePowerSurface
          End If
        End If
        If cboOxygen.ListIndex = 0 Then cboOxygen.ListIndex = 1
    
    End Select
  End If
  Call LostFocus_Handle(Me, txtOxygen(Index), flag_ok)


End Sub

Private Sub txtPowerCalculation_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtPowerCalculation(Index), Temp_Text)
End Sub

Private Sub txtPowerCalculation_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtPowerCalculation_LostFocus(Index As Integer)
    Dim Answer As Integer, response As Integer
    Dim msg As String
    Dim ValueChanged As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtPowerCalculation(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True


    Call TextHandleError(IsError, txtPowerCalculation(0), Temp_Text)
    If Not IsError Then
       If Not HaveValue(CDbl(txtPowerCalculation(0).Text)) Then
          txtPowerCalculation(0).Text = Temp_Text
          txtPowerCalculation(0).SetFocus
          Exit Sub
       End If
       
       Call TextNumberChanged(ValueChanged, txtPowerCalculation(0), Temp_Text)

       If ValueChanged Then
          sur.Power.AeratorMotorEfficiency = CDbl(txtPowerCalculation(0).Text)
       Else
         Call LostFocus_Handle(Me, txtPowerCalculation(Index), flag_ok)
          Exit Sub
       End If

       Call CalculatePowerSurface

    End If
  Call LostFocus_Handle(Me, txtPowerCalculation(Index), flag_ok)


End Sub

Private Sub txtPowerInput_GotFocus()
    
  Call GotFocus_Handle(Me, txtPowerInput, Temp_Text)
End Sub

Private Sub txtPowerInput_KeyPress(KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtPowerInput_LostFocus()
Dim NewVal As Double
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtPowerInput)) Then
     Exit Sub
   End If
   
   flag_ok = True


  If (Unitted_LostFocus(UNITS_PRESSURE, txtPowerInput, UnitsPowerInput, NewVal, Temp_Text)) Then
    sur.PowerInput_PoverV.ValChanged = True
    sur.PowerInput_PoverV.UserInput = True
    sur.PowerInput_PoverV.Value = NewVal

    Call CalculateOxygenLiquidDiffSurface
    If cboOxygen.ListIndex = 0 Then
      Call CalculateOxygenMTCoeffSurface
    End If
         
    If sur.NumChemical > 0 Then
      Call CalculateContaminantMTCoeffSurface
      If SurfaceAerationMode = DESIGN_MODE Then
        Call CalculateRetentionTimeSurface
        Call CalculateTausAndTankVolumesSurface
      End If
      Call CalculateEffluentConcentrationsSurface
      Call CalculatePowerSurface
    End If

  End If
  Call LostFocus_Handle(Me, txtPowerInput, flag_ok)

    
End Sub

Private Sub txtTankParameters_Change(Index As Integer)

'  Call UnitsTankParam_Click(Index)

End Sub

Private Sub txtTankParameters_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtTankParameters(Index), Temp_Text)
End Sub

Private Sub txtTankParameters_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtTankParameters_LostFocus(Index As Integer)
Dim NewVal As Double
Dim IsNew As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtTankParameters(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True


  IsNew = False
  
  Select Case Index
    Case 0        'Number of Tanks in Series.
      If (NoUnits_LostFocus(txtTankParameters(0), NewVal, Temp_Text)) Then
        IsNew = True
        If (NewVal > MAXIMUM_TANKS) Then
          MsgBox "The number of tanks specified exceeds the maximum number of tanks allowed in the program.  The number of tanks must be less than or equal to " & Format$(MAXIMUM_TANKS, "0") & ".", MB_ICONSTOP, "Bubble Aeration"
          txtTankParameters(0).Text = Temp_Text
          txtTankParameters(0).SetFocus
          Exit Sub
        End If

        sur.NumberOfTanks.ValChanged = True
        sur.NumberOfTanks.UserInput = True
        sur.NumberOfTanks.Value = NewVal
       
        If SurfaceAerationMode = DESIGN_MODE Then
          Call CalculateRetentionTimeSurface
          Call CalculateTausAndTankVolumesSurface
        Else
          Call CalculateTausAndTankVolumesSurface
        End If
      End If

    Case 1        'Retention Time for 1 Tank.
      If (Unitted_LostFocus(UNITS_TIME, txtTankParameters(1), UnitsTankParam(1), NewVal, Temp_Text)) Then
        IsNew = True
        'Standard time units are seconds, but TankHydraulicRetentionTime
        'is stored internally as hours.
        sur.TankHydraulicRetentionTime.Value = NewVal / 60# / 60#
        sur.TankHydraulicRetentionTime.ValChanged = True
        sur.TankHydraulicRetentionTime.UserInput = True
        sur.CodeForTausAndTankVolumes = 1
        Call CalculateTausAndTankVolumesSurface
      End If
        
    Case 2        'Retention Time for All Tanks.
      If (Unitted_LostFocus(UNITS_TIME, txtTankParameters(2), UnitsTankParam(2), NewVal, Temp_Text)) Then
        IsNew = True
        'Standard time units are seconds, but TotalHydraulicRetentionTime
        'is stored internally as hours.
        sur.TotalHydraulicRetentionTime.Value = NewVal / 60# / 60#
        sur.TotalHydraulicRetentionTime.ValChanged = True
        sur.TotalHydraulicRetentionTime.UserInput = True
        sur.CodeForTausAndTankVolumes = 2
        Call CalculateTausAndTankVolumesSurface
      End If

    Case 3        'Volume of Each Tank.
      If (Unitted_LostFocus(UNITS_VOLUME, txtTankParameters(3), UnitsTankParam(3), NewVal, Temp_Text)) Then
        IsNew = True
        sur.TankVolume.Value = NewVal
        sur.TankVolume.ValChanged = True
        sur.TankVolume.UserInput = True
        sur.CodeForTausAndTankVolumes = 3
        Call CalculateTausAndTankVolumesSurface
      End If

    Case 4        'Volume of All Tanks.
      If (Unitted_LostFocus(UNITS_VOLUME, txtTankParameters(4), UnitsTankParam(4), NewVal, Temp_Text)) Then
        IsNew = True
        sur.TotalTankVolume.Value = NewVal
        sur.TotalTankVolume.ValChanged = True
        sur.TotalTankVolume.UserInput = True
        sur.CodeForTausAndTankVolumes = 4
        Call CalculateTausAndTankVolumesSurface
      End If

  End Select

  If (IsNew) Then
    Call CalculateEffluentConcentrationsSurface
    Call CalculatePowerSurface
    Call cboDesignContaminant_Click
  End If
  Call LostFocus_Handle(Me, txtTankParameters(Index), flag_ok)


End Sub

Private Sub UnitsConcResults_Click(Index As Integer)
Dim Dummy As Double
Dim ContaminantIndex As Integer
Dim i As Integer

  ContaminantIndex = cboDesignContaminant.ListIndex + 1
  i = ContaminantIndex

  On Error GoTo err_UnitsConcResults_Click

  Select Case Index
    Case 1            'Ci to Tank 1.
      Dummy = sur.Contaminant(i).Influent.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsConcResults(1), lblConcentrationResults(1))

    Case 3            'Ce from Last Tank.
      Dummy = sur.DesignContaminant.Effluent(sur.NumberOfTanks.Value)
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsConcResults(3), lblConcentrationResults(3))

  End Select

exit_UnitsConcResults_Click:
  Exit Sub

err_UnitsConcResults_Click:
  Resume exit_UnitsConcResults_Click

End Sub

Private Sub UnitsConcResults_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsDesignContam_Click(Index As Integer)
Dim Dummy As Double
Dim ContaminantIndex As Integer
Dim i As Integer

  ContaminantIndex = cboDesignContaminant.ListIndex + 1
  i = ContaminantIndex

  On Error GoTo err_UnitsDesignContam_Click

  Select Case Index
    Case 0            'Influent Conc.
      Dummy = sur.Contaminant(i).Influent.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsDesignContam(0), lblDesignConcentrationValue(0))

    Case 1            'Treatment Obj.
      Dummy = sur.Contaminant(i).TreatmentObjective.Value
      Call Unitted_UnitChange(UNITS_CONCENTRATION, Dummy, UnitsDesignContam(1), lblDesignConcentrationValue(1))

    Case 3            'KLa
      Dummy = sur.ContaminantMassTransferCoefficient.Value
      Call Unitted_UnitChange(UNITS_INVERSETIME, Dummy, UnitsDesignContam(3), txtDesignConcentrationValue(3))

  End Select

exit_UnitsDesignContam_Click:
  Exit Sub

err_UnitsDesignContam_Click:
  Resume exit_UnitsDesignContam_Click

End Sub

Private Sub UnitsDesignContam_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsFlowParam_Click(Index As Integer)

  Select Case Index
    Case 0            'Water Flow Rate.
      Call Unitted_UnitChange(UNITS_FLOW, sur.WaterFlowRate.Value, UnitsFlowParam(0), txtFlowParameters(0))
  End Select

End Sub

Private Sub UnitsFlowParam_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsOpCond_Click(Index As Integer)
Dim Dummy As Double

  Select Case Index
    Case 0
      'Note: Standard P units are Pa, but OperatingPressure
      'is stored internally in kPa units.
      Dummy = sur.OperatingPressure.Value * 101325#
      Call Unitted_UnitChange(UNITS_PRESSURE, Dummy, UnitsOpCond(0), txtOperatingPressure)

    Case 1
      Call Unitted_UnitChange(UNITS_TEMPERATURE, sur.operatingtemperature.Value, UnitsOpCond(1), txtOperatingTemperature)
    
  End Select

End Sub

Private Sub UnitsOpCond_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsOxygenRef_Click(Index As Integer)

  Select Case Index
    Case 1            'Liquid Diffusivity
      Call Unitted_UnitChange(UNITS_DIFFUSIVITY, sur.Oxygen.LiquidDiffusivity.Value, UnitsOxygenRef(1), txtOxygen(1))

    Case 2            'KLa
      Call Unitted_UnitChange(UNITS_INVERSETIME, sur.Oxygen.MassTransferCoefficient.Value, UnitsOxygenRef(2), txtOxygen(2))
    
  End Select

End Sub

Private Sub UnitsOxygenRef_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsPowerCalc_Click(Index As Integer)
Dim Dummy As Double
Dim ContaminantIndex As Integer
Dim i As Integer

  ContaminantIndex = cboDesignContaminant.ListIndex + 1
  i = ContaminantIndex

  On Error GoTo err_UnitsPowerCalc_Change

  Select Case Index
    Case 1            'Power Required per Tank.
      Dummy = sur.Power.PowerForEachTank
      Call Unitted_UnitChange(UNITS_POWER, Dummy, UnitsPowerCalc(1), lblPowerCalculation(1))

    Case 2            'Total Power Required.
      Dummy = sur.Power.TotalPowerForAllTanks
      Call Unitted_UnitChange(UNITS_POWER, Dummy, UnitsPowerCalc(2), lblPowerCalculation(2))

  End Select

exit_UnitsPowerCalc_Change:
  Exit Sub

err_UnitsPowerCalc_Change:
  Resume exit_UnitsPowerCalc_Change

End Sub

Private Sub UnitsPowerCalc_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub

Private Sub UnitsPowerInput_Click()
Dim Dummy As Double

  Dummy = sur.PowerInput_PoverV.Value
  Call Unitted_UnitChange(UNITS_POWERPERVOLUME, Dummy, UnitsPowerInput, txtPowerInput)

End Sub

Private Sub UnitsTankParam_Click(Index As Integer)
Dim Dummy As Double

  Select Case Index
    Case 1            'Retention Time (1 Tank).
      'Standard time units are seconds, but TankHydraulicRetentionTime
      'is stored internally as hours.
      Dummy = sur.TankHydraulicRetentionTime.Value * 60 * 60#
      Call Unitted_UnitChange(UNITS_TIME, Dummy, UnitsTankParam(1), txtTankParameters(1))

    Case 2            'Retention Time (All Tanks).
      'Standard time units are seconds, but TotalHydraulicRetentionTime
      'is stored internally as hours.
      Dummy = sur.TotalHydraulicRetentionTime.Value * 60 * 60#
      Call Unitted_UnitChange(UNITS_TIME, Dummy, UnitsTankParam(2), txtTankParameters(2))

    Case 3            'Volume (1 Tank).
      Call Unitted_UnitChange(UNITS_VOLUME, sur.TankVolume.Value, UnitsTankParam(3), txtTankParameters(3))

    Case 4            'Volume (All Tanks).
      Call Unitted_UnitChange(UNITS_VOLUME, sur.TotalTankVolume.Value, UnitsTankParam(4), txtTankParameters(4))
    
  End Select

End Sub

Private Sub UnitsTankParam_KeyPress(Index As Integer, KeyAscii As Integer)
  Call Combobox_KeyPress(KeyAscii)
End Sub


VERSION 5.00
Begin VB.Form frmSurfaceEffluentConcentrations 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Effluent Concentrations "
   ClientHeight    =   6315
   ClientLeft      =   3075
   ClientTop       =   3015
   ClientWidth     =   3780
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6315
   ScaleWidth      =   3780
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   1590
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   5580
      Width           =   555
   End
   Begin VB.Label lblLabel1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Tank"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   870
      TabIndex        =   32
      Top             =   480
      Width           =   675
   End
   Begin VB.Label lblLabel 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   495
      Index           =   1
      Left            =   2070
      TabIndex        =   31
      Top             =   240
      Width           =   1215
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   570
      TabIndex        =   30
      Top             =   780
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   570
      TabIndex        =   29
      Top             =   1080
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   570
      TabIndex        =   28
      Top             =   1380
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   570
      TabIndex        =   27
      Top             =   1680
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   5
      Left            =   570
      TabIndex        =   26
      Top             =   1980
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   6
      Left            =   570
      TabIndex        =   25
      Top             =   2280
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   570
      TabIndex        =   24
      Top             =   2580
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   570
      TabIndex        =   23
      Top             =   2880
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   570
      TabIndex        =   22
      Top             =   3180
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   10
      Left            =   570
      TabIndex        =   21
      Top             =   3480
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   2130
      TabIndex        =   20
      Top             =   780
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   2130
      TabIndex        =   19
      Top             =   1080
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   2130
      TabIndex        =   18
      Top             =   1380
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   2130
      TabIndex        =   17
      Top             =   1680
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   5
      Left            =   2130
      TabIndex        =   16
      Top             =   1980
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   6
      Left            =   2130
      TabIndex        =   15
      Top             =   2280
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   2130
      TabIndex        =   14
      Top             =   2580
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   2130
      TabIndex        =   13
      Top             =   2880
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   2130
      TabIndex        =   12
      Top             =   3180
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   10
      Left            =   2130
      TabIndex        =   11
      Top             =   3480
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   11
      Left            =   570
      TabIndex        =   10
      Top             =   3780
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   12
      Left            =   570
      TabIndex        =   9
      Top             =   4080
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   13
      Left            =   570
      TabIndex        =   8
      Top             =   4380
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   14
      Left            =   570
      TabIndex        =   7
      Top             =   4680
      Width           =   1155
   End
   Begin VB.Label lblTankNumber 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   15
      Left            =   570
      TabIndex        =   6
      Top             =   4980
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   11
      Left            =   2130
      TabIndex        =   5
      Top             =   3780
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   12
      Left            =   2130
      TabIndex        =   4
      Top             =   4080
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   13
      Left            =   2130
      TabIndex        =   3
      Top             =   4380
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   14
      Left            =   2130
      TabIndex        =   2
      Top             =   4680
      Width           =   1155
   End
   Begin VB.Label lblLiquidEffluent 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   15
      Left            =   2130
      TabIndex        =   1
      Top             =   4980
      Width           =   1155
   End
End
Attribute VB_Name = "frmSurfaceEffluentConcentrations"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
    frmSurfaceEffluentConcentrations.Hide
End Sub

Private Sub Form_Activate()
    
  'Position form in upper-right corner.
  Call PositionThisForm(Me, POSITIONFORM_UR)

  '  Dim PositionLeft As Integer
  '
  '  'Position the form on the screen (Centered in Right Half of It)
  '  If WindowState = 0 Then
  '     'don't attempt if screen Minimized or Maximized
  '     PositionLeft = frmsurface.Left + frmsurface.Width - Screen.Width / 2
  '     PositionLeft = (PositionLeft / 2 - frmsurfaceeffluentconcentrations.Width / 2)
  '     Move (Screen.Width / 2 + PositionLeft), frmsurface.Top + 600
  '  End If

End Sub

Private Sub Form_Load()
    
    lblLabel(1).Caption = "Liq. Phase" & Chr(13) & "(" & Chr$(181) & "g/L)"
      
  'Position form in upper-right corner.
  Call PositionThisForm(Me, POSITIONFORM_UR)
      
  '    If frmptadscreen1.Visible = True Then Move frmptadscreen1.Left + (frmptadscreen1.Width / 2) - (frmsurfaceeffluentconcentrations.Width / 2), frmptadscreen1.Top + (frmptadscreen1.Height / 2) - (frmsurfaceeffluentconcentrations.Height / 2)
  '    If frmptadscreen2.Visible = True Then Move frmptadscreen2.Left + (frmptadscreen2.Width / 2) - (frmsurfaceeffluentconcentrations.Width / 2), frmptadscreen2.Top + (frmptadscreen2.Height / 2) - (frmsurfaceeffluentconcentrations.Height / 2)
  '    If frmbubble.Visible = True Then Move frmbubble.Left + (frmbubble.Width / 2) - (frmsurfaceeffluentconcentrations.Width / 2), frmbubble.Top + (frmbubble.Height / 2) - (frmsurfaceeffluentconcentrations.Height / 2)
  '    If frmsurface.Visible = True Then Move frmsurface.Left + (frmsurface.Width / 2) - (frmsurfaceeffluentconcentrations.Width / 2), frmsurface.Top + (frmsurface.Height / 2) - (frmsurfaceeffluentconcentrations.Height / 2)

End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmTechAssistance 
   Appearance      =   0  'Flat
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Technical Support Provided By:"
   ClientHeight    =   2970
   ClientLeft      =   2295
   ClientTop       =   4965
   ClientWidth     =   5325
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   2970
   ScaleWidth      =   5325
   Begin Threed.SSPanel pnl_title 
      Height          =   2205
      Index           =   3
      Left            =   60
      TabIndex        =   2
      Top             =   240
      Width           =   5205
      _Version        =   65536
      _ExtentX        =   9181
      _ExtentY        =   3889
      _StockProps     =   15
      Caption         =   "pnl_title(3)"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "&OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   345
      Left            =   3900
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   2550
      Width           =   1365
   End
   Begin VB.PictureBox pnl_titleX 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      ForeColor       =   &H00400040&
      Height          =   735
      Index           =   5
      Left            =   1020
      ScaleHeight     =   705
      ScaleWidth      =   5175
      TabIndex        =   0
      Top             =   3300
      Visible         =   0   'False
      Width           =   5200
   End
End
Attribute VB_Name = "frmTechAssistance"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False


Private Sub cmdOK_Click()
  Unload Me
End Sub

Private Sub Form_Load()
Dim msg As String

Call CenterOnForm(Me, frmMainMenu)
'Move frmpfpsdm.Left + (frmpfpsdm.Width / 2) - (Me.Width / 2), frmpfpsdm.Top + (frmpfpsdm.Height / 2) - (Me.Height / 2)

msg = "David R. Hokanson" & Chr$(13)
msg = msg & "David W. Hand" & Chr$(13)
msg = msg & "John C. Crittenden" & Chr$(13)
msg = msg & "Tony N. Rogers" & Chr$(13)
msg = msg & "Fr" & Chr$(233) & "d" & Chr$(233) & "ric Gobin" & Chr$(13)
msg = msg & "Eric J. Oman"
pnl_title(3).Caption = msg
pnl_title(3).BackColor = &HC0C0C0
pnl_title(3).ForeColor = &H0&
'pnl_title(3).Caption = " Model and Software:      Fr" & Chr$(233) & "d" & Chr$(233) & "ric Gobin     Eric J. Oman" & Chr$(13) & " Development   :      Tony N. Rogers"

'pnl_title(5).Caption = " Programing Support:     Richard J. Hossli" & Chr$(13) & "                                   Jason E. Mclean"
'pnl_title(5).BackColor = &HC0C0C0
'pnl_title(5).ForeColor = &H0&

''''picmtu(0).Picture = LoadPicture(app.Path & "\mtu_logo.bmp")
End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmViewEffluentConcentrationsASAP 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "View Concentration Results for All Contaminants"
   ClientHeight    =   6585
   ClientLeft      =   3705
   ClientTop       =   2370
   ClientWidth     =   8115
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6585
   ScaleWidth      =   8115
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Left            =   3690
      TabIndex        =   105
      TabStop         =   0   'False
      Top             =   6090
      Width           =   792
   End
   Begin Threed.SSFrame fraConcentrationResults 
      Height          =   3075
      Left            =   450
      TabIndex        =   0
      Top             =   150
      Width           =   7215
      _Version        =   65536
      _ExtentX        =   12721
      _ExtentY        =   5419
      _StockProps     =   14
      Caption         =   "Concentration Results"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "CN"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   120
         TabIndex        =   68
         Top             =   300
         Width           =   375
      End
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "Cinf"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   600
         TabIndex        =   67
         Top             =   300
         Width           =   1200
      End
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "Cto"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   1920
         TabIndex        =   66
         Top             =   300
         Width           =   1200
      End
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "D % R"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   3240
         TabIndex        =   65
         Top             =   300
         Width           =   1200
      End
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "Ceff"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   4560
         TabIndex        =   64
         Top             =   300
         Width           =   1200
      End
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "A % R"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   5880
         TabIndex        =   63
         Top             =   300
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   120
         TabIndex        =   62
         Top             =   600
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   600
         TabIndex        =   61
         Top             =   600
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   1920
         TabIndex        =   60
         Top             =   600
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   3240
         TabIndex        =   59
         Top             =   600
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   4560
         TabIndex        =   58
         Top             =   600
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   5880
         TabIndex        =   57
         Top             =   600
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "2"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   120
         TabIndex        =   56
         Top             =   840
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   600
         TabIndex        =   55
         Top             =   840
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   1920
         TabIndex        =   54
         Top             =   840
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   3240
         TabIndex        =   53
         Top             =   840
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   4560
         TabIndex        =   52
         Top             =   840
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   5880
         TabIndex        =   51
         Top             =   840
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "3"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   120
         TabIndex        =   50
         Top             =   1080
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   600
         TabIndex        =   49
         Top             =   1080
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   1920
         TabIndex        =   48
         Top             =   1080
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   3240
         TabIndex        =   47
         Top             =   1080
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   4560
         TabIndex        =   46
         Top             =   1080
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   5880
         TabIndex        =   45
         Top             =   1080
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "4"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   120
         TabIndex        =   44
         Top             =   1320
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   600
         TabIndex        =   43
         Top             =   1320
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   1920
         TabIndex        =   42
         Top             =   1320
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   3240
         TabIndex        =   41
         Top             =   1320
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   4560
         TabIndex        =   40
         Top             =   1320
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   5880
         TabIndex        =   39
         Top             =   1320
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "5"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   120
         TabIndex        =   38
         Top             =   1560
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   600
         TabIndex        =   37
         Top             =   1560
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   1920
         TabIndex        =   36
         Top             =   1560
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   3240
         TabIndex        =   35
         Top             =   1560
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   4560
         TabIndex        =   34
         Top             =   1560
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   5880
         TabIndex        =   33
         Top             =   1560
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "6"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   120
         TabIndex        =   32
         Top             =   1800
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   600
         TabIndex        =   31
         Top             =   1800
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   1920
         TabIndex        =   30
         Top             =   1800
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   3240
         TabIndex        =   29
         Top             =   1800
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   4560
         TabIndex        =   28
         Top             =   1800
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   5880
         TabIndex        =   27
         Top             =   1800
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "7"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   6
         Left            =   120
         TabIndex        =   26
         Top             =   2040
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   6
         Left            =   600
         TabIndex        =   25
         Top             =   2040
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   6
         Left            =   1920
         TabIndex        =   24
         Top             =   2040
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   6
         Left            =   3240
         TabIndex        =   23
         Top             =   2040
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   6
         Left            =   4560
         TabIndex        =   22
         Top             =   2040
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   6
         Left            =   5880
         TabIndex        =   21
         Top             =   2040
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "8"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   7
         Left            =   120
         TabIndex        =   20
         Top             =   2280
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   7
         Left            =   600
         TabIndex        =   19
         Top             =   2280
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   7
         Left            =   1920
         TabIndex        =   18
         Top             =   2280
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   7
         Left            =   3240
         TabIndex        =   17
         Top             =   2280
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   7
         Left            =   4560
         TabIndex        =   16
         Top             =   2280
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   7
         Left            =   5880
         TabIndex        =   15
         Top             =   2280
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "9"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   8
         Left            =   120
         TabIndex        =   14
         Top             =   2520
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   8
         Left            =   600
         TabIndex        =   13
         Top             =   2520
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   8
         Left            =   1920
         TabIndex        =   12
         Top             =   2520
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   8
         Left            =   3240
         TabIndex        =   11
         Top             =   2520
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   8
         Left            =   4560
         TabIndex        =   10
         Top             =   2520
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   8
         Left            =   5880
         TabIndex        =   9
         Top             =   2520
         Width           =   1200
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "10"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   120
         TabIndex        =   8
         Top             =   2760
         Width           =   375
      End
      Begin VB.Label lblInfluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   600
         TabIndex        =   7
         Top             =   2760
         Width           =   1200
      End
      Begin VB.Label lblTreatmentObjective 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   1920
         TabIndex        =   6
         Top             =   2760
         Width           =   1200
      End
      Begin VB.Label lblDesiredPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   3240
         TabIndex        =   5
         Top             =   2760
         Width           =   1200
      End
      Begin VB.Label lblEffluentConcentration 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   4560
         TabIndex        =   4
         Top             =   2760
         Width           =   1200
      End
      Begin VB.Label lblAchievedPercentRemoval 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   5880
         TabIndex        =   3
         Top             =   2760
         Width           =   1200
      End
   End
   Begin Threed.SSFrame fraContaminantGlossary 
      Height          =   2535
      Left            =   240
      TabIndex        =   1
      Top             =   3360
      Width           =   3855
      _Version        =   65536
      _ExtentX        =   6794
      _ExtentY        =   4466
      _StockProps     =   14
      Caption         =   "Contaminant Glossary:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "CN"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   120
         TabIndex        =   90
         Top             =   300
         Width           =   375
      End
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "Contaminant Name"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   10
         Left            =   600
         TabIndex        =   89
         Top             =   300
         Width           =   3135
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "5"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   14
         Left            =   120
         TabIndex        =   88
         Top             =   1320
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "4"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   13
         Left            =   120
         TabIndex        =   87
         Top             =   1140
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "3"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   12
         Left            =   120
         TabIndex        =   86
         Top             =   960
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "2"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   11
         Left            =   120
         TabIndex        =   85
         Top             =   780
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   10
         Left            =   120
         TabIndex        =   84
         Top             =   600
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "10"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   19
         Left            =   120
         TabIndex        =   83
         Top             =   2220
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "9"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   18
         Left            =   120
         TabIndex        =   82
         Top             =   2040
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "8"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   17
         Left            =   120
         TabIndex        =   81
         Top             =   1860
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "7"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   16
         Left            =   120
         TabIndex        =   80
         Top             =   1680
         Width           =   375
      End
      Begin VB.Label lblContaminantNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "6"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   15
         Left            =   120
         TabIndex        =   79
         Top             =   1500
         Width           =   375
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   600
         TabIndex        =   78
         Top             =   600
         Width           =   3135
      End
      Begin VB.Line Line2 
         Index           =   0
         X1              =   0
         X2              =   3840
         Y1              =   540
         Y2              =   540
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   600
         TabIndex        =   77
         Top             =   780
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   600
         TabIndex        =   76
         Top             =   960
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   600
         TabIndex        =   75
         Top             =   1140
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   600
         TabIndex        =   74
         Top             =   1320
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   600
         TabIndex        =   73
         Top             =   1500
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   6
         Left            =   600
         TabIndex        =   72
         Top             =   1680
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   7
         Left            =   600
         TabIndex        =   71
         Top             =   1860
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   8
         Left            =   600
         TabIndex        =   70
         Top             =   2040
         Width           =   3135
      End
      Begin VB.Label lblContaminantName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   9
         Left            =   600
         TabIndex        =   69
         Top             =   2220
         Width           =   3135
      End
   End
   Begin Threed.SSFrame fraGlossary 
      Height          =   1815
      Left            =   4080
      TabIndex        =   2
      Top             =   3360
      Width           =   3795
      _Version        =   65536
      _ExtentX        =   6689
      _ExtentY        =   3196
      _StockProps     =   14
      Caption         =   "Glossary:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "Label"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   11
         Left            =   90
         TabIndex        =   104
         Top             =   300
         Width           =   675
      End
      Begin VB.Label lblTitle 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         Caption         =   "Description"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   12
         Left            =   870
         TabIndex        =   103
         Top             =   300
         Width           =   2775
      End
      Begin VB.Line Line2 
         Index           =   1
         X1              =   -30
         X2              =   3810
         Y1              =   540
         Y2              =   540
      End
      Begin VB.Label lblProperty 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "CN"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   90
         TabIndex        =   102
         Top             =   600
         Width           =   675
      End
      Begin VB.Label lblProperty 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Cinf"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   90
         TabIndex        =   101
         Top             =   780
         Width           =   675
      End
      Begin VB.Label lblProperty 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Cto"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   90
         TabIndex        =   100
         Top             =   960
         Width           =   675
      End
      Begin VB.Label lblProperty 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "D % R"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   90
         TabIndex        =   99
         Top             =   1140
         Width           =   675
      End
      Begin VB.Label lblProperty 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Ceff"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   90
         TabIndex        =   98
         Top             =   1320
         Width           =   675
      End
      Begin VB.Label lblProperty 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "A % R"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   90
         TabIndex        =   97
         Top             =   1500
         Width           =   675
      End
      Begin VB.Label lblDescription 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Contaminant Number"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   0
         Left            =   870
         TabIndex        =   96
         Top             =   600
         Width           =   2775
      End
      Begin VB.Label lblDescription 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Influent Concentration (ug/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   1
         Left            =   870
         TabIndex        =   95
         Top             =   780
         Width           =   2775
      End
      Begin VB.Label lblDescription 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Treatment Objective (ug/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   2
         Left            =   870
         TabIndex        =   94
         Top             =   960
         Width           =   2775
      End
      Begin VB.Label lblDescription 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Desired Percent Removal"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   3
         Left            =   870
         TabIndex        =   93
         Top             =   1140
         Width           =   2775
      End
      Begin VB.Label lblDescription 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Effluent Concentration (ug/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   4
         Left            =   870
         TabIndex        =   92
         Top             =   1320
         Width           =   2775
      End
      Begin VB.Label lblDescription 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Achieved Percent Removal"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Index           =   5
         Left            =   870
         TabIndex        =   91
         Top             =   1500
         Width           =   2775
      End
   End
End
Attribute VB_Name = "frmViewEffluentConcentrationsASAP"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub cmdOK_Click()
    frmViewEffluentConcentrationsASAP.Hide
End Sub

Private Sub Form_Activate()
  Call CenterThisForm(Me)
End Sub

Private Sub Form_Load()

  Call CenterThisForm(Me)

End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmWaterPropertiesBubble 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Properties of Water"
   ClientHeight    =   2940
   ClientLeft      =   2895
   ClientTop       =   4305
   ClientWidth     =   7905
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   2940
   ScaleWidth      =   7905
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   0
      Left            =   4650
      TabIndex        =   0
      Top             =   840
      Width           =   1215
   End
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   1
      Left            =   4650
      TabIndex        =   1
      Top             =   1320
      Width           =   1215
   End
   Begin VB.CommandButton Command1 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      Height          =   495
      Left            =   3690
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   2100
      Width           =   615
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   1
      Left            =   570
      TabIndex        =   2
      Top             =   1320
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   0
      Left            =   570
      TabIndex        =   3
      Top             =   840
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Density"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   1530
      TabIndex        =   14
      Top             =   840
      Width           =   2895
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Viscosity"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   1530
      TabIndex        =   13
      Top             =   1320
      Width           =   2895
   End
   Begin VB.Label lblUpdateValues 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "label"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   495
      Left            =   210
      TabIndex        =   12
      Top             =   240
      Width           =   975
   End
   Begin VB.Label lblSourceofValues 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "label"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   6210
      TabIndex        =   11
      Top             =   240
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   6210
      TabIndex        =   10
      Top             =   840
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   6210
      TabIndex        =   9
      Top             =   1320
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   6210
      TabIndex        =   8
      Top             =   1800
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   6210
      TabIndex        =   7
      Top             =   2280
      Width           =   1215
   End
   Begin VB.Shape Shape1 
      Height          =   1695
      Left            =   210
      Top             =   150
      Width           =   7455
   End
   Begin VB.Line Line1 
      X1              =   210
      X2              =   7650
      Y1              =   720
      Y2              =   720
   End
   Begin VB.Line Line2 
      X1              =   210
      X2              =   7650
      Y1              =   1200
      Y2              =   1200
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Property"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   1530
      TabIndex        =   6
      Top             =   360
      Width           =   2895
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Value"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   4650
      TabIndex        =   5
      Top             =   360
      Width           =   1215
   End
End
Attribute VB_Name = "frmWaterPropertiesBubble"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub Command1_Click()
    frmWaterPropertiesBubble.Hide
End Sub

Private Sub Form_Activate()

    Call CenterThisForm(Me)

End Sub

Private Sub Form_Load()

    Call CenterThisForm(Me)

    lblUpdateValues.Caption = "Update" & Chr$(13) & "Values"
    lblSourceofValues.Caption = "Source of" & Chr$(13) & "Values"
    Call LabelsWaterPropertiesBubbleSI
    
End Sub

Private Sub txtAirWaterProperties_GotFocus(Index As Integer)
  Call GotFocus_Handle(Me, txtAirWaterProperties(Index), Temp_Text)
   
End Sub

Private Sub txtAirWaterProperties_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtAirWaterProperties_LostFocus(Index As Integer)

    Dim ValueChanged As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtAirWaterProperties(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtAirWaterProperties(Index), Temp_Text)

    If Not IsError Then
       'Make sure number in text box is > zero
       If Not HaveValue(CDbl(txtAirWaterProperties(Index).Text)) Then
          txtAirWaterProperties(Index).Text = Temp_Text
          txtAirWaterProperties(Index).SetFocus
          Exit Sub
       End If

       Call TextNumberChanged(ValueChanged, txtAirWaterProperties(Index), Temp_Text)

       If ValueChanged Then lblValueSource(Index).Caption = "User-Input"

       Select Case Index
          Case 0
               bub.WaterDensity.ValChanged = ValueChanged
               bub.WaterDensity.UserInput = ValueChanged
               If bub.WaterDensity.UserInput Then bub.WaterDensity.Value = CDbl(txtAirWaterProperties(0).Text)
          Case 1
               bub.WaterViscosity.ValChanged = ValueChanged
               bub.WaterViscosity.UserInput = ValueChanged
               If bub.WaterViscosity.UserInput Then bub.WaterViscosity.Value = CDbl(txtAirWaterProperties(1).Text)
       End Select
    End If
  Call LostFocus_Handle(Me, txtAirWaterProperties(Index), flag_ok)


End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmWaterPropertiesSurface 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Properties of Water"
   ClientHeight    =   2940
   ClientLeft      =   1830
   ClientTop       =   6090
   ClientWidth     =   7905
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   2940
   ScaleWidth      =   7905
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   0
      Left            =   4680
      TabIndex        =   0
      Top             =   780
      Width           =   1215
   End
   Begin VB.TextBox txtAirWaterProperties 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   1
      Left            =   4680
      TabIndex        =   1
      Top             =   1260
      Width           =   1215
   End
   Begin VB.CommandButton Command1 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   3720
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   2040
      Width           =   615
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   1
      Left            =   600
      TabIndex        =   2
      Top             =   1260
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin Threed.SSCheck chkUpdateValues 
      Height          =   255
      Index           =   0
      Left            =   600
      TabIndex        =   3
      Top             =   780
      Width           =   255
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Value           =   -1  'True
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Density"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   1560
      TabIndex        =   15
      Top             =   780
      Width           =   2895
   End
   Begin VB.Label lblAirWaterProperties 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Water Viscosity"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   1560
      TabIndex        =   14
      Top             =   1260
      Width           =   2895
   End
   Begin VB.Label lblUpdateValues 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "label"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   495
      Left            =   240
      TabIndex        =   13
      Top             =   180
      Width           =   975
   End
   Begin VB.Label lblSourceofValues 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "label"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   6240
      TabIndex        =   12
      Top             =   180
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   6240
      TabIndex        =   11
      Top             =   780
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   6240
      TabIndex        =   10
      Top             =   1260
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   6240
      TabIndex        =   9
      Top             =   1740
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   6240
      TabIndex        =   8
      Top             =   2220
      Width           =   1215
   End
   Begin VB.Label lblValueSource 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   6240
      TabIndex        =   7
      Top             =   2700
      Width           =   1215
   End
   Begin VB.Shape Shape1 
      Height          =   1695
      Left            =   240
      Top             =   60
      Width           =   7455
   End
   Begin VB.Line Line1 
      X1              =   240
      X2              =   7680
      Y1              =   660
      Y2              =   660
   End
   Begin VB.Line Line2 
      X1              =   240
      X2              =   7680
      Y1              =   1140
      Y2              =   1140
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Property"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   1560
      TabIndex        =   6
      Top             =   300
      Width           =   2895
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Value"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   4680
      TabIndex        =   5
      Top             =   300
      Width           =   1215
   End
End
Attribute VB_Name = "frmWaterPropertiesSurface"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub Command1_Click()
    frmWaterPropertiesSurface.Hide
End Sub

Private Sub Form_Activate()
    frmWaterPropertiesSurface.WindowState = 0

    'Position the form on the screen (Centered)
    If WindowState = 0 Then
       'don't attempt if screen Minimized or Maximized
      If frmPTADScreen1.Visible = True Then Move frmPTADScreen1.Left + (frmPTADScreen1.Width / 2) - (frmWaterPropertiesSurface.Width / 2), frmPTADScreen1.Top + (frmPTADScreen1.Height / 2) - (frmWaterPropertiesSurface.Height / 2)
      If frmPTADScreen2.Visible = True Then Move frmPTADScreen2.Left + (frmPTADScreen2.Width / 2) - (frmWaterPropertiesSurface.Width / 2), frmPTADScreen2.Top + (frmPTADScreen2.Height / 2) - (frmWaterPropertiesSurface.Height / 2)
      If frmBubble.Visible = True Then Move frmBubble.Left + (frmBubble.Width / 2) - (frmWaterPropertiesSurface.Width / 2), frmBubble.Top + (frmBubble.Height / 2) - (frmWaterPropertiesSurface.Height / 2)
      If frmSurface.Visible = True Then Move frmSurface.Left + (frmSurface.Width / 2) - (frmWaterPropertiesSurface.Width / 2), frmSurface.Top + (frmSurface.Height / 2) - (frmWaterPropertiesSurface.Height / 2)
    End If

End Sub

Private Sub Form_Load()


    lblUpdateValues.Caption = "Update" & Chr$(13) & "Values"
    lblSourceofValues.Caption = "Source of" & Chr$(13) & "Values"

    Call LabelsWaterPropertiesSurfaceSI
    
End Sub

Private Sub txtAirWaterProperties_GotFocus(Index As Integer)
    
  Call GotFocus_Handle(Me, txtAirWaterProperties(Index), Temp_Text)
End Sub

Private Sub txtAirWaterProperties_KeyPress(Index As Integer, KeyAscii As Integer)
  Call TextBoxNumber_KeyPress(KeyAscii)
End Sub

Private Sub txtAirWaterProperties_LostFocus(Index As Integer)

    Dim ValueChanged As Integer
    Dim flag_ok As Integer

   If (LostFocus_IsEvil(Me, txtAirWaterProperties(Index))) Then
     Exit Sub
   End If
   
   flag_ok = True

    Call TextHandleError(IsError, txtAirWaterProperties(Index), Temp_Text)

    If Not IsError Then
       'Make sure number in text box is > zero
       If Not HaveValue(CDbl(txtAirWaterProperties(Index).Text)) Then
          txtAirWaterProperties(Index).Text = Temp_Text
          txtAirWaterProperties(Index).SetFocus
          Exit Sub
       End If

       Call TextNumberChanged(ValueChanged, txtAirWaterProperties(Index), Temp_Text)

       If ValueChanged Then lblValueSource(Index).Caption = "User-Input"

       Select Case Index
          Case 0
               sur.WaterDensity.ValChanged = ValueChanged
               sur.WaterDensity.UserInput = ValueChanged
               If sur.WaterDensity.UserInput Then sur.WaterDensity.Value = CDbl(txtAirWaterProperties(0).Text)
          Case 1
               sur.WaterViscosity.ValChanged = ValueChanged
               sur.WaterViscosity.UserInput = ValueChanged
               If sur.WaterViscosity.UserInput Then sur.WaterViscosity.Value = CDbl(txtAirWaterProperties(1).Text)
       End Select
    End If

  Call LostFocus_Handle(Me, txtAirWaterProperties(Index), flag_ok)


End Sub


